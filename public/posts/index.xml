<?xml version="1.0" encoding="utf-8" standalone="yes"?>
<rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom" xmlns:content="http://purl.org/rss/1.0/modules/content/">
  <channel>
    <title>Posts on masontuckett.xyz</title>
    <link>https://masontuckett.xyz/posts/</link>
    <description>Recent content in Posts on masontuckett.xyz</description>
    <generator>Hugo -- gohugo.io</generator>
    <language>en-US</language>
    <managingEditor>mason@tuckett.xyz (Mason Tuckett)</managingEditor>
    <webMaster>mason@tuckett.xyz (Mason Tuckett)</webMaster>
    <copyright>Copyright ©2025 Mason Tuckett All Rights Reserved</copyright>
    <lastBuildDate>Sat, 28 Dec 2024 00:38:44 -0700</lastBuildDate>
    <atom:link href="https://masontuckett.xyz/posts/index.xml" rel="self" type="application/rss+xml" />
    <item>
      <title>Podman</title>
      <link>https://masontuckett.xyz/posts/podman/</link>
      <pubDate>Sat, 06 Dec 2025 21:27:32 -0700</pubDate><author>mason@tuckett.xyz (Mason Tuckett)</author>
      <guid>https://masontuckett.xyz/posts/podman/</guid>
      <description>&lt;p&gt;A Brief Overview of Podman&lt;/p&gt;&#xA;&lt;h2 id=&#34;containerization&#34;&gt;Containerization&lt;/h2&gt;&#xA;&lt;h2 id=&#34;linux-namespace&#34;&gt;Linux Namespace&lt;/h2&gt;&#xA;&lt;p&gt;&lt;img src=&#34;https://masontuckett.xyz/images/posts/podman/linux-kernel.webp&#34; alt=&#34;Linux Kernel Diagram&#34;&gt;&lt;/p&gt;&#xA;&lt;h2 id=&#34;docker&#34;&gt;Docker&lt;/h2&gt;&#xA;&lt;p&gt;Docker is an incredibly convenient and largely foolproof solution for implementing operating-system-level virtualization in the manner of streamlined packages (containers).&lt;/p&gt;&#xA;&lt;p&gt;By its nature, production environments rely upon fully packaged images with base sub-systems (e.g., Alpine/Bottlerocket/Ubuntu)—to bypass environmental complexity.&lt;/p&gt;&#xA;&lt;p&gt;Developers and system maintainers may simply deploy an immutable image, ensuring interoperability concerns are adequately addressed.&lt;/p&gt;&#xA;&lt;small&gt;&lt;i&gt;&lt;b&gt;No dependency hell, no version mismatch, and no cross-platform interference.&lt;/b&gt;&lt;/i&gt;&lt;/small&gt;&#xA;&#xA;&lt;p&gt;&lt;strong&gt;Typical Deployment Pattern:&lt;/strong&gt;&lt;/p&gt;</description>
      <content:encoded><![CDATA[<p>A Brief Overview of Podman</p>
<h2 id="containerization">Containerization</h2>
<h2 id="linux-namespace">Linux Namespace</h2>
<p><img src="/images/posts/podman/linux-kernel.webp" alt="Linux Kernel Diagram"></p>
<h2 id="docker">Docker</h2>
<p>Docker is an incredibly convenient and largely foolproof solution for implementing operating-system-level virtualization in the manner of streamlined packages (containers).</p>
<p>By its nature, production environments rely upon fully packaged images with base sub-systems (e.g., Alpine/Bottlerocket/Ubuntu)—to bypass environmental complexity.</p>
<p>Developers and system maintainers may simply deploy an immutable image, ensuring interoperability concerns are adequately addressed.</p>
<small><i><b>No dependency hell, no version mismatch, and no cross-platform interference.</b></i></small>

<p><strong>Typical Deployment Pattern:</strong></p>
<ul>
<li>A Unix-like host provides OS-level virtualization.</li>
<li>Ansible playbook/Docker compose YMLs are configured.</li>
<li>Containers are mediated/deployed via a web console.</li>
<li>Often run as root, only application/container-specific variables are addressed.</li>
</ul>





<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-yaml" data-lang="yaml"><span class="line"><span class="ln"> 1</span><span class="cl"><span class="c">### Example Ansible Playbook ###</span><span class="w">
</span></span></span><span class="line"><span class="ln"> 2</span><span class="cl"><span class="w"></span><span class="c"># ! Via docs.ansible.com ! #</span><span class="w">
</span></span></span><span class="line"><span class="ln"> 3</span><span class="cl"><span class="w"></span>- <span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l">Update web servers</span><span class="w">
</span></span></span><span class="line"><span class="ln"> 4</span><span class="cl"><span class="w">  </span><span class="nt">hosts</span><span class="p">:</span><span class="w"> </span><span class="l">webservers</span><span class="w">
</span></span></span><span class="line"><span class="ln"> 5</span><span class="cl"><span class="w">  </span><span class="nt">remote_user</span><span class="p">:</span><span class="w"> </span><span class="l">root</span><span class="w">
</span></span></span><span class="line"><span class="ln"> 6</span><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="ln"> 7</span><span class="cl"><span class="w">  </span><span class="nt">tasks</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="ln"> 8</span><span class="cl"><span class="w">  </span>- <span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l">Ensure apache is at the latest version</span><span class="w">
</span></span></span><span class="line"><span class="ln"> 9</span><span class="cl"><span class="w">    </span><span class="nt">ansible.builtin.yum</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="ln">10</span><span class="cl"><span class="w">      </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l">httpd</span><span class="w">
</span></span></span><span class="line"><span class="ln">11</span><span class="cl"><span class="w">      </span><span class="nt">state</span><span class="p">:</span><span class="w"> </span><span class="l">latest</span><span class="w">
</span></span></span><span class="line"><span class="ln">12</span><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="ln">13</span><span class="cl"><span class="w">  </span>- <span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l">Write the apache config file</span><span class="w">
</span></span></span><span class="line"><span class="ln">14</span><span class="cl"><span class="w">    </span><span class="nt">ansible.builtin.template</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="ln">15</span><span class="cl"><span class="w">      </span><span class="nt">src</span><span class="p">:</span><span class="w"> </span><span class="l">/srv/httpd.j2</span><span class="w">
</span></span></span><span class="line"><span class="ln">16</span><span class="cl"><span class="w">      </span><span class="nt">dest</span><span class="p">:</span><span class="w"> </span><span class="l">/etc/httpd.conf</span><span class="w">
</span></span></span><span class="line"><span class="ln">17</span><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="ln">18</span><span class="cl"><span class="w"></span>- <span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l">Update db servers</span><span class="w">
</span></span></span><span class="line"><span class="ln">19</span><span class="cl"><span class="w">  </span><span class="nt">hosts</span><span class="p">:</span><span class="w"> </span><span class="l">databases</span><span class="w">
</span></span></span><span class="line"><span class="ln">20</span><span class="cl"><span class="w">  </span><span class="nt">remote_user</span><span class="p">:</span><span class="w"> </span><span class="l">root</span><span class="w">
</span></span></span><span class="line"><span class="ln">21</span><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="ln">22</span><span class="cl"><span class="w">  </span><span class="nt">tasks</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="ln">23</span><span class="cl"><span class="w">  </span>- <span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l">Ensure postgresql is at the latest version</span><span class="w">
</span></span></span><span class="line"><span class="ln">24</span><span class="cl"><span class="w">    </span><span class="nt">ansible.builtin.yum</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="ln">25</span><span class="cl"><span class="w">      </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l">postgresql</span><span class="w">
</span></span></span><span class="line"><span class="ln">26</span><span class="cl"><span class="w">      </span><span class="nt">state</span><span class="p">:</span><span class="w"> </span><span class="l">latest</span><span class="w">
</span></span></span><span class="line"><span class="ln">27</span><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="ln">28</span><span class="cl"><span class="w">  </span>- <span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l">Ensure that postgresql is started</span><span class="w">
</span></span></span><span class="line"><span class="ln">29</span><span class="cl"><span class="w">    </span><span class="nt">ansible.builtin.service</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="ln">30</span><span class="cl"><span class="w">      </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l">postgresql</span><span class="w">
</span></span></span><span class="line"><span class="ln">31</span><span class="cl"><span class="w">      </span><span class="nt">state</span><span class="p">:</span><span class="w"> </span><span class="l">started</span></span></span></code></pre></div><h3 id="caveats">Caveats</h3>
<p>Ironically, in common production environments, Docker configuration is often left unchanged—ignorantly left running as root.</p>
<p>When left misconfigured, a containerized root environment <em>can</em> correspond to the host&rsquo;s underlying root user.</p>
<p>In a rootful state, it presents a massive, glaringly obvious increase in post-exploit severity.</p>
<small><i><b>Rootful containers will map to UID 0.</b></i></small>

<h2 id="podman">Podman</h2>
<h3 id="caveats-1">Caveats</h3>
<h2 id="configuring-docker">Configuring Docker</h2>
<h3 id="user-configuration">User Configuration</h3>
<h2 id="configuring-podman">Configuring Podman</h2>
]]></content:encoded>
    </item>
    <item>
      <title>Hidden Services</title>
      <link>https://masontuckett.xyz/posts/hidden-services/</link>
      <pubDate>Sun, 09 Nov 2025 16:32:04 -0700</pubDate><author>mason@tuckett.xyz (Mason Tuckett)</author>
      <guid>https://masontuckett.xyz/posts/hidden-services/</guid>
      <description>&lt;p&gt;A Basic Setup Guide for Tor/I2P Hidden Services&lt;/p&gt;&#xA;&lt;h2 id=&#34;hosting-hidden-services&#34;&gt;Hosting Hidden Services&lt;/h2&gt;&#xA;&lt;p&gt;Hosting hidden services is easier than it has ever been—as detailed documentation is now vastly widespread.&lt;/p&gt;&#xA;&lt;p&gt;Though I&amp;rsquo;d like to dispel misconceptions about the &amp;ldquo;darknet,&amp;rdquo; &lt;em&gt;or more colloquially the &amp;ldquo;dark web.&amp;rdquo;&lt;/em&gt;&lt;/p&gt;&#xA;&lt;h3 id=&#34;the-dark-web&#34;&gt;The Dark Web&lt;/h3&gt;&#xA;&lt;p&gt;The dark net refers to traffic or protocols that are not within typical clear channels; the qualification is not obscurity or &amp;ldquo;depth&amp;rdquo; (deep web).&lt;/p&gt;&#xA;&lt;p&gt;Typically facilitated under decentralized or independently structured protocols.&lt;/p&gt;</description>
      <content:encoded><![CDATA[<p>A Basic Setup Guide for Tor/I2P Hidden Services</p>
<h2 id="hosting-hidden-services">Hosting Hidden Services</h2>
<p>Hosting hidden services is easier than it has ever been—as detailed documentation is now vastly widespread.</p>
<p>Though I&rsquo;d like to dispel misconceptions about the &ldquo;darknet,&rdquo; <em>or more colloquially the &ldquo;dark web.&rdquo;</em></p>
<h3 id="the-dark-web">The Dark Web</h3>
<p>The dark net refers to traffic or protocols that are not within typical clear channels; the qualification is not obscurity or &ldquo;depth&rdquo; (deep web).</p>
<p>Typically facilitated under decentralized or independently structured protocols.</p>
<small><i><b>Both Tor (onion) and I2P (garlic) are the most ubiquitous examples of "dark web" hosting.</b></i></small>

<h3 id="onion-routing">Onion Routing</h3>
<p><img src="/images/posts/hidden-services/onion-routing.webp" alt="Tor - Onion Routing Diagram"></p>
<p>Tor utilizes onion routing to anonymize sensitive traffic.</p>
<p>Data is encapsulated in multiple layers of encryption—<em>with user traffic being propagated through a circuit</em>.</p>
<p>Within the circuit, user traffic goes through a path of at least three nodes—obscuring the path of origin.</p>
<p><strong>Simple Breakdown:</strong></p>
<blockquote>
<p>Packet -&gt; entry node.<br>
Entry node (guard) decrypts the outer layer for the next hop.<br>
Middle node decrypts its layer -&gt; exit node.<br>
Exit node decrypts the final layer -&gt; revealing the original data and intended destination.</p>
</blockquote>
<p><strong>More Information May Be Found Here:</strong> <a href="https://itp.nyu.edu/networks/explanations/demystifying-the-dark-web-an-introduction-to-tor-and-onion-routing/">ITP (NYU) Breakdown</a>.</p>
<h3 id="garlic-routing">Garlic Routing</h3>
<p><img src="/images/posts/hidden-services/garlic-cloves.webp" alt="I2P - Garlic Routing Diagram"></p>
<p>I2P uses a similar privacy-preserving routing methodology—<em>but with a packet-switched mixnet design</em>.</p>
<p>It is a natural extension of onion routing, bundling multiple cloves (messages) into a singular, encrypted &ldquo;garlic&rdquo; packet.</p>
<p>It is more resilient compared to onion routing&rsquo;s individual handling, though slower because of its bundling.</p>
<p><strong>Simple Breakdown:</strong></p>
<blockquote>
<p>Users build unidirectional tunnels (ingress/egress) via volunteer routers.<br>
Data is effectively layered (similar to Tor)—bundled with padding to obscure data.<br>
Packets travel through the sender’s egress tunnel -&gt; the recipient’s ingress.<br>
Each node decrypts its layer, unbinding cloves at the end.<br>
Replies use separate tunnels to avoid correlation attacks.</p>
</blockquote>
<small><i><b>By its nature it consequently has excellent support for P2P services.</b></i></small>

<p><strong>More Information May Be Found Here:</strong> <a href="https://geti2p.net/en/docs/how/garlic-routing">I2P Project</a>.</p>
<h2 id="tor-mirrors">Tor Mirrors</h2>
<p>Generating the required files is incredibly easy—<em>as the entire process has been largely demystified and automated</em>.</p>
<p>I would avoid relays/nodes, as they may present an <strong>INCREDIBLE</strong> amount of legal issues depending upon your jurisdiction.</p>
<p>Relays help the project stay alive, providing a viable route for users—<em>but it is important to note that <strong>intelligence agencies co-opt this</strong></em>.</p>
<p>Tor is not foolproof and does not automatically denote that your traffic is wholly secure <strong><em>(&ldquo;1337 DaRk WeB!!!&rdquo;)</em></strong>.</p>
<p>The protocol by design is still quite flawed, as it is possible to decipher user origin by traffic correlation (entry/exit nodes).</p>
<p>Although this is really only utilized by state-level actors, <em>its ingrained design flaw is still unavoidable</em>.</p>
<small><i><b>À la compromised or rogue exit nodes.</b></i></small>

<p><strong>KEEP THIS IN MIND:</strong> <em>Tor is NOT ENTIRELY QUANTUM-RESISTANT</em>.</p>
<h3 id="analytics">Analytics</h3>
<p>Every browser has a unique fingerprint driven by its UA, system fonts, canvas, screen size, and other ingrained behaviors—<em>presenting a significant tracking concern</em>.</p>
<p>It is quite foolish to use a third-party browser with Tor support, especially given that <strong>THE MAJORITY</strong> of traffic is tied to Tor Browser&rsquo;s (Firefox) standardized fingerprint.</p>





<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-txt" data-lang="txt"><span class="line"><span class="ln">1</span><span class="cl">### Example Brave UA ###
</span></span><span class="line"><span class="ln">2</span><span class="cl">Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/137.0.0.0 Safari/537.36</span></span></code></pre></div><p><strong>Browser Tests:</strong> <a href="https://coveryourtracks.eff.org/">Cover Your  Tracks (EFF)</a>, <a href="https://amiunique.org/">Am I Unique?</a>, <a href="https://browserleaks.com/">Browser Leaks</a>.</p>
<small><i><b>Browser behavior IS NOTICEABLY different between Gecko and Chromium-based browsers.</b></i></small>

<p>If you&rsquo;re even on Windows at all—<strong>you&rsquo;re ngmi</strong>; stop here and go <em>reinterpret</em> your threat model.</p>
<small><i><b>I hope you enjoy Copilot+ Recall!!!</b></i></small>

<h3 id="generating-a-tor-mirror">Generating a Tor Mirror</h3>
<p>For demo purposes, I&rsquo;m assuming a bare-install scenario and any recent Debian derivative.</p>
<small><i><b>I'm still in the process of migrating my VPS infrastructure to Podman; it's working fantastically on-prem though!</b></i></small>

<p>Trixie repositories have resolved Bookworm&rsquo;s persistent issue of ephemeral key loss—<em>resulting in Tor mirrors randomly failing</em>.</p>





<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-sh" data-lang="sh"><span class="line"><span class="ln"> 1</span><span class="cl"><span class="c1">### Install Tor ###</span>
</span></span><span class="line"><span class="ln"> 2</span><span class="cl">sudo apt update
</span></span><span class="line"><span class="ln"> 3</span><span class="cl">sudo apt install -y tor
</span></span><span class="line"><span class="ln"> 4</span><span class="cl">
</span></span><span class="line"><span class="ln"> 5</span><span class="cl"><span class="c1">### Useful as This is Bare ###</span>
</span></span><span class="line"><span class="ln"> 6</span><span class="cl">sudo apt install -y apparmor apparmor-utils wget curl
</span></span><span class="line"><span class="ln"> 7</span><span class="cl">
</span></span><span class="line"><span class="ln"> 8</span><span class="cl"><span class="c1">### Enable/Start Tor ###</span>
</span></span><span class="line"><span class="ln"> 9</span><span class="cl">sudo systemctl <span class="nb">enable</span> --now tor
</span></span><span class="line"><span class="ln">10</span><span class="cl">
</span></span><span class="line"><span class="ln">11</span><span class="cl"><span class="c1">### Enable/Start AppArmor ###</span>
</span></span><span class="line"><span class="ln">12</span><span class="cl">sudo systemctl <span class="nb">enable</span> --now apparmor
</span></span><span class="line"><span class="ln">13</span><span class="cl">
</span></span><span class="line"><span class="ln">14</span><span class="cl"><span class="c1">### Sanity Check ###</span>
</span></span><span class="line"><span class="ln">15</span><span class="cl">sudo journalctl -xeu tor
</span></span><span class="line"><span class="ln">16</span><span class="cl">sudo journalctl -xeu apparmor</span></span></code></pre></div><small><i><b>A Tor AppArmor profile should be installed; make sure to personally audit the file and make any appropriate alterations.</b></i></small>






<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-sh" data-lang="sh"><span class="line"><span class="ln"> 1</span><span class="cl"><span class="c1">### Audit the Config ###</span>
</span></span><span class="line"><span class="ln"> 2</span><span class="cl">sudo vim /etc/apparmor.d/system_tor
</span></span><span class="line"><span class="ln"> 3</span><span class="cl">
</span></span><span class="line"><span class="ln"> 4</span><span class="cl"><span class="c1">### Parse the Config ###</span>
</span></span><span class="line"><span class="ln"> 5</span><span class="cl">sudo apparmor_parser -r /etc/apparmor.d/system_tor
</span></span><span class="line"><span class="ln"> 6</span><span class="cl">
</span></span><span class="line"><span class="ln"> 7</span><span class="cl"><span class="c1">### Enforce the Config ###</span>
</span></span><span class="line"><span class="ln"> 8</span><span class="cl">sudo aa-enforce /etc/apparmor.d/system_tor
</span></span><span class="line"><span class="ln"> 9</span><span class="cl">
</span></span><span class="line"><span class="ln">10</span><span class="cl"><span class="c1">### Sanity Check ###</span>
</span></span><span class="line"><span class="ln">11</span><span class="cl">sudo aa-status
</span></span><span class="line"><span class="ln">12</span><span class="cl">sudo systemctl restart tor</span></span></code></pre></div><p><strong>Configuring Torrc:</strong></p>
<small><i><b>It's best to attach Tor to a non-standard port on loopback and let the reverse proxy (Nginx) handle it.</b></i></small>

<p>I cannot stress how crucial it is to select HiddenServiceVersion3 over prior versions (V1/V2).</p>
<p><strong>I&rsquo;ll keep it germane:</strong> V2 utilizes its now antiquated SHA1/RSA-based PKI (1024-bit keys)—<em><a href="https://gitlab.torproject.org/legacy/trac/-/wikis/doc/HiddenServiceNames">while V3 sports modern SHA3/Ed25519 tooling</a></em>.</p>
<small><i><b>V3 is far more resistant to the ever-present, increasingly viable birthday attack and other adjacent collision-based attacks.</b></i></small>

<p><strong><em>SHAttered Doc (Worth Reading)</em>:</strong> <a href="https://shattered.io/">SHAttered</a>.</p>





<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-txt" data-lang="txt"><span class="line"><span class="ln"> 1</span><span class="cl">### /etc/tor/torrc ###
</span></span><span class="line"><span class="ln"> 2</span><span class="cl">## Bridge relays (or &#34;bridges&#34;) are Tor relays that aren&#39;t listed in the
</span></span><span class="line"><span class="ln"> 3</span><span class="cl">## main directory. Since there is no complete public list of them, even an
</span></span><span class="line"><span class="ln"> 4</span><span class="cl">## ISP that filters connections to all the known Tor relays probably
</span></span><span class="line"><span class="ln"> 5</span><span class="cl">## won&#39;t be able to block all the bridges. Also, websites won&#39;t treat you
</span></span><span class="line"><span class="ln"> 6</span><span class="cl">## differently because they won&#39;t know you&#39;re running Tor. If you can
</span></span><span class="line"><span class="ln"> 7</span><span class="cl">## be a real relay, please do; but if not, be a bridge!
</span></span><span class="line"><span class="ln"> 8</span><span class="cl">#BridgeRelay 1
</span></span><span class="line"><span class="ln"> 9</span><span class="cl">## By default, Tor will advertise your bridge to users through various
</span></span><span class="line"><span class="ln">10</span><span class="cl">## mechanisms like https://bridges.torproject.org/. If you want to run
</span></span><span class="line"><span class="ln">11</span><span class="cl">## a private bridge, for example because you&#39;ll give out your bridge
</span></span><span class="line"><span class="ln">12</span><span class="cl">## address manually to your friends, uncomment this line:
</span></span><span class="line"><span class="ln">13</span><span class="cl">#PublishServerDescriptor 0
</span></span><span class="line"><span class="ln">14</span><span class="cl">
</span></span><span class="line"><span class="ln">15</span><span class="cl">HiddenServiceDir /var/lib/tor/example_mirror
</span></span><span class="line"><span class="ln">16</span><span class="cl"># ! V3 NOT V2 ! #
</span></span><span class="line"><span class="ln">17</span><span class="cl">HiddenServiceVersion 3
</span></span><span class="line"><span class="ln">18</span><span class="cl"># ! Select a Non-Standard Port for Loopback ! #
</span></span><span class="line"><span class="ln">19</span><span class="cl"># ! Useful for Reverse Proxy Integration ! #
</span></span><span class="line"><span class="ln">20</span><span class="cl">HiddenServicePort 80 127.0.0.1:8081</span></span></code></pre></div><p>After the necessary changes have been made, you will need to restart Tor to generate the hostname and keys.</p>





<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-sh" data-lang="sh"><span class="line"><span class="ln"> 1</span><span class="cl"><span class="c1">### Restart Tor ###</span>
</span></span><span class="line"><span class="ln"> 2</span><span class="cl">sudo systemctl restart tor
</span></span><span class="line"><span class="ln"> 3</span><span class="cl">
</span></span><span class="line"><span class="ln"> 4</span><span class="cl"><span class="c1">### Check Output ###</span>
</span></span><span class="line"><span class="ln"> 5</span><span class="cl">sudo ls -lh /var/lib/tor/example_onion
</span></span><span class="line"><span class="ln"> 6</span><span class="cl">sudo cat /var/lib/tor/example_onion/hostname
</span></span><span class="line"><span class="ln"> 7</span><span class="cl">
</span></span><span class="line"><span class="ln"> 8</span><span class="cl"><span class="c1">### Output Should Be Similar ###</span>
</span></span><span class="line"><span class="ln"> 9</span><span class="cl"><span class="c1"># ! /var/lib/tor/example_onion/ ! #</span>
</span></span><span class="line"><span class="ln">10</span><span class="cl">total 16K
</span></span><span class="line"><span class="ln">11</span><span class="cl">drwx--S--- <span class="m">2</span> debian-tor debian-tor 4.0K Nov  <span class="m">7</span> 23:38 authorized_clients
</span></span><span class="line"><span class="ln">12</span><span class="cl">-rw-rw-r-- <span class="m">1</span> debian-tor debian-tor   <span class="m">63</span> Nov  <span class="m">7</span> 23:38 hostname
</span></span><span class="line"><span class="ln">13</span><span class="cl">-rw-rw-r-- <span class="m">1</span> debian-tor debian-tor   <span class="m">64</span> Nov  <span class="m">7</span> 23:38 hs_ed25519_public_key
</span></span><span class="line"><span class="ln">14</span><span class="cl">-rw------- <span class="m">1</span> debian-tor debian-tor   <span class="m">96</span> Nov  <span class="m">7</span> 23:38 hs_ed25519_secret_key
</span></span><span class="line"><span class="ln">15</span><span class="cl">
</span></span><span class="line"><span class="ln">16</span><span class="cl"><span class="c1"># ! /var/lib/tor/example_onion/hostname ! #</span>
</span></span><span class="line"><span class="ln">17</span><span class="cl">bh2k5od2ooelmftsiaxps3uod2fqwri5fmlh3opftl3aslk2jun3sgqd.onion</span></span></code></pre></div><small><i><b>Reverse proxy integration will be explained after the I2P section.</b></i></small>

<h3 id="onion-vanity-addresses">Onion Vanity Addresses</h3>
<p><a href="https://github.com/cathugger/mkp224o">Mkp224o</a> is a popular tool for generating custom addresses, though there are some limitations.</p>
<p>Because we are generating these vanity addresses via brute-force key generation, you may want to keep your character prefix short.</p>
<small><i><b>I kept my prefix around five characters (mtuck), which only took around five seconds on my VPS.</b></i></small>

<p><strong>Prerequisites:</strong></p>





<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-sh" data-lang="sh"><span class="line"><span class="ln"> 1</span><span class="cl"><span class="c1">### Download Dependencies ###</span>
</span></span><span class="line"><span class="ln"> 2</span><span class="cl">sudo apt install -y git gcc libc6-dev libsodium-dev make autoconf
</span></span><span class="line"><span class="ln"> 3</span><span class="cl">
</span></span><span class="line"><span class="ln"> 4</span><span class="cl"><span class="c1">### Clone the mkp224o Repo ###</span>
</span></span><span class="line"><span class="ln"> 5</span><span class="cl">git clone https://github.com/cathugger/mkp224o.git ~/mkp224o <span class="o">&amp;&amp;</span> <span class="nb">cd</span> ~/mkp224o
</span></span><span class="line"><span class="ln"> 6</span><span class="cl">
</span></span><span class="line"><span class="ln"> 7</span><span class="cl"><span class="c1">### Build From Source ###</span>
</span></span><span class="line"><span class="ln"> 8</span><span class="cl">./autogen.sh <span class="o">&amp;&amp;</span> ./configure <span class="o">&amp;&amp;</span> make
</span></span><span class="line"><span class="ln"> 9</span><span class="cl">
</span></span><span class="line"><span class="ln">10</span><span class="cl"><span class="c1">### Generate an Address ###</span>
</span></span><span class="line"><span class="ln">11</span><span class="cl"><span class="c1"># ! -t (threads), -n (number) ! #</span>
</span></span><span class="line"><span class="ln">12</span><span class="cl">./mkp224o mtuck -v -n <span class="m">2</span> -d example_vanity
</span></span><span class="line"><span class="ln">13</span><span class="cl">
</span></span><span class="line"><span class="ln">14</span><span class="cl"><span class="c1"># ! Output Should Be Similar ! #</span>
</span></span><span class="line"><span class="ln">15</span><span class="cl"><span class="nb">set</span> workdir: example_vanity/
</span></span><span class="line"><span class="ln">16</span><span class="cl">sorting filters... <span class="k">done</span>.
</span></span><span class="line"><span class="ln">17</span><span class="cl">filters:
</span></span><span class="line"><span class="ln">18</span><span class="cl">	mtuck
</span></span><span class="line"><span class="ln">19</span><span class="cl">in total, <span class="m">1</span> filter
</span></span><span class="line"><span class="ln">20</span><span class="cl">using <span class="m">1</span> thread
</span></span><span class="line"><span class="ln">21</span><span class="cl">mtuckh7hurljundnkqgkgcrgrfkavcnhpxa4vmmoestgry752fxvorad.onion
</span></span><span class="line"><span class="ln">22</span><span class="cl">mtuck44uiof3zofhzwl67csxc6qegyjccy4xihh45nytz5egp7ticpid.onion
</span></span><span class="line"><span class="ln">23</span><span class="cl">waiting <span class="k">for</span> threads to finish... <span class="k">done</span>.</span></span></code></pre></div><p>Then you will have to move the keys/hostname into its proper directory—<em>assuming keys/an address were already generated</em>.</p>





<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-sh" data-lang="sh"><span class="line"><span class="ln"> 1</span><span class="cl"><span class="c1">### Remove Old Files ###</span>
</span></span><span class="line"><span class="ln"> 2</span><span class="cl"><span class="c1"># ! Cleans Keys/Hostname ! #</span>
</span></span><span class="line"><span class="ln"> 3</span><span class="cl">sudo rm /var/lib/tor/example_onion/h*
</span></span><span class="line"><span class="ln"> 4</span><span class="cl">
</span></span><span class="line"><span class="ln"> 5</span><span class="cl"><span class="c1">### Copy Newly Generated Files ###</span>
</span></span><span class="line"><span class="ln"> 6</span><span class="cl">sudo cp ~/mkp224o/example_vanity/gend-address/h* /var/lib/tor/example_onion/
</span></span><span class="line"><span class="ln"> 7</span><span class="cl">
</span></span><span class="line"><span class="ln"> 8</span><span class="cl"><span class="c1">### Set Proper Ownership ###</span>
</span></span><span class="line"><span class="ln"> 9</span><span class="cl"><span class="c1"># ! Debian Uses debian-tor ! #</span>
</span></span><span class="line"><span class="ln">10</span><span class="cl">sudo chown -R debian-tor:debian-tor /var/lib/tor/example_onion
</span></span><span class="line"><span class="ln">11</span><span class="cl">
</span></span><span class="line"><span class="ln">12</span><span class="cl"><span class="c1">### Verify Perms Are Correct ###</span>
</span></span><span class="line"><span class="ln">13</span><span class="cl">sudo ls -lh /var/lib/tor/example_onion/
</span></span><span class="line"><span class="ln">14</span><span class="cl">
</span></span><span class="line"><span class="ln">15</span><span class="cl"><span class="c1">### Verify Hostname Is Correct ###</span>
</span></span><span class="line"><span class="ln">16</span><span class="cl">sudo cat /var/lib/tor/example_onion/hostname</span></span></code></pre></div><h2 id="generating-an-i2p-mirror">Generating an I2P Mirror</h2>





<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-sh" data-lang="sh"><span class="line"><span class="ln">1</span><span class="cl"><span class="c1">### Download I2PD ###</span>
</span></span><span class="line"><span class="ln">2</span><span class="cl">sudo apt update
</span></span><span class="line"><span class="ln">3</span><span class="cl">sudo apt install -y i2pd
</span></span><span class="line"><span class="ln">4</span><span class="cl">
</span></span><span class="line"><span class="ln">5</span><span class="cl"><span class="c1">### Enable I2PD ###</span>
</span></span><span class="line"><span class="ln">6</span><span class="cl">sudo systemctl <span class="nb">enable</span> --now i2pd</span></span></code></pre></div><small><i><b>Because we are not using Podman or a similar container solution, we'll need to manually download a "baseline" AA config for I2P.</b></i></small>






<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-sh" data-lang="sh"><span class="line"><span class="ln"> 1</span><span class="cl"><span class="c1">### Pull I2PD&#39;s AA Profile ###</span>
</span></span><span class="line"><span class="ln"> 2</span><span class="cl">sudo wget -O /etc/apparmor.d/usr.bin.i2pd https://raw.githubusercontent.com/PurpleI2P/i2pd/refs/heads/openssl/contrib/apparmor/usr.bin.i2pd 
</span></span><span class="line"><span class="ln"> 3</span><span class="cl">
</span></span><span class="line"><span class="ln"> 4</span><span class="cl"><span class="c1">### Audit the Config ###</span>
</span></span><span class="line"><span class="ln"> 5</span><span class="cl">sudo vim /etc/apparmor.d/usr.bin.i2pd
</span></span><span class="line"><span class="ln"> 6</span><span class="cl">
</span></span><span class="line"><span class="ln"> 7</span><span class="cl"><span class="c1">### Parse the Config ###</span>
</span></span><span class="line"><span class="ln"> 8</span><span class="cl">sudo apparmor_parser -r /etc/apparmor.d/usr.bin.i2pd
</span></span><span class="line"><span class="ln"> 9</span><span class="cl">
</span></span><span class="line"><span class="ln">10</span><span class="cl"><span class="c1">### Enforce the Config ###</span>
</span></span><span class="line"><span class="ln">11</span><span class="cl">sudo aa-enforce /etc/apparmor.d/usr.bin.i2pd
</span></span><span class="line"><span class="ln">12</span><span class="cl">
</span></span><span class="line"><span class="ln">13</span><span class="cl"><span class="c1">### Sanity Check ###</span>
</span></span><span class="line"><span class="ln">14</span><span class="cl">sudo aa-status
</span></span><span class="line"><span class="ln">15</span><span class="cl">sudo systemctl restart i2pd</span></span></code></pre></div><h3 id="configuring-i2pd">Configuring I2PD</h3>
<p>As I intend this article to be geared toward simply hosting hidden services, I unfortunately won&rsquo;t touch on I2PD-specific security (<strong>for now, haha</strong>).</p>
<small><i><b>Not to mention documentation is quite lackluster compared to the Tor Project.</b></i></small>

<p>I2PD will be the lightest solution (currently) available, with most mainstream repositories supporting it by default.</p>





<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-txt" data-lang="txt"><span class="line"><span class="ln"> 1</span><span class="cl">### /etc/i2pd/i2pd.conf ###
</span></span><span class="line"><span class="ln"> 2</span><span class="cl">## Bandwidth configuration
</span></span><span class="line"><span class="ln"> 3</span><span class="cl">## L limit bandwidth to 32 KB/sec, O - to 256 KB/sec, P - to 2048 KB/sec,
</span></span><span class="line"><span class="ln"> 4</span><span class="cl">## X - unlimited
</span></span><span class="line"><span class="ln"> 5</span><span class="cl">## Default is L (regular node) and X if floodfill mode enabled.
</span></span><span class="line"><span class="ln"> 6</span><span class="cl">## If you want to share more bandwidth without floodfill mode, uncomment
</span></span><span class="line"><span class="ln"> 7</span><span class="cl">## that line and adjust value to your possibilities. Value can be set to
</span></span><span class="line"><span class="ln"> 8</span><span class="cl">## integer in kilobytes, it will apply that limit and flag will be used
</span></span><span class="line"><span class="ln"> 9</span><span class="cl">## from next upper limit (example: if you set 4096 flag will be X, but real
</span></span><span class="line"><span class="ln">10</span><span class="cl">## limit will be 4096 KB/s). Same can be done when floodfill mode is used,
</span></span><span class="line"><span class="ln">11</span><span class="cl">## but keep in mind that low values may be negatively evaluated by Java
</span></span><span class="line"><span class="ln">12</span><span class="cl">## router algorithms.
</span></span><span class="line"><span class="ln">13</span><span class="cl"># ! Changed Mine to P (up to You) ! #
</span></span><span class="line"><span class="ln">14</span><span class="cl">bandwidth = P
</span></span><span class="line"><span class="ln">15</span><span class="cl">
</span></span><span class="line"><span class="ln">16</span><span class="cl">[http]
</span></span><span class="line"><span class="ln">17</span><span class="cl">## Web Console settings
</span></span><span class="line"><span class="ln">18</span><span class="cl">## Enable the Web Console (default: true)
</span></span><span class="line"><span class="ln">19</span><span class="cl"># ! Best to Disable the Web Console Later ! #
</span></span><span class="line"><span class="ln">20</span><span class="cl"># ! Useful for Diagnostic Info ! #
</span></span><span class="line"><span class="ln">21</span><span class="cl">enabled = false
</span></span><span class="line"><span class="ln">22</span><span class="cl">
</span></span><span class="line"><span class="ln">23</span><span class="cl">## Port to listen for connections
</span></span><span class="line"><span class="ln">24</span><span class="cl">## By default i2pd picks random port. You MUST pick a random number too,
</span></span><span class="line"><span class="ln">25</span><span class="cl">## don&#39;t just uncomment this
</span></span><span class="line"><span class="ln">26</span><span class="cl"># ! Set to a Custom Port ! #
</span></span><span class="line"><span class="ln">27</span><span class="cl"># ! Allow TCP/UDP Through WAF/Nftables ! #
</span></span><span class="line"><span class="ln">28</span><span class="cl">port = 4400</span></span></code></pre></div><p>After we&rsquo;ve configured I2PD itself, <em>we need to handle our firewall</em>!</p>





<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-sh" data-lang="sh"><span class="line"><span class="ln"> 1</span><span class="cl"><span class="c1">### UFW Config ###</span>
</span></span><span class="line"><span class="ln"> 2</span><span class="cl">sudo ufw allow 4400/tcp
</span></span><span class="line"><span class="ln"> 3</span><span class="cl">sudo ufw allow 4400/udp
</span></span><span class="line"><span class="ln"> 4</span><span class="cl">
</span></span><span class="line"><span class="ln"> 5</span><span class="cl"><span class="c1"># ! Verify ! #</span>
</span></span><span class="line"><span class="ln"> 6</span><span class="cl">sudo ufw status numbered
</span></span><span class="line"><span class="ln"> 7</span><span class="cl">
</span></span><span class="line"><span class="ln"> 8</span><span class="cl"><span class="c1">### IPtables Config ###</span>
</span></span><span class="line"><span class="ln"> 9</span><span class="cl">sudo iptables -A INPUT -p tcp -m tcp --dport <span class="m">4400</span> -j ACCEPT
</span></span><span class="line"><span class="ln">10</span><span class="cl">sudo iptables -A INPUT -p udp -m udp --dport <span class="m">4400</span> -j ACCEPT
</span></span><span class="line"><span class="ln">11</span><span class="cl">
</span></span><span class="line"><span class="ln">12</span><span class="cl"><span class="c1"># ! Verify ! #</span>
</span></span><span class="line"><span class="ln">13</span><span class="cl">sudo iptables -L -v
</span></span><span class="line"><span class="ln">14</span><span class="cl">
</span></span><span class="line"><span class="ln">15</span><span class="cl"><span class="c1"># ! Save if Needed ! #</span>
</span></span><span class="line"><span class="ln">16</span><span class="cl">sudo netfilter-persistent save</span></span></code></pre></div><p>Now that I2P can actually communicate within its network, <em>we can finally configure our eepsite</em>!</p>





<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-txt" data-lang="txt"><span class="line"><span class="ln"> 1</span><span class="cl">### /etc/i2pd/tunnels.conf ###
</span></span><span class="line"><span class="ln"> 2</span><span class="cl"># ! Comment Out Anything Unnecessary ! #
</span></span><span class="line"><span class="ln"> 3</span><span class="cl"># ! Fine To Edit Here ! #
</span></span><span class="line"><span class="ln"> 4</span><span class="cl">[eepsite]
</span></span><span class="line"><span class="ln"> 5</span><span class="cl">type = http
</span></span><span class="line"><span class="ln"> 6</span><span class="cl">host = 127.0.0.1
</span></span><span class="line"><span class="ln"> 7</span><span class="cl">port = 9090
</span></span><span class="line"><span class="ln"> 8</span><span class="cl">keys = eepsite.dat
</span></span><span class="line"><span class="ln"> 9</span><span class="cl"># ! Reverse Proxy Will Handle This ! #
</span></span><span class="line"><span class="ln">10</span><span class="cl">gzip = false</span></span></code></pre></div><p><strong>A Quick Restart Is in Order:</strong></p>





<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-sh" data-lang="sh"><span class="line"><span class="ln">1</span><span class="cl"><span class="c1">### Generates our Key ###</span>
</span></span><span class="line"><span class="ln">2</span><span class="cl">sudo systemctl restart i2pd
</span></span><span class="line"><span class="ln">3</span><span class="cl">
</span></span><span class="line"><span class="ln">4</span><span class="cl"><span class="c1">### Check the Console (if Enabled) ###</span>
</span></span><span class="line"><span class="ln">5</span><span class="cl">curl http://127.0.0.1:7070</span></span></code></pre></div><p>We&rsquo;re nearly there, but unlike Tor—I2PD doesn&rsquo;t provide readable hostnames.</p>
<p>You may access this through the web console, but I find it to be counterintuitive.</p>
<small><i><b>Especially considering you'd be required to use software like Lynx.</b></i></small>

<p>You can absolutely use <a href="https://github.com/PurpleI2P/i2pd-tools">i2pd-tools</a>, but we can just pull the address directly.</p>
<small><i><b>That repo is pertinent toward generating vanity addresses—but that doesn't concern me.</b></i></small>






<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-sh" data-lang="sh"><span class="line"><span class="ln">1</span><span class="cl"><span class="c1">### Pulling the Base32 Address ###</span>
</span></span><span class="line"><span class="ln">2</span><span class="cl">sudo apt install -y xxd
</span></span><span class="line"><span class="ln">3</span><span class="cl">sudo sh -c <span class="s1">&#39;printf &#34;%s.b32.i2p\n&#34; $(head -c 391 /var/lib/i2pd/eepsite.dat | sha256sum | xxd -r -p | base32 | sed s/=//g | tr A-Z a-z)&#39;</span>
</span></span><span class="line"><span class="ln">4</span><span class="cl">
</span></span><span class="line"><span class="ln">5</span><span class="cl"><span class="c1"># ! Output Should Be Similar (Base32) ! #</span>
</span></span><span class="line"><span class="ln">6</span><span class="cl">mqfp6dvkrpf452mvwp2ouzh7dkn4swb7dhbaas76rtpurysdckoq.b32.i2p</span></span></code></pre></div><small><i><b>Repeat for as many sites as you desire to mirror.</b></i></small>

<h2 id="reverse-proxy-integration">Reverse Proxy Integration</h2>
<p>Integrating hidden services with your existing reverse proxy is largely hassle-free.</p>
<p>Headers help clients switch to their desired mirror without having to scrounge for addresses.</p>
<p>Tor has had existing support via the Onion-Location header, but seamless I2P discovery is not as widely adopted.</p>
<p>Adding a custom header similar to Tor&rsquo;s onion-location or <strong>Alt-Svc</strong> are the most sane options.</p>
<p><strong><em>Feel Free to Reference My Web Hardening Article for Further Security Considerations</em>:</strong> <a href="/posts/web-hardening/">Web Hardening</a>.</p>
<h3 id="headers">Headers</h3>





<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-txt" data-lang="txt"><span class="line"><span class="ln"> 1</span><span class="cl">### /etc/nginx/sites-available/main ###
</span></span><span class="line"><span class="ln"> 2</span><span class="cl">server {
</span></span><span class="line"><span class="ln"> 3</span><span class="cl">    # ! Tor - Onion Header ! #
</span></span><span class="line"><span class="ln"> 4</span><span class="cl">    add_header Onion-Location &#34;http://mtuckod2ooelmftsiaxps3uod2fqwri5fmlh3opftl3aslk2jun3sgqd.onion$request_uri&#34; always;
</span></span><span class="line"><span class="ln"> 5</span><span class="cl">
</span></span><span class="line"><span class="ln"> 6</span><span class="cl">    # ! I2P - Eeepsite Header ! #
</span></span><span class="line"><span class="ln"> 7</span><span class="cl">    # ! Optional (Not Yet Widely Adopted) ! #
</span></span><span class="line"><span class="ln"> 8</span><span class="cl">    add_header Alt-Svc &#39;i2p=&#34;eepsite.b32.i2p:80&#34;; ma=86400&#39; always;
</span></span><span class="line"><span class="ln"> 9</span><span class="cl">
</span></span><span class="line"><span class="ln">10</span><span class="cl">    # ! Inlcude Security Headers ! #
</span></span><span class="line"><span class="ln">11</span><span class="cl">    include /etc/nginx/snippets/security-headers.conf;
</span></span><span class="line"><span class="ln">12</span><span class="cl">    include /etc/nginx/snippets/error-pages.conf;
</span></span><span class="line"><span class="ln">13</span><span class="cl">
</span></span><span class="line"><span class="ln">14</span><span class="cl"># ! ↓ Site Config ↓ ! #
</span></span><span class="line"><span class="ln">15</span><span class="cl">}</span></span></code></pre></div><h3 id="tor-nginx-config">Tor Nginx Config</h3>





<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-txt" data-lang="txt"><span class="line"><span class="ln"> 1</span><span class="cl">### /etc/nginx/sites-available/tutorial_tor ###
</span></span><span class="line"><span class="ln"> 2</span><span class="cl"># ! Clearnet Redirect ! #
</span></span><span class="line"><span class="ln"> 3</span><span class="cl">server {
</span></span><span class="line"><span class="ln"> 4</span><span class="cl">    listen 80;
</span></span><span class="line"><span class="ln"> 5</span><span class="cl">    server_name tor;
</span></span><span class="line"><span class="ln"> 6</span><span class="cl">    return 301 https://sld.tld$request_uri;
</span></span><span class="line"><span class="ln"> 7</span><span class="cl">}
</span></span><span class="line"><span class="ln"> 8</span><span class="cl">server {
</span></span><span class="line"><span class="ln"> 9</span><span class="cl">    # ! Only Accepting Tor ! #
</span></span><span class="line"><span class="ln">10</span><span class="cl">    listen 127.0.0.1:8081;
</span></span><span class="line"><span class="ln">11</span><span class="cl">    server_name site.onion;
</span></span><span class="line"><span class="ln">12</span><span class="cl">
</span></span><span class="line"><span class="ln">13</span><span class="cl">    # ! Include Web Contents ! #
</span></span><span class="line"><span class="ln">14</span><span class="cl">    root /var/www/example_onion;
</span></span><span class="line"><span class="ln">15</span><span class="cl">    index index.html;
</span></span><span class="line"><span class="ln">16</span><span class="cl">    
</span></span><span class="line"><span class="ln">17</span><span class="cl">    # ! Include Security Configs ! #
</span></span><span class="line"><span class="ln">18</span><span class="cl">    include /etc/nginx/snippets/tor-security-headers.conf;
</span></span><span class="line"><span class="ln">19</span><span class="cl">    include /etc/nginx/snippets/tor-error-pages.conf;
</span></span><span class="line"><span class="ln">20</span><span class="cl">
</span></span><span class="line"><span class="ln">21</span><span class="cl">    # ! Blocks Local Leaks ! #
</span></span><span class="line"><span class="ln">22</span><span class="cl">    allow 127.0.0.1;
</span></span><span class="line"><span class="ln">23</span><span class="cl">    deny all;
</span></span><span class="line"><span class="ln">24</span><span class="cl">
</span></span><span class="line"><span class="ln">25</span><span class="cl">    # ! Inlcude Security Headers ! #
</span></span><span class="line"><span class="ln">26</span><span class="cl">    # ! Remove HTTPS Related Headers ! #
</span></span><span class="line"><span class="ln">27</span><span class="cl">    include /etc/nginx/snippets/hidden-security-headers.conf;
</span></span><span class="line"><span class="ln">28</span><span class="cl">    include /etc/nginx/snippets/hidden-error-pages.conf;
</span></span><span class="line"><span class="ln">29</span><span class="cl">
</span></span><span class="line"><span class="ln">30</span><span class="cl">    # ! Logging - Respects Privacy (Hard to Correlate Anyways) ! #
</span></span><span class="line"><span class="ln">31</span><span class="cl">    access_log off;
</span></span><span class="line"><span class="ln">32</span><span class="cl">    error_log /var/log/i2p-error.log warn;
</span></span><span class="line"><span class="ln">33</span><span class="cl">
</span></span><span class="line"><span class="ln">34</span><span class="cl"># ! ↓ Site Config ↓ ! #
</span></span><span class="line"><span class="ln">35</span><span class="cl">}</span></span></code></pre></div>




<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-sh" data-lang="sh"><span class="line"><span class="ln">1</span><span class="cl"><span class="c1">### Link the Site ###</span>
</span></span><span class="line"><span class="ln">2</span><span class="cl">sudo ln -s /etc/nginx/sites-available/tutorial_tor /etc/nginx/sites-enabled/tutorial_tor
</span></span><span class="line"><span class="ln">3</span><span class="cl">
</span></span><span class="line"><span class="ln">4</span><span class="cl"><span class="c1">### Test Config ###</span>
</span></span><span class="line"><span class="ln">5</span><span class="cl">sudo nginx -t
</span></span><span class="line"><span class="ln">6</span><span class="cl">
</span></span><span class="line"><span class="ln">7</span><span class="cl"><span class="c1">### Reload Nginx ###</span>
</span></span><span class="line"><span class="ln">8</span><span class="cl">sudo nginx -s reload</span></span></code></pre></div><h3 id="i2p-nginx-config">I2P Nginx Config</h3>
<p>Configuring an I2P mirror is quite similar to Tor; just ensure that you are using a different port to properly segment traffic.</p>





<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-txt" data-lang="txt"><span class="line"><span class="ln"> 1</span><span class="cl">### /etc/nginx/sites-available/tutorial_i2p ###
</span></span><span class="line"><span class="ln"> 2</span><span class="cl"># ! Clearnet Redirect ! #
</span></span><span class="line"><span class="ln"> 3</span><span class="cl">server {
</span></span><span class="line"><span class="ln"> 4</span><span class="cl">    listen 80;
</span></span><span class="line"><span class="ln"> 5</span><span class="cl">    server_name i2p;
</span></span><span class="line"><span class="ln"> 6</span><span class="cl">    return 301 https://sld.tld$request_uri;
</span></span><span class="line"><span class="ln"> 7</span><span class="cl">}
</span></span><span class="line"><span class="ln"> 8</span><span class="cl">server {
</span></span><span class="line"><span class="ln"> 9</span><span class="cl">    # ! Only Accepting I2P ! #
</span></span><span class="line"><span class="ln">10</span><span class="cl">    listen 127.0.0.1:9091;
</span></span><span class="line"><span class="ln">11</span><span class="cl">    server_name eepsite.b32.i2p;
</span></span><span class="line"><span class="ln">12</span><span class="cl">
</span></span><span class="line"><span class="ln">13</span><span class="cl">    # ! Include Web Contents ! #
</span></span><span class="line"><span class="ln">14</span><span class="cl">    root /var/www/example_eepsite;
</span></span><span class="line"><span class="ln">15</span><span class="cl">    index index.html;
</span></span><span class="line"><span class="ln">16</span><span class="cl">    
</span></span><span class="line"><span class="ln">17</span><span class="cl">    # ! Include Security Configs ! #
</span></span><span class="line"><span class="ln">18</span><span class="cl">    include /etc/nginx/snippets/i2p-security-headers.conf;
</span></span><span class="line"><span class="ln">19</span><span class="cl">    include /etc/nginx/snippets/i2p-error-pages.conf;
</span></span><span class="line"><span class="ln">20</span><span class="cl">
</span></span><span class="line"><span class="ln">21</span><span class="cl">    # ! Blocks Local Leaks ! #
</span></span><span class="line"><span class="ln">22</span><span class="cl">    # ! I2P Uses a Larger Local Subnet ! #
</span></span><span class="line"><span class="ln">23</span><span class="cl">    # ! You Need To Be Permissive ! #
</span></span><span class="line"><span class="ln">24</span><span class="cl">    allow 127.0.0.0/8;
</span></span><span class="line"><span class="ln">25</span><span class="cl">    deny all;
</span></span><span class="line"><span class="ln">26</span><span class="cl">
</span></span><span class="line"><span class="ln">27</span><span class="cl">    # ! Inlcude Security Headers ! #
</span></span><span class="line"><span class="ln">28</span><span class="cl">    # ! Remove HTTPS Related Headers ! #
</span></span><span class="line"><span class="ln">29</span><span class="cl">    # ! Only Covering HTTP for I2P (for Now) ! #
</span></span><span class="line"><span class="ln">30</span><span class="cl">    include /etc/nginx/snippets/hidden-security-headers.conf;
</span></span><span class="line"><span class="ln">31</span><span class="cl">    include /etc/nginx/snippets/hidden-error-pages.conf;
</span></span><span class="line"><span class="ln">32</span><span class="cl">
</span></span><span class="line"><span class="ln">33</span><span class="cl">    # ! Logging - Respects Privacy (Hard to Correlate Anyways) ! #
</span></span><span class="line"><span class="ln">34</span><span class="cl">    access_log off;
</span></span><span class="line"><span class="ln">35</span><span class="cl">    error_log /var/log/i2p-error.log warn;
</span></span><span class="line"><span class="ln">36</span><span class="cl">
</span></span><span class="line"><span class="ln">37</span><span class="cl"># ! ↓ Site Config ↓ ! #
</span></span><span class="line"><span class="ln">38</span><span class="cl">}</span></span></code></pre></div>




<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-sh" data-lang="sh"><span class="line"><span class="ln">1</span><span class="cl"><span class="c1">### Link the Site ###</span>
</span></span><span class="line"><span class="ln">2</span><span class="cl">sudo ln -s /etc/nginx/sites-available/tutorial_i2p /etc/nginx/sites-enabled/tutorial_i2p
</span></span><span class="line"><span class="ln">3</span><span class="cl">
</span></span><span class="line"><span class="ln">4</span><span class="cl"><span class="c1">### Test Config ###</span>
</span></span><span class="line"><span class="ln">5</span><span class="cl">sudo nginx -t
</span></span><span class="line"><span class="ln">6</span><span class="cl">
</span></span><span class="line"><span class="ln">7</span><span class="cl"><span class="c1">### Reload Again (if Necessary) ###</span>
</span></span><span class="line"><span class="ln">8</span><span class="cl">sudo nginx -s reload</span></span></code></pre></div><h3 id="accessing-your-mirrors">Accessing Your Mirrors</h3>
<p>Because we aren&rsquo;t hosting on the conventional clearnet, we&rsquo;ll need to <strong>LOCALLY</strong> download specialized software/profiles for accessing our sites.</p>





<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-sh" data-lang="sh"><span class="line"><span class="ln"> 1</span><span class="cl"><span class="c1">### Tor ###</span>
</span></span><span class="line"><span class="ln"> 2</span><span class="cl"><span class="c1"># ! Useful for Auto-Updates/Security ! #</span>
</span></span><span class="line"><span class="ln"> 3</span><span class="cl"><span class="c1"># ! Including Flatseal ! #</span>
</span></span><span class="line"><span class="ln"> 4</span><span class="cl">flatpak install org.torproject.torbrowser-launcher com.github.tchx84.Flatseal
</span></span><span class="line"><span class="ln"> 5</span><span class="cl">
</span></span><span class="line"><span class="ln"> 6</span><span class="cl"><span class="c1"># ! Manage Flatpak Perms (if Desired) ! #</span>
</span></span><span class="line"><span class="ln"> 7</span><span class="cl">flatpak run com.github.tchx84.Flatseal
</span></span><span class="line"><span class="ln"> 8</span><span class="cl">
</span></span><span class="line"><span class="ln"> 9</span><span class="cl"><span class="c1"># ! Run the Browser ! #</span>
</span></span><span class="line"><span class="ln">10</span><span class="cl">flatpak run org.torproject.torbrowser-launcher
</span></span><span class="line"><span class="ln">11</span><span class="cl">
</span></span><span class="line"><span class="ln">12</span><span class="cl"><span class="c1">## I2P ###</span>
</span></span><span class="line"><span class="ln">13</span><span class="cl"><span class="c1"># ! Install Locally ! #</span>
</span></span><span class="line"><span class="ln">14</span><span class="cl"><span class="c1"># ! Flatpak was Finicky for Me ! #</span>
</span></span><span class="line"><span class="ln">15</span><span class="cl">sudo apt update
</span></span><span class="line"><span class="ln">16</span><span class="cl">sudo apt install -y i2pd
</span></span><span class="line"><span class="ln">17</span><span class="cl">
</span></span><span class="line"><span class="ln">18</span><span class="cl"><span class="c1"># ! Edit the Local I2PD Config as Stated Above ! #</span>
</span></span><span class="line"><span class="ln">19</span><span class="cl"><span class="c1"># ! Ignore Eeepsite Generation ! #</span>
</span></span><span class="line"><span class="ln">20</span><span class="cl">sudo systemctl <span class="nb">enable</span> --now i2pd
</span></span><span class="line"><span class="ln">21</span><span class="cl">
</span></span><span class="line"><span class="ln">22</span><span class="cl"><span class="c1">### Build a Specialized I2PD Browser (Firefox) ###</span>
</span></span><span class="line"><span class="ln">23</span><span class="cl">sudo apt install -y curl tar screen
</span></span><span class="line"><span class="ln">24</span><span class="cl"><span class="nb">cd</span> ~<span class="p">;</span> git clone https://github.com/daviduhden/i2pd-browser/
</span></span><span class="line"><span class="ln">25</span><span class="cl"><span class="nb">cd</span> i2pd-browser/build <span class="o">&amp;&amp;</span> ./build
</span></span><span class="line"><span class="ln">26</span><span class="cl">
</span></span><span class="line"><span class="ln">27</span><span class="cl"><span class="c1"># ! Start the Browser ! #</span>
</span></span><span class="line"><span class="ln">28</span><span class="cl"><span class="nb">cd</span> ../<span class="p">;</span> ./start-i2pd-browser.desktop
</span></span><span class="line"><span class="ln">29</span><span class="cl">
</span></span><span class="line"><span class="ln">30</span><span class="cl"><span class="c1"># ! Permit if Needed ! #</span>
</span></span><span class="line"><span class="ln">31</span><span class="cl">chmod +x ~/i2pd-browser/start-i2pd-browser.desktop
</span></span><span class="line"><span class="ln">32</span><span class="cl">
</span></span><span class="line"><span class="ln">33</span><span class="cl"><span class="c1"># ! Monitor the Web Console ! #</span>
</span></span><span class="line"><span class="ln">34</span><span class="cl"><span class="c1"># ! NAT Issues May Arise ! #</span>
</span></span><span class="line"><span class="ln">35</span><span class="cl"><span class="c1"># ! Can&#39;t Help Here (Sorry) ! #</span>
</span></span><span class="line"><span class="ln">36</span><span class="cl">http://127.0.0.1:7070</span></span></code></pre></div><h3 id="deployed-mirrors">Deployed Mirrors</h3>
<small><i><b>Taken from my open library.</b></i></small>

<p><strong><a href="http://mtuckwbhnyx7pk3w3vvyqydv6sag5uxcbsx6dn5q5j4olpqmlkzosbad.onion/">Tor:</a></strong></p>
<p><img src="/images/posts/hidden-services/tor-site.webp" alt="My Library’s Tor Mirror"></p>
<p><strong><a href="http://mqfp6dvkrpf452mvwp2ouzh7dkn4swb7dhbaas76rtpurysdckoq.b32.i2p/">I2P:</a></strong></p>
<p><img src="/images/posts/hidden-services/i2p-site.webp" alt="My Library’s I2P Mirror"></p>
<h2 id="outcomes">Outcomes</h2>
<p>If everything went swimmingly, you should have both an I2P and Tor mirror deployed for your site.</p>
<p>Deploying additional mirrors follows the same playbook, but make sure (<strong>REQUIRED</strong>) to segment each mirror to its respective port.</p>
<small><i><b>Note: A simple apt purge will resolve any residual misconfiguration.</b></i></small>

<p><strong>Another Thing to Keep in Mind:</strong></p>
<p>It would be wise to provide cryptographic proof of any operated sites; clear-signing is less clunky for individual statements.</p>





<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-sh" data-lang="sh"><span class="line"><span class="ln">1</span><span class="cl">gpg --clear-sign privacy-policy.txt
</span></span><span class="line"><span class="ln">2</span><span class="cl">gpg --clear-sign miror-statement.txt</span></span></code></pre></div><h2 id="closing">Closing</h2>
<p>The &ldquo;<em>dark web</em>&rdquo; connotes a notoriously poor impression from &ldquo;<em>privacy</em>&rdquo; types, but don&rsquo;t let that dissuade you.</p>
<p>Every corner of the internet has its bad actors—though admittedly there is some truth about the &ldquo;<em>privacy</em>&rdquo; community and their collective behavior.</p>
<p>Be wary of others online, especially in Fediverse <strong>cesspools</strong> like <a href="https://fsi.stanford.edu/news/addressing-child-exploitation-federated-social-media">Mastodon</a> and similar <strong><a href="https://news.ycombinator.com/item?id=44592603">(questionable)</a></strong> E2EE messengers like Matrix.</p>
<p>Any private or E2EE service procures some level of &ldquo;<em>hacker</em>&rdquo; mystique, but deploying and maintaining mirrors is rather straightforward (<em>not to mention boring</em>).</p>
<p>Architecting your own infrastructure provides a far better learning path than <em>lazily slapping</em> web files on GitHub/GitLab pages.</p>
<p><small><i><b>Trust me, that labor bears menial fruit; go lease a $5 VPS, you're better than that!</b></i></small>

<br>
<small><i><b>Shoot for learning first and ditch performative "projects."</b></i></small>
</p>
<p><em>If you are operating a mirror or really any online service, I ask that you respect your users&rsquo; privacy.</em></p>
<small><i><b>Why bother building a platform if you operate on hypocritical principles?</b></i></small>

]]></content:encoded>
    </item>
    <item>
      <title>Web Hardening</title>
      <link>https://masontuckett.xyz/posts/web-hardening/</link>
      <pubDate>Fri, 07 Nov 2025 00:38:44 -0700</pubDate><author>mason@tuckett.xyz (Mason Tuckett)</author>
      <guid>https://masontuckett.xyz/posts/web-hardening/</guid>
      <description>&lt;p&gt;A Brief Overview of Web Hardening&lt;/p&gt;&#xA;&lt;h2 id=&#34;what-is-web-hardening&#34;&gt;What is Web Hardening?&lt;/h2&gt;&#xA;&lt;p&gt;Web hardening is the intentional process of enhancing an application&amp;rsquo;s security posture—by reducing its effective attack surface.&lt;/p&gt;&#xA;&lt;p&gt;The majority of these enhancements are made at the application layer—defining and permitting how web resources may be interacted with.&lt;/p&gt;&#xA;&lt;p&gt;&lt;strong&gt;&lt;em&gt;In the following sections I will discuss hardening/mitigation strategies&lt;/em&gt;&lt;/strong&gt;: locking down headers, HSTS, SNI traps, key exchange, and a live demo.&lt;/p&gt;&#xA;&lt;h3 id=&#34;reverse-proxies&#34;&gt;Reverse Proxies&lt;/h3&gt;&#xA;&lt;p&gt;Reverse proxies are essential applications for establishing the secure flow of web traffic.&lt;/p&gt;</description>
      <content:encoded><![CDATA[<p>A Brief Overview of Web Hardening</p>
<h2 id="what-is-web-hardening">What is Web Hardening?</h2>
<p>Web hardening is the intentional process of enhancing an application&rsquo;s security posture—by reducing its effective attack surface.</p>
<p>The majority of these enhancements are made at the application layer—defining and permitting how web resources may be interacted with.</p>
<p><strong><em>In the following sections I will discuss hardening/mitigation strategies</em></strong>: locking down headers, HSTS, SNI traps, key exchange, and a live demo.</p>
<h3 id="reverse-proxies">Reverse Proxies</h3>
<p>Reverse proxies are essential applications for establishing the secure flow of web traffic.</p>
<p>Oftentimes, many reverse proxies are <strong>NOT</strong> hardened by default—<em>enabling a high ceiling for potential administrative misconfiguration.</em></p>
<p><a href="https://bluetriangle.com/blog/why-are-so-many-major-websites-operating-without-a-content-security-policy-csp">It is estimated that only a small fraction of major sites have adopted valid content security policies (CSP)</a>.</p>
<small><i><b>(Displayed below is a capture demonstrating a major educational institution; there are no hardening artifacts present).</b></i></small>

<p><img src="/images/posts/web-hardening/csp-observatory.webp" alt="Weber State University Security Score (C-) - No CSP is implemented"></p>
<p><img src="/images/posts/web-hardening/csp-observatory-2.webp" alt="Weber State University Security Score (C-) - Almost No Hardening Artifacts"></p>
<small><i><b>If not mitigated, this essentially opens the door to widespread XSS attacks; this is still not enough, even with a WAF.</b></i></small>

<h3 id="the-web">The Web</h3>
<p>Many corporations and entities are <strong>STILL</strong> quite slow regarding their adoption of comprehensive web hardening.</p>
<p><strong>Though some configurations may not be enacted due to compatibility concerns:</strong></p>
<ul>
<li>
<p><strong>TLS 1.1:</strong> <em>Mainly retained due to interoperability concerns in emerging markets (legacy Java runtimes, Windows/IE, and Android), <a href="https://www.rfc-editor.org/rfc/rfc8996">although this is declining</a></em>.</p>
</li>
<li>
<p><strong>Legacy Cipher Suites:</strong> <em>For many modern browsers these are not required (think key exchange akin to ~ TLS_RSA_WITH_AES_128_CBC-SHA)</em>.</p>
</li>
</ul>
<small><i><b>Insecure fallback ciphers (CBC) are still frequently utilized—set to their respective defaults; opt for secure AEAD ciphers for TLS 1.2+.</b></i></small>

<ul>
<li>
<p><strong>RSA Dependence:</strong> <em>A major oversight—as only antiquated browsers/runtimes lack forward secrecy (<a href="https://datatracker.ietf.org/doc/html/rfc8422">ECDHE</a>)</em>.</p>
</li>
<li>
<p><strong>HTTP/2:</strong> <em>Largely a non-issue, only affecting the speed at which non-capable (HTTP/1.1) clients load content; even QUIC (HTTP/3) support is relatively sparse</em>.</p>
</li>
</ul>
<h2 id="terminology">Terminology</h2>
<h3 id="key-concepts">Key Concepts</h3>
<ul>
<li>
<p><strong>TLS 1.3:</strong> <em>The latest iteration of <a href="https://datatracker.ietf.org/doc/html/rfc8446">Transport Layer Security</a>, a massive leap forward due to perfect forward secrecy; the TLS 1.2 era RSA exchange is deprecated—ephemeral key exchange is utilized (ECDHE).</em></p>
</li>
<li>
<p><strong>DNS Security Extensions (DNSSEC):</strong> <em>introduces digital signatures to <a href="https://www.rfc-editor.org/rfc/rfc9364">DNS records</a>—preventing MITM and spoofing attacks (critical for modern sites).</em></p>
</li>
</ul>
<p><strong>DNSSEC Heavily Relies on PKI:</strong></p>
<blockquote>
<p>DNSKEY (root public key) signs DS for <strong>.xyz</strong>.<br>
DNSKEY (tld public key) signs DS for <strong>tuckett-test</strong>.xyz.<br>
KSK (public key) verified by <strong>.xyz&rsquo;s</strong> DS.<br>
ZSK (public key) signed by KSK (private key).<br>
A record (<strong>tuckett-test.xyz</strong>) signed by ZSK (private key).</p>
</blockquote>
<small><i><b>Resulting in a robust chain of trust</b></i></small>

<ul>
<li>
<p><strong>DNS Certificate Authority Authorization (CAA):</strong> <em><a href="https://www.rfc-editor.org/rfc/rfc8659.html">Permits which certificate authorities</a> may permit TLS/SSL certificates; incredibly useful for preventing rogue issuance and impersonation.</em></p>
</li>
<li>
<p><strong>AEAD Ciphers:</strong> <em>Modern cryptographic primitive that is essential for TLS 1.3 deployment; encryption follows a <em>combined</em> step compared to CBC&rsquo;s separate encrypt and MAC functions.</em></p>
</li>
<li>
<p><strong>ALPN:</strong> <em>Enables the client to propose which protocol (HTTP/1.1, HTTP/2, or HTTP/3) it wants to use when interacting with the server (during the TLS handshake); <a href="https://www.rfc-editor.org/rfc/rfc7301">ALPN</a>.</em></p>
</li>
<li>
<p><strong>QUIC (HTTP/3):</strong> <em>Replaces traditional TCP web traffic (TCP + TLS + HTTP/2) to a singular layer over a UDP stream (443); headers are encrypted, clients send data on the first packet (0-RTT Resume vs HTTP/2 1-RTT)—<a href="https://datatracker.ietf.org/doc/html/rfc9114">offering exceptional benefits in speed</a>.</em></p>
</li>
<li>
<p><strong>Server Name Indication (SNI):</strong> <em>SNI is sent in the TLS ClientHello—allowing servers (vHosts) to select the correct certificate during the handshake.</em></p>
</li>
<li>
<p><strong>HTTP Strict Transport Security (HSTS):</strong> <em>A modern browser security feature and security policy—forcing clients to ONLY communicate using HTTPS.</em></p>
</li>
</ul>
<small><i><b>The policy (max-age) is timed, and browsers will not default to HTTP until the policy expires.</b></i></small>

<ul>
<li>
<p><strong>Content Security Policy (CSP):</strong> <em>Web headers that define server-to-client behavior—specific policies that determine <strong>how</strong> resources are accessed/interacted with, CSS elements, scripts, forms, embeds, objects, and requests.</em></p>
</li>
<li>
<p><strong>Subresource Integrity (SRI):</strong> <em>An essential security policy—<a href="https://www.w3.org/TR/sri/">utilizing hash integrity</a> (external URL <strong>-&gt;</strong> cryptographic hash) to prevent supply-chain attacks and MITM attacks—ensuring external scripts and styles are untampered.</em></p>
</li>
</ul>
<small><i><b>Take notice of the SHA-384 hash (via OWASP).</b></i></small>






<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-html" data-lang="html"><span class="line"><span class="ln">1</span><span class="cl"><span class="p">&lt;</span><span class="nt">script</span> <span class="na">src</span><span class="o">=</span><span class="s">&#34;https://example.com/example-framework.js&#34;</span>
</span></span><span class="line"><span class="ln">2</span><span class="cl">        <span class="na">integrity</span><span class="o">=</span><span class="s">&#34;sha384-oqVuAfXRKap7fdgcCY5uykM6+R9GqQ8K/uxy9rx7HNQlGYl1kPzQho1wx4JwY8wC&#34;</span>
</span></span><span class="line"><span class="ln">3</span><span class="cl">        <span class="na">crossorigin</span><span class="o">=</span><span class="s">&#34;anonymous&#34;</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="ln">4</span><span class="cl"><span class="p">&lt;/</span><span class="nt">script</span><span class="p">&gt;</span></span></span></code></pre></div><ul>
<li><strong>Online Certificate Status Protocol (OCSP):</strong> Allows clients to query a server in real-time for the revocation status of an <a href="https://www.rfc-editor.org/rfc/rfc6960">X.509 certificate</a>—a stark contrast compared to CRLs, which periodically download massive lists.</li>
</ul>
<small><i><b>Unfortunately, my provider, Let's Encrypt, has dropped support for OCSP—hence stapling's absence in my headers.</b></i></small>

<ul>
<li><strong>Certificate Transparency:</strong> CT is a public, append-only logging system that records every certificate <strong>(TLS)</strong> issued by a trusted CA—preventing rogue CAs from issuing false certificates without detection.</li>
</ul>
<h2 id="implementation">Implementation</h2>
<h3 id="use-cases">Use Cases</h3>
<p>When hosting your own website, it is <strong><em>incredibly important</em></strong> to scrutinize your threat model.</p>
<p>If you are using an SSG such as <a href="https://gohugo.io/">Hugo</a> or <a href="https://jekyllrb.com/">Jekyll</a>, deep consideration needs to be made about whether the inclusion of scripts or external elements is warranted.</p>
<p>If your goal (<em>as is mine</em>) is to host a simple blog, it is wholly unnecessary to include JS—nonetheless, <strong>non-free</strong> JS, CDNs, or fonts.</p>
<small><i><b>You CANNOT properly audit or trust third-party supply chains, and it is quite frivolous to introduce an avoidable attack surface.</b></i></small>

<p>If you are using script tags on an SSG, you defeat its intended purpose and design philosophy.</p>
<small><i><b>PLEASE DO NOT IMPLEMENT 'unsafe-inline' OR RAW HTML IN AN SSG!!!</b></i></small>

<h3 id="where-script-tags-are-warranted">Where Script Tags Are Warranted</h3>
<p>If your goal is to showcase a React portfolio or a web app, or you&rsquo;re utilizing a CMS—<em>then make sure to lock it down!</em></p>
<p>Simple one-click deployments are fantastic, but you lose the entire benefit of <em>understanding</em> your infrastructure;</p>
<small><i><b>In quite the same fashion as the privileged (root) Docker, Portainer, and TrueNAS "enthusiasts."</b></i></small>

<h2 id="prerequisites-dns">Prerequisites (DNS)</h2>
<h3 id="caa-records">CAA Records</h3>





<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-txt" data-lang="txt"><span class="line"><span class="ln">1</span><span class="cl">### DNS Records ###
</span></span><span class="line"><span class="ln">2</span><span class="cl"># ! Main CAA Record ! #
</span></span><span class="line"><span class="ln">3</span><span class="cl">CAA tuckett-test.xyz    3600    128 issue letsencrypt.org
</span></span><span class="line"><span class="ln">4</span><span class="cl">
</span></span><span class="line"><span class="ln">5</span><span class="cl"># ! Optional (Barring Wild) ! #
</span></span><span class="line"><span class="ln">6</span><span class="cl">CAA tuckett-test.xyz    3600    128 issuewild ;</span></span></code></pre></div><h3 id="dnssec">DNSSEC</h3>
<p>Refer to your registrar and hosting provider in order to activate these records.</p>
<small><i><b>For the majority of users, it is incredibly straightforward, as this process has become highly automated (one-click generation).</b></i></small>

<p><strong>Example Records:</strong></p>





<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-txt" data-lang="txt"><span class="line"><span class="ln">1</span><span class="cl">### Enable DNSKEY and DS Record for DNSSEC (USE STRONG ALGORITHMS) ###
</span></span><span class="line"><span class="ln">2</span><span class="cl">tuckett-test.xyz.	3600	IN	DNSKEY	257 3 13 ggyW7Ek6IYJeQ2vcxwyh3UFieSJ11yn3lKkBoiw6L4bmyu058Nmov0gl 46ZnmTICKQRx4O44N8VHhp0lXb6JEg==
</span></span><span class="line"><span class="ln">3</span><span class="cl">
</span></span><span class="line"><span class="ln">4</span><span class="cl">tuckett-test.xyz.	3600	IN	DS	50834 13 2 C668859BAA36112BDD75F60D8AA157DFF99F1A3845CA3431914B4DA1 89A285C8
</span></span><span class="line"><span class="ln">5</span><span class="cl">tuckett-test.xyz.	3600	IN	DS	50834 13 4 AC7F44830157D8D09B890DD345816C325EE4C663773D114A5836CBA9 29AD0A7EDF7032A082AD9E2D59D0D3938DAEA4A5</span></span></code></pre></div><h2 id="nginx">Nginx</h2>
<p>For this demonstration I will be using my existing setup, but I am currently in the process of migrating from Debian 12 to 13.</p>
<p>For now, this is a bare install (standard binary package), so—unfortunately—I won&rsquo;t be able to showcase my current transition to rootless <a href="https://podman.io/">Podman</a>.</p>
<p>There are plenty of other fantastic reverse proxies that could be substituted for Nginx; <strong>both <a href="https://caddyserver.com/">Caddy</a> and <a href="https://traefik.io/">Traefik</a> come to mind</strong>.</p>
<p><strong><em>Package Information</em></strong></p>
<small><i><b>A light selection of packages, as our threat model is largely static.</b></i></small>






<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-sh" data-lang="sh"><span class="line"><span class="ln"> 1</span><span class="cl"><span class="c1">### Standard Nginx Release ###</span>
</span></span><span class="line"><span class="ln"> 2</span><span class="cl"><span class="c1"># ! From My Mentee&#39;s System ! #</span>
</span></span><span class="line"><span class="ln"> 3</span><span class="cl">smith@smithbarlow:~$ apt-cache policy nginx
</span></span><span class="line"><span class="ln"> 4</span><span class="cl">nginx:
</span></span><span class="line"><span class="ln"> 5</span><span class="cl">  Installed: 1.26.3-3+deb13u1
</span></span><span class="line"><span class="ln"> 6</span><span class="cl">  Candidate: 1.26.3-3+deb13u1
</span></span><span class="line"><span class="ln"> 7</span><span class="cl">  Version table:
</span></span><span class="line"><span class="ln"> 8</span><span class="cl"> *** 1.26.3-3+deb13u1 <span class="m">500</span>
</span></span><span class="line"><span class="ln"> 9</span><span class="cl">        <span class="m">500</span> https://deb.debian.org/debian trixie/main amd64 Packages
</span></span><span class="line"><span class="ln">10</span><span class="cl">        <span class="m">500</span> https://debian.mirror.constant.com trixie/main amd64 Packages
</span></span><span class="line"><span class="ln">11</span><span class="cl">        <span class="m">100</span> /var/lib/dpkg/status
</span></span><span class="line"><span class="ln">12</span><span class="cl">
</span></span><span class="line"><span class="ln">13</span><span class="cl"><span class="c1">### Clear Headers ###</span>
</span></span><span class="line"><span class="ln">14</span><span class="cl">smith@smithbarlow:/etc/nginx$ apt-cache policy libnginx-mod-http-headers-more-filter
</span></span><span class="line"><span class="ln">15</span><span class="cl">libnginx-mod-http-headers-more-filter:
</span></span><span class="line"><span class="ln">16</span><span class="cl">  Installed: 1:0.38-2
</span></span><span class="line"><span class="ln">17</span><span class="cl">  Candidate: 1:0.38-2
</span></span><span class="line"><span class="ln">18</span><span class="cl">  Version table:
</span></span><span class="line"><span class="ln">19</span><span class="cl"> *** 1:0.38-2 <span class="m">500</span>
</span></span><span class="line"><span class="ln">20</span><span class="cl">        <span class="m">500</span> https://deb.debian.org/debian trixie/main amd64 Packages
</span></span><span class="line"><span class="ln">21</span><span class="cl">        <span class="m">500</span> https://debian.mirror.constant.com trixie/main amd64 Packages
</span></span><span class="line"><span class="ln">22</span><span class="cl">        <span class="m">100</span> /var/lib/dpkg/status</span></span></code></pre></div><p>I will be sticking with <strong>Debian Stable</strong>—<em>avoiding Nginx&rsquo;s official Debian repository for stability concerns</em>.</p>
<p>Configuration will still reflect each area of interest—though ideally, I&rsquo;d entirely avoid standard binary releases and opt for containerization.</p>
<p>If you are running Docker as root (when not necessary), you still open a considerable attack surface—<em>choose Podman (<strong>daemonless</strong>) as a sane alternative</em>.</p>
<small><i><b>"Complexity theater" ignores the glaring inconsistencies with using "extensive" Ansible playbooks to deploy escapable ROOT containers!</b></i></small>

<h3 id="ciphers">Ciphers</h3>
<p>You may apply these universally, or across each designated vHost:</p>





<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-txt" data-lang="txt"><span class="line"><span class="ln"> 1</span><span class="cl">### /etc/nginx/nginx.conf ###
</span></span><span class="line"><span class="ln"> 2</span><span class="cl">http {
</span></span><span class="line"><span class="ln"> 3</span><span class="cl"># ! Proto Options (TLSv1.2 Optional) ! #
</span></span><span class="line"><span class="ln"> 4</span><span class="cl">ssl_protocols TLSv1.2 TLSv1.3;
</span></span><span class="line"><span class="ln"> 5</span><span class="cl">
</span></span><span class="line"><span class="ln"> 6</span><span class="cl"># ! Manually Restrict Insecure Ciphers (Optional - TLSv1.2) ! #
</span></span><span class="line"><span class="ln"> 7</span><span class="cl">ssl_ciphers ECDHE+AESGCM:ECDHE+CHACHA20:!aNULL:!MD5:!DSS;
</span></span><span class="line"><span class="ln"> 8</span><span class="cl">
</span></span><span class="line"><span class="ln"> 9</span><span class="cl"># ! Fine-Tuning (Preferring Server Ciphers is Still Valid) ! #
</span></span><span class="line"><span class="ln">10</span><span class="cl"># ! Falls Back to secp384r1 ! #
</span></span><span class="line"><span class="ln">11</span><span class="cl">ssl_ecdh_curve X25519:secp384r1;
</span></span><span class="line"><span class="ln">12</span><span class="cl">
</span></span><span class="line"><span class="ln">13</span><span class="cl"># ! Redundant But Forces X25519 FIRST ! #
</span></span><span class="line"><span class="ln">14</span><span class="cl">ssl_conf_command Groups X25519:P-384;
</span></span><span class="line"><span class="ln">15</span><span class="cl">
</span></span><span class="line"><span class="ln">16</span><span class="cl"># ! Optional Stapling ! #
</span></span><span class="line"><span class="ln">17</span><span class="cl">ssl_stapling on;
</span></span><span class="line"><span class="ln">18</span><span class="cl">ssl_stapling_verify on;
</span></span><span class="line"><span class="ln">19</span><span class="cl">
</span></span><span class="line"><span class="ln">20</span><span class="cl"># ! Optional Resolver ! #
</span></span><span class="line"><span class="ln">21</span><span class="cl"># ! I&#39;d Advise Against Using Corporate DNS ! #
</span></span><span class="line"><span class="ln">22</span><span class="cl">resolver 1.1.1.1 8.8.8.8 valid=300s;
</span></span><span class="line"><span class="ln">23</span><span class="cl">
</span></span><span class="line"><span class="ln">24</span><span class="cl"># ! Tweak if Needed ! #
</span></span><span class="line"><span class="ln">25</span><span class="cl">resolver_timeout 10s;
</span></span><span class="line"><span class="ln">26</span><span class="cl">
</span></span><span class="line"><span class="ln">27</span><span class="cl"># ! ↓ Nginx Config ↓ ! #
</span></span><span class="line"><span class="ln">28</span><span class="cl">}</span></span></code></pre></div><h3 id="http2-http3">HTTP/2 HTTP/3</h3>
<p><strong>HTTP/2:</strong></p>





<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-txt" data-lang="txt"><span class="line"><span class="ln">1</span><span class="cl">### /etc/nginx/sites-enabled/tutorial ###
</span></span><span class="line"><span class="ln">2</span><span class="cl">server {
</span></span><span class="line"><span class="ln">3</span><span class="cl">    server_name search.tuckettlab.xyz;
</span></span><span class="line"><span class="ln">4</span><span class="cl">    listen 443 ssl;
</span></span><span class="line"><span class="ln">5</span><span class="cl">    listen [::]:443 ssl;
</span></span><span class="line"><span class="ln">6</span><span class="cl">    http2 on;
</span></span><span class="line"><span class="ln">7</span><span class="cl">
</span></span><span class="line"><span class="ln">8</span><span class="cl"># ! ↓ Site Config ↓ ! #
</span></span><span class="line"><span class="ln">9</span><span class="cl">}</span></span></code></pre></div><p><strong>HTTP/3:</strong></p>





<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-txt" data-lang="txt"><span class="line"><span class="ln"> 1</span><span class="cl">### /etc/nginx/sites-enabled/tutorial ###
</span></span><span class="line"><span class="ln"> 2</span><span class="cl">server {
</span></span><span class="line"><span class="ln"> 3</span><span class="cl">listen 443 quic reuseport;
</span></span><span class="line"><span class="ln"> 4</span><span class="cl">listen [::]:443 quic reuseport;
</span></span><span class="line"><span class="ln"> 5</span><span class="cl">
</span></span><span class="line"><span class="ln"> 6</span><span class="cl"># ! HTTP/3 Advertisement ! #
</span></span><span class="line"><span class="ln"> 7</span><span class="cl">add_header Alt-Svc &#39;h3=&#34;:443&#34;; ma=86400&#39; always;
</span></span><span class="line"><span class="ln"> 8</span><span class="cl">
</span></span><span class="line"><span class="ln"> 9</span><span class="cl"># ! ↓ Site Config ↓ ! #
</span></span><span class="line"><span class="ln">10</span><span class="cl">}</span></span></code></pre></div><p><small><i><b>I am personally not going to use HTTP/3; there is no considerable benefit for my use case.</b></i></small>

<br>
<small><i><b>I do not want another open port at this moment.</b></i></small>
</p>
<h3 id="security-headers">Security Headers</h3>
<p>I prefer using Nginx&rsquo;s snippets directory to keep my vHost configuration files tidy.</p>
<small><i><b>It's as simple as including a file from snippets to your designated vHost.</b></i></small>






<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-txt" data-lang="txt"><span class="line"><span class="ln"> 1</span><span class="cl">### /etc/nginx/sites-enabled/tutorial ###
</span></span><span class="line"><span class="ln"> 2</span><span class="cl">server {
</span></span><span class="line"><span class="ln"> 3</span><span class="cl">    server_name vhost;
</span></span><span class="line"><span class="ln"> 4</span><span class="cl">    root /var/www/tutorial;
</span></span><span class="line"><span class="ln"> 5</span><span class="cl">    index index.html;
</span></span><span class="line"><span class="ln"> 6</span><span class="cl">
</span></span><span class="line"><span class="ln"> 7</span><span class="cl">    include /etc/nginx/snippets/security-headers.conf;
</span></span><span class="line"><span class="ln"> 8</span><span class="cl">
</span></span><span class="line"><span class="ln"> 9</span><span class="cl"># ! ↓ Site Config ↓ ! #
</span></span><span class="line"><span class="ln">10</span><span class="cl">}</span></span></code></pre></div><p>Security headers can get quite complex, but I assure you that they are incredibly easy to manage.</p>
<p>I will only be able to cover a select amount of implementations—as I don&rsquo;t want this article to be incessantly exhaustive; <a href="https://developer.mozilla.org/en-US/docs/Web/HTTP/Reference/Headers/Content-Security-Policy">Mozilla has a far more granular breakdown available</a>.</p>
<small><i><b>Figured below is a basic security configuration—geared towards simple sites.</b></i></small>






<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-txt" data-lang="txt"><span class="line"><span class="ln"> 1</span><span class="cl">### /etc/nginx/snippets/security-headers.conf ###
</span></span><span class="line"><span class="ln"> 2</span><span class="cl"># ! Basic Static Site Security Configuration ! #
</span></span><span class="line"><span class="ln"> 3</span><span class="cl"># ! Includes Some Redundancy for Demo Purposes ! #
</span></span><span class="line"><span class="ln"> 4</span><span class="cl">
</span></span><span class="line"><span class="ln"> 5</span><span class="cl">### HSTS ###
</span></span><span class="line"><span class="ln"> 6</span><span class="cl"># ! Non-Preloaded Site ! #
</span></span><span class="line"><span class="ln"> 7</span><span class="cl">add_header Strict-Transport-Security &#34;max-age=31536000; includeSubDomains&#34; always;
</span></span><span class="line"><span class="ln"> 8</span><span class="cl">
</span></span><span class="line"><span class="ln"> 9</span><span class="cl"># ! Submit to Preload List (hstspreload.org)! #
</span></span><span class="line"><span class="ln">10</span><span class="cl"># ! Use After Submission ! #
</span></span><span class="line"><span class="ln">11</span><span class="cl">add_header Strict-Transport-Security &#34;max-age=31536000; includeSubDomains; preload&#34; always;
</span></span><span class="line"><span class="ln">12</span><span class="cl">
</span></span><span class="line"><span class="ln">13</span><span class="cl">### CSP ###
</span></span><span class="line"><span class="ln">14</span><span class="cl"># ! Large List of Variables (Note the Possible External Objects) ! #
</span></span><span class="line"><span class="ln">15</span><span class="cl"># ! Examples of Linkage: ! #
</span></span><span class="line"><span class="ln">16</span><span class="cl"># API: script-src &#39;self&#39; https://subdomain.sld.tld # 
</span></span><span class="line"><span class="ln">17</span><span class="cl"># Reports: report-uri &#39;self&#39; https://subdomain.sld.tld/page #
</span></span><span class="line"><span class="ln">18</span><span class="cl"># Fonts: font-src https://subdomain.sld.tld #
</span></span><span class="line"><span class="ln">19</span><span class="cl">
</span></span><span class="line"><span class="ln">20</span><span class="cl">### Content Security Policy ###
</span></span><span class="line"><span class="ln">21</span><span class="cl"># ! Explicitly Disables Worrisome Vectors ! #
</span></span><span class="line"><span class="ln">22</span><span class="cl">add_header Content-Security-Policy &#34;frame-ancestors &#39;none&#39;; default-src &#39;none&#39;; script-src &#39;none&#39;; style-src &#39;self&#39;; style-src-elem &#39;self&#39;; style-src-attr &#39;none&#39;; img-src &#39;self&#39;; connect-src &#39;none&#39;; object-src &#39;none&#39;; base-uri &#39;none&#39;; font-src &#39;none&#39;; frame-src &#39;none&#39;; media-src &#39;none&#39;; form-action &#39;none&#39;; manifest-src &#39;none&#39;; upgrade-insecure-requests&#34; always;
</span></span><span class="line"><span class="ln">23</span><span class="cl">
</span></span><span class="line"><span class="ln">24</span><span class="cl">
</span></span><span class="line"><span class="ln">25</span><span class="cl">### Additional Security Precautions ###
</span></span><span class="line"><span class="ln">26</span><span class="cl"># ! MIME-Sniffing Prevention (Browser Respects Content-Type Header) ! #
</span></span><span class="line"><span class="ln">27</span><span class="cl">add_header X-Content-Type-Options &#34;nosniff&#34; always;
</span></span><span class="line"><span class="ln">28</span><span class="cl">
</span></span><span class="line"><span class="ln">29</span><span class="cl">### Origin Integrity ###
</span></span><span class="line"><span class="ln">30</span><span class="cl"># ! Clickjacking Prevention (Legacy) - Blocks iframe Embedding ! #
</span></span><span class="line"><span class="ln">31</span><span class="cl">add_header X-Frame-Options &#34;DENY&#34; always;
</span></span><span class="line"><span class="ln">32</span><span class="cl">
</span></span><span class="line"><span class="ln">33</span><span class="cl"># ! Prevents Non-Origin Side-Channel Attacks ! #
</span></span><span class="line"><span class="ln">34</span><span class="cl"># ! Completely Breaks Tabnabbing (window.opener or Similar) # !
</span></span><span class="line"><span class="ln">35</span><span class="cl">add_header Cross-Origin-Opener-Policy &#34;same-origin&#34; always;
</span></span><span class="line"><span class="ln">36</span><span class="cl">
</span></span><span class="line"><span class="ln">37</span><span class="cl"># ! Prevents Non-Origin Embeds ! #
</span></span><span class="line"><span class="ln">38</span><span class="cl"># ! Isolates Content (Requiring CORP or CORS from cross-origin) ! #
</span></span><span class="line"><span class="ln">39</span><span class="cl">add_header Cross-Origin-Embedder-Policy &#34;require-corp&#34; always;
</span></span><span class="line"><span class="ln">40</span><span class="cl">
</span></span><span class="line"><span class="ln">41</span><span class="cl"># ! Blocks Non-Origin From Loading Resources ! #
</span></span><span class="line"><span class="ln">42</span><span class="cl"># ! Resource Theft/Exfiltration (fetch() or Similar) ! #
</span></span><span class="line"><span class="ln">43</span><span class="cl">add_header Cross-Origin-Resource-Policy &#34;same-origin&#34; always;
</span></span><span class="line"><span class="ln">44</span><span class="cl">
</span></span><span class="line"><span class="ln">45</span><span class="cl"># ! Cross-Origin Isolation ! #
</span></span><span class="line"><span class="ln">46</span><span class="cl"># ! Isolates Processes (Renders) ! #
</span></span><span class="line"><span class="ln">47</span><span class="cl"># ! &#34;?0&#34; (Disables) Effectively Groups All Into One Process ! #
</span></span><span class="line"><span class="ln">48</span><span class="cl">add_header Origin-Agent-Cluster &#34;?1&#34; always;
</span></span><span class="line"><span class="ln">49</span><span class="cl">
</span></span><span class="line"><span class="ln">50</span><span class="cl">### Referrer Policy ###
</span></span><span class="line"><span class="ln">51</span><span class="cl"># ! Does Not Disclose Source (Your Website -&gt; Linked Site) ! #
</span></span><span class="line"><span class="ln">52</span><span class="cl"># ! Prevents Analytics Bleed (Respects Privacy) ! #
</span></span><span class="line"><span class="ln">53</span><span class="cl">add_header Referrer-Policy &#34;no-referrer&#34; always;
</span></span><span class="line"><span class="ln">54</span><span class="cl">
</span></span><span class="line"><span class="ln">55</span><span class="cl">### Permissions Policy ###
</span></span><span class="line"><span class="ln">56</span><span class="cl"># ! Important for Dynamic Sites or Services (Some May Be Deprecated, Best to Disable Everything Unnecessary) ! #
</span></span><span class="line"><span class="ln">57</span><span class="cl"># ! Static Configuration - Note Format: service=() (Blocked) ! #
</span></span><span class="line"><span class="ln">58</span><span class="cl"># ! Dynamic Configuration - Note Format: service=[](subdomain.sld.tld) (Integrates API into Permissions Policy) ! #
</span></span><span class="line"><span class="ln">59</span><span class="cl"># ! Included for Demonstration Purposes (Small List): ! #
</span></span><span class="line"><span class="ln">60</span><span class="cl">
</span></span><span class="line"><span class="ln">61</span><span class="cl">add_header Permissions-Policy &#34;accelerometer=(), autoplay=(), battery=()&#34; always;</span></span></code></pre></div><h3 id="sri">SRI</h3>
<p>You will first need to generate a valid hash for your desired assets.</p>





<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-sh" data-lang="sh"><span class="line"><span class="ln">1</span><span class="cl"><span class="c1">### Generating the Hash ###</span>
</span></span><span class="line"><span class="ln">2</span><span class="cl"><span class="c1"># ! Opting for SHA-384 ! #</span>
</span></span><span class="line"><span class="ln">3</span><span class="cl">user@pc:~$ <span class="nb">printf</span> <span class="s1">&#39;sha384-%s\n&#39;</span> <span class="s2">&#34;</span><span class="k">$(</span>openssl dgst -sha384 -binary eg.js <span class="p">|</span> openssl base64 -A<span class="k">)</span><span class="s2">&#34;</span>
</span></span><span class="line"><span class="ln">4</span><span class="cl">sha384-bhFRYtN+I8sKH7+Y95efRQxwXuwViLZyl+42or4SE0+Q1uXOKHMK1Lym2jk2mq7k</span></span></code></pre></div><p><strong><em>Then add your generated hash to any applicable HTML page:</em></strong></p>





<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-html" data-lang="html"><span class="line"><span class="ln">1</span><span class="cl"><span class="c">&lt;!-- crossorigin is Optional - Add if CORS Is Required (Best To Leave Anonymous for Privacy) --&gt;</span>
</span></span><span class="line"><span class="ln">2</span><span class="cl"><span class="p">&lt;</span><span class="nt">script</span> <span class="na">src</span><span class="o">=</span><span class="s">&#34;/eg.js&#34;</span>
</span></span><span class="line"><span class="ln">3</span><span class="cl">        <span class="na">integrity</span><span class="o">=</span><span class="s">&#34;sha384-bhFRYtN+I8sKH7+Y95efRQxwXuwViLZyl+42or4SE0+Q1uXOKHMK1Lym2jk2mq7k&#34;</span>
</span></span><span class="line"><span class="ln">4</span><span class="cl">        <span class="na">crossorigin</span><span class="o">=</span><span class="s">&#34;anonymous&#34;</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="ln">5</span><span class="cl"><span class="p">&lt;/</span><span class="nt">script</span><span class="p">&gt;</span></span></span></code></pre></div><p><strong><em>Implementing an SRI check in your reverse proxy goes as follows:</em></strong></p>





<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-txt" data-lang="txt"><span class="line"><span class="ln"> 1</span><span class="cl">### /etc/nginx/sites-enabled/sri-example ###
</span></span><span class="line"><span class="ln"> 2</span><span class="cl">server {
</span></span><span class="line"><span class="ln"> 3</span><span class="cl">    server_name vhost;
</span></span><span class="line"><span class="ln"> 4</span><span class="cl">    
</span></span><span class="line"><span class="ln"> 5</span><span class="cl">    # ! Blocks (Enforces Valid Resources) Scripts/Styles if SRI Check Fails ! #
</span></span><span class="line"><span class="ln"> 6</span><span class="cl">    add_header Integrity-Policy &#39;blocked-destinations=(script style), endpoints=(integrity)&#39; always;
</span></span><span class="line"><span class="ln"> 7</span><span class="cl">
</span></span><span class="line"><span class="ln"> 8</span><span class="cl">    # ! Report Only Mode ! #
</span></span><span class="line"><span class="ln"> 9</span><span class="cl">    add_header Integrity-Policy-Report-Only &#39;blocked-destinations=(script style), endpoints=(integrity)&#39; always;
</span></span><span class="line"><span class="ln">10</span><span class="cl">
</span></span><span class="line"><span class="ln">11</span><span class="cl">    # ! Specifies Reporting Endpoint (if Needed) ! #
</span></span><span class="line"><span class="ln">12</span><span class="cl">    add_header Reporting-Endpoints &#39;integrity=&#34;https://tld.sld/report&#34;&#39; always;
</span></span><span class="line"><span class="ln">13</span><span class="cl">
</span></span><span class="line"><span class="ln">14</span><span class="cl">    # ! Considering Preloading if Possible (Add &#34;crossorigin=&#34; if Required) ! #
</span></span><span class="line"><span class="ln">15</span><span class="cl">    # ! Unrelated to HSTS ! #
</span></span><span class="line"><span class="ln">16</span><span class="cl">    add_header Link &#39;&lt;/eg.js&gt;; rel=preload; as=script; integrity=&#34;sha384-bhFRYtN...&#34; always;   
</span></span><span class="line"><span class="ln">17</span><span class="cl">
</span></span><span class="line"><span class="ln">18</span><span class="cl"># ! ↓ Site Config ↓ ! #
</span></span><span class="line"><span class="ln">19</span><span class="cl">}</span></span></code></pre></div><h3 id="caching">Caching</h3>
<p>Caching is incredibly effective in improving response times for HTTP clients.</p>
<p>Serving immutable assets can <em>drastically</em> improve site performance.</p>





<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-txt" data-lang="txt"><span class="line"><span class="ln"> 1</span><span class="cl">### /etc/nginx/sites-enabled/tutorial ###
</span></span><span class="line"><span class="ln"> 2</span><span class="cl">server {
</span></span><span class="line"><span class="ln"> 3</span><span class="cl">    # ! Immutable Caching (Matches Common Files) ! #
</span></span><span class="line"><span class="ln"> 4</span><span class="cl">    location ~* \.(css|js|woff2|ico|svg|png|jpg|jpeg|webp)$ {
</span></span><span class="line"><span class="ln"> 5</span><span class="cl">        try_files $uri =404;
</span></span><span class="line"><span class="ln"> 6</span><span class="cl">        add_header Cache-Control &#34;public, max-age=31536000, immutable&#34; always;
</span></span><span class="line"><span class="ln"> 7</span><span class="cl">        expires 1y;
</span></span><span class="line"><span class="ln"> 8</span><span class="cl">    }
</span></span><span class="line"><span class="ln"> 9</span><span class="cl">
</span></span><span class="line"><span class="ln">10</span><span class="cl"># ! ↓ Site Config ↓ ! #
</span></span><span class="line"><span class="ln">11</span><span class="cl">}</span></span></code></pre></div><h3 id="method-restriction">Method Restriction</h3>
<p>It is quite easy to limit the possible HTTP methods that threat actors may utilize for exploitation.</p>
<p>Limiting your request methods ensures that certain types of common attack-related methods (e.g., <strong>PUT</strong>, <strong>DELETE</strong>, <strong>TRACE</strong>) cannot be performed.</p>
<small><i><b>It is best to limit your vHost's possible request methods to your intended use case.</b></i></small>






<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-txt" data-lang="txt"><span class="line"><span class="ln">1</span><span class="cl">### /etc/nginx/sites-enabled/tutorial ###
</span></span><span class="line"><span class="ln">2</span><span class="cl">server {
</span></span><span class="line"><span class="ln">3</span><span class="cl">    location / {
</span></span><span class="line"><span class="ln">4</span><span class="cl">        limit_except GET HEAD { deny all; }
</span></span><span class="line"><span class="ln">5</span><span class="cl">        try_files $uri $uri/ =404;
</span></span><span class="line"><span class="ln">6</span><span class="cl">    }
</span></span><span class="line"><span class="ln">7</span><span class="cl">
</span></span><span class="line"><span class="ln">8</span><span class="cl"># ! ↓ Site Config ↓ ! #
</span></span><span class="line"><span class="ln">9</span><span class="cl">}</span></span></code></pre></div><h3 id="ua-gating">UA-Gating</h3>
<p>UA-gating is largely trivial, as scanners/attackers frequently spoof user agents; <strong>this is not a <em>bulletproof</em> security measure</strong>.</p>





<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-txt" data-lang="txt"><span class="line"><span class="ln"> 1</span><span class="cl">### /etc/nginx/nginx.conf ###
</span></span><span class="line"><span class="ln"> 2</span><span class="cl">http {
</span></span><span class="line"><span class="ln"> 3</span><span class="cl">    map $http_user_agent $allowed_ua {
</span></span><span class="line"><span class="ln"> 4</span><span class="cl">    # ! Denied by Default ! #
</span></span><span class="line"><span class="ln"> 5</span><span class="cl">        default 0;
</span></span><span class="line"><span class="ln"> 6</span><span class="cl">
</span></span><span class="line"><span class="ln"> 7</span><span class="cl">    # ! Example Chromium Config (Simple Regex &gt;120) ! #
</span></span><span class="line"><span class="ln"> 8</span><span class="cl">        ~*Chrome/[1-9][2-9][0-9]|Chrome/1[2-9][0-9]|Chrome/[2-9][0-9][0-9] 1;
</span></span><span class="line"><span class="ln"> 9</span><span class="cl">    }
</span></span><span class="line"><span class="ln">10</span><span class="cl">
</span></span><span class="line"><span class="ln">11</span><span class="cl"># ! ↓ Nginx Config ↓ ! #
</span></span><span class="line"><span class="ln">12</span><span class="cl">}
</span></span><span class="line"><span class="ln">13</span><span class="cl">
</span></span><span class="line"><span class="ln">14</span><span class="cl">### /etc/nginx/sites-enabled/tutorial ###
</span></span><span class="line"><span class="ln">15</span><span class="cl">server {
</span></span><span class="line"><span class="ln">16</span><span class="cl">    if ($allowed_ua = 0) { return 403; }
</span></span><span class="line"><span class="ln">17</span><span class="cl">
</span></span><span class="line"><span class="ln">18</span><span class="cl"># ! ↓ Site Config ↓ ! #
</span></span><span class="line"><span class="ln">19</span><span class="cl">}</span></span></code></pre></div><h3 id="rate-limiting">Rate-Limiting</h3>
<p>Rate-limiting is of exceptional importance when serving content over the internet.</p>
<p>Astoundingly, it is somewhat rare to see operators implement this effectively.</p>





<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-txt" data-lang="txt"><span class="line"><span class="ln">1</span><span class="cl">### /etc/nginx/nginx.conf ###
</span></span><span class="line"><span class="ln">2</span><span class="cl">http {
</span></span><span class="line"><span class="ln">3</span><span class="cl"># ! 10 MB of Entries - 10 Requests a Second ! #
</span></span><span class="line"><span class="ln">4</span><span class="cl"># ! You May Also Subtitute r/s for r/m (Minute) ! #
</span></span><span class="line"><span class="ln">5</span><span class="cl">limit_req_zone  $binary_remote_addr  zone=request_rate_limit:10m  rate=10r/s;
</span></span><span class="line"><span class="ln">6</span><span class="cl">limit_conn_zone $binary_remote_addr  zone=connections_rate_limit:10m;
</span></span><span class="line"><span class="ln">7</span><span class="cl">
</span></span><span class="line"><span class="ln">8</span><span class="cl"># ! ↓ Nginx Config ↓ ! #
</span></span><span class="line"><span class="ln">9</span><span class="cl">}</span></span></code></pre></div>




<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-txt" data-lang="txt"><span class="line"><span class="ln"> 1</span><span class="cl">### /etc/nginx/sites-enabled/tutorial ###
</span></span><span class="line"><span class="ln"> 2</span><span class="cl">server {
</span></span><span class="line"><span class="ln"> 3</span><span class="cl">    # ! Burst of 20 (More Forgiving) ! #
</span></span><span class="line"><span class="ln"> 4</span><span class="cl">    limit_req  zone=request_rate_limit  burst=20  nodelay;
</span></span><span class="line"><span class="ln"> 5</span><span class="cl">    limit_conn connections_rate_limit 20;
</span></span><span class="line"><span class="ln"> 6</span><span class="cl">
</span></span><span class="line"><span class="ln"> 7</span><span class="cl">    # ! Returns 429 (Too Many Requests) ! #
</span></span><span class="line"><span class="ln"> 8</span><span class="cl">    limit_req_status 429;
</span></span><span class="line"><span class="ln"> 9</span><span class="cl">    limit_conn_status 429;
</span></span><span class="line"><span class="ln">10</span><span class="cl">
</span></span><span class="line"><span class="ln">11</span><span class="cl">    # ! Optional Logging (Bare Response) ! #
</span></span><span class="line"><span class="ln">12</span><span class="cl">    error_page 429 = @ratelimit;
</span></span><span class="line"><span class="ln">13</span><span class="cl">    location @ratelimit {
</span></span><span class="line"><span class="ln">14</span><span class="cl">    internal;
</span></span><span class="line"><span class="ln">15</span><span class="cl">    include /etc/nginx/snippets/security-headers.conf;
</span></span><span class="line"><span class="ln">16</span><span class="cl">    access_log /var/log/nginx/rate_limit.log;
</span></span><span class="line"><span class="ln">17</span><span class="cl">    default_type text/plain;
</span></span><span class="line"><span class="ln">18</span><span class="cl">    return 429 &#34;429 - I See You\n&#34;;
</span></span><span class="line"><span class="ln">19</span><span class="cl">    }
</span></span><span class="line"><span class="ln">20</span><span class="cl">
</span></span><span class="line"><span class="ln">21</span><span class="cl"># ! ↓ Site Config ↓ ! #
</span></span><span class="line"><span class="ln">22</span><span class="cl">}</span></span></code></pre></div><small><i><b>Related, yet VERY tight for my static site:</b></i></small>

<p><strong>Buffer/Body Protection:</strong></p>





<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-txt" data-lang="txt"><span class="line"><span class="ln"> 1</span><span class="cl">### /etc/nginx/sites-enabled/tutorial ###
</span></span><span class="line"><span class="ln"> 2</span><span class="cl">server {
</span></span><span class="line"><span class="ln"> 3</span><span class="cl">    # ! Overflow Protection (Miniscule Ceilings) ! #
</span></span><span class="line"><span class="ln"> 4</span><span class="cl">    # ! Limiting Methods Will Mitigate Uploads ! #
</span></span><span class="line"><span class="ln"> 5</span><span class="cl">    client_max_body_size 1k;
</span></span><span class="line"><span class="ln"> 6</span><span class="cl">
</span></span><span class="line"><span class="ln"> 7</span><span class="cl">    # ! You Might Need to Bump These Up (2k, 2 4k) ! #
</span></span><span class="line"><span class="ln"> 8</span><span class="cl">    client_header_buffer_size 1k;
</span></span><span class="line"><span class="ln"> 9</span><span class="cl">    large_client_header_buffers 2 1k;
</span></span><span class="line"><span class="ln">10</span><span class="cl">
</span></span><span class="line"><span class="ln">11</span><span class="cl">    # ! Proxy Specific (if Needed) ! #
</span></span><span class="line"><span class="ln">12</span><span class="cl">    proxy_buffer_size 1k;
</span></span><span class="line"><span class="ln">13</span><span class="cl">    proxy_buffers 2 1k;
</span></span><span class="line"><span class="ln">14</span><span class="cl">    proxy_busy_buffers_size 1k;
</span></span><span class="line"><span class="ln">15</span><span class="cl">
</span></span><span class="line"><span class="ln">16</span><span class="cl">    # ! Specifies How Long Timeouts Will Be ! #
</span></span><span class="line"><span class="ln">17</span><span class="cl">    client_body_timeout 20s;
</span></span><span class="line"><span class="ln">18</span><span class="cl">    client_header_timeout 20s;
</span></span><span class="line"><span class="ln">19</span><span class="cl">    send_timeout 20s;
</span></span><span class="line"><span class="ln">20</span><span class="cl">
</span></span><span class="line"><span class="ln">21</span><span class="cl">    # ! Specifies How Many Concurrent HTTP/2 Streams ! #
</span></span><span class="line"><span class="ln">22</span><span class="cl">    # ! I am More Forgiving Here ! #
</span></span><span class="line"><span class="ln">23</span><span class="cl">    http2_max_concurrent_streams 48;
</span></span><span class="line"><span class="ln">24</span><span class="cl">
</span></span><span class="line"><span class="ln">25</span><span class="cl"># ! ↓ Site Config ↓ ! #
</span></span><span class="line"><span class="ln">26</span><span class="cl">}</span></span></code></pre></div><h3 id="sni-trap">SNI Trap</h3>
<p>As modern browsers support SNI by default—<em>it is best to set an SNI <strong>&ldquo;trap&rdquo;</strong> to reduce low-effort scanners and potential fingerprinting</em>.</p>
<small><i><b>Optional, but highly recommended; institutes a "feature-lockout" mitigatory strategy</b></i></small>






<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-txt" data-lang="txt"><span class="line"><span class="ln">1</span><span class="cl">### /etc/nginx/sites-enabled/default ###
</span></span><span class="line"><span class="ln">2</span><span class="cl"># ! HTTP #
</span></span><span class="line"><span class="ln">3</span><span class="cl">server { listen 80 default_server;  listen [::]:80 default_server;  server_name _; return 444; }
</span></span><span class="line"><span class="ln">4</span><span class="cl">
</span></span><span class="line"><span class="ln">5</span><span class="cl"># ! HTTPS ! #
</span></span><span class="line"><span class="ln">6</span><span class="cl">server { listen 443 ssl default_server; listen [::]:443 ssl default_server; server_name _; ssl_reject_handshake on; }</span></span></code></pre></div><p><em>Another crucial step to reduce trivial spoofing is to implement a simple host <strong>sanity</strong> check:</em></p>





<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-txt" data-lang="txt"><span class="line"><span class="ln"> 1</span><span class="cl">### /etc/nginx/sites-enabled/tutorial ###
</span></span><span class="line"><span class="ln"> 2</span><span class="cl">server {
</span></span><span class="line"><span class="ln"> 3</span><span class="cl">    listen 443 ssl;
</span></span><span class="line"><span class="ln"> 4</span><span class="cl">    # ! Must Be Hardcoded ! #
</span></span><span class="line"><span class="ln"> 5</span><span class="cl">    server_name sld.tld;
</span></span><span class="line"><span class="ln"> 6</span><span class="cl">
</span></span><span class="line"><span class="ln"> 7</span><span class="cl">    if ($host != &#34;sld.tld&#34;) { return 421; }
</span></span><span class="line"><span class="ln"> 8</span><span class="cl">    return 301 https://sld.tld$request_uri;
</span></span><span class="line"><span class="ln"> 9</span><span class="cl"># ! ↓ Site Config ↓ ! #
</span></span><span class="line"><span class="ln">10</span><span class="cl">}</span></span></code></pre></div><h2 id="privacy-precautions">Privacy Precautions</h2>
<p>Just as you may configure your infrastructure to respect its users&rsquo; privacy, the infrastructure itself should be as invisible as possible.</p>
<p>Obviously, introducing unnecessary JS and other insipid tracking vectors opens a slew of potential routes for malicious actors—<em>hence the intrinsic case for web minimalism</em>.</p>
<p>Introspect, and reflect honestly on the potential ramifications of perpetuating incessant tracking; how will your own infrastructure backstab you?</p>
<small><i><b>Analytics, even for small, static sites—presents nothing but NEGATIVE connotations (for me).</b></i></small>

<h3 id="fingerprinting-mitigation">Fingerprinting Mitigation</h3>
<p>It is impossible to completely hide your stack and its latent infrastructure.</p>
<p>Although most reverse proxies have optional modules and built-in options for minimizing exposure.</p>
<small><i><b>Trixie repositories contain a substantial, mitigatory module: libnginx-mod-http-headers-more-filter.</b></i></small>






<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-txt" data-lang="txt"><span class="line"><span class="ln"> 1</span><span class="cl">### /etc/nginx/nginx.conf ###
</span></span><span class="line"><span class="ln"> 2</span><span class="cl">http {
</span></span><span class="line"><span class="ln"> 3</span><span class="cl">    # ! DISABLE THIS IMMEDIATELY ! #
</span></span><span class="line"><span class="ln"> 4</span><span class="cl">    # ! DISPLAYS YOUR FULL STACK ! #
</span></span><span class="line"><span class="ln"> 5</span><span class="cl">	server_tokens off;
</span></span><span class="line"><span class="ln"> 6</span><span class="cl">
</span></span><span class="line"><span class="ln"> 7</span><span class="cl">	# ! Strips Additional Server Info ! #
</span></span><span class="line"><span class="ln"> 8</span><span class="cl">	more_clear_headers Server;
</span></span><span class="line"><span class="ln"> 9</span><span class="cl">	more_clear_headers X-Powered-By;
</span></span><span class="line"><span class="ln">10</span><span class="cl">
</span></span><span class="line"><span class="ln">11</span><span class="cl">    # ! HTTP Status Codes (Include More if Needed) ! #
</span></span><span class="line"><span class="ln">12</span><span class="cl">	more_clear_headers -s 200 404 Server;
</span></span><span class="line"><span class="ln">13</span><span class="cl">
</span></span><span class="line"><span class="ln">14</span><span class="cl">    # ! Proxy Specific # !
</span></span><span class="line"><span class="ln">15</span><span class="cl">	proxy_hide_header Server;
</span></span><span class="line"><span class="ln">16</span><span class="cl">	fastcgi_hide_header X-Powered-By;
</span></span><span class="line"><span class="ln">17</span><span class="cl">	uwsgi_hide_header Server;
</span></span><span class="line"><span class="ln">18</span><span class="cl">	scgi_hide_header Server;
</span></span><span class="line"><span class="ln">19</span><span class="cl">
</span></span><span class="line"><span class="ln">20</span><span class="cl">    # ! SSL Specific ! #
</span></span><span class="line"><span class="ln">21</span><span class="cl">	ssl_early_data off;
</span></span><span class="line"><span class="ln">22</span><span class="cl">	ssl_session_tickets off;
</span></span><span class="line"><span class="ln">23</span><span class="cl">
</span></span><span class="line"><span class="ln">24</span><span class="cl"># ! ↓ Nginx Config ↓ ! #
</span></span><span class="line"><span class="ln">25</span><span class="cl">}</span></span></code></pre></div>




<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-txt" data-lang="txt"><span class="line"><span class="ln">1</span><span class="cl">### /etc/nginx/snippets/error-pages.conf ###
</span></span><span class="line"><span class="ln">2</span><span class="cl">error_page 404 =404 @e404;
</span></span><span class="line"><span class="ln">3</span><span class="cl">
</span></span><span class="line"><span class="ln">4</span><span class="cl"># ! Optional - Link CSP if You&#39;re Crazy Like Me ! #
</span></span><span class="line"><span class="ln">5</span><span class="cl">location @e404 { internal; default_type text/plain; include /etc/nginx/snippets/security-headers.conf; return 404 &#34;404\n&#34;; }</span></span></code></pre></div>




<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-txt" data-lang="txt"><span class="line"><span class="ln"> 1</span><span class="cl">### /etc/nginx/sites-enabled/tutorial ###
</span></span><span class="line"><span class="ln"> 2</span><span class="cl">server {
</span></span><span class="line"><span class="ln"> 3</span><span class="cl">    # ! MAKE SURE TO ADD THIS ! #
</span></span><span class="line"><span class="ln"> 4</span><span class="cl">    include /etc/nginx/snippets/error-pages.conf;
</span></span><span class="line"><span class="ln"> 5</span><span class="cl">
</span></span><span class="line"><span class="ln"> 6</span><span class="cl">    # ! Optionally Disable Logs for User Privacy ! #
</span></span><span class="line"><span class="ln"> 7</span><span class="cl">    access_log off;
</span></span><span class="line"><span class="ln"> 8</span><span class="cl">    error_log /var/log/nginx/example-error.log
</span></span><span class="line"><span class="ln"> 9</span><span class="cl">
</span></span><span class="line"><span class="ln">10</span><span class="cl"># ! ↓ Site Config ↓ ! #
</span></span><span class="line"><span class="ln">11</span><span class="cl">}</span></span></code></pre></div><h3 id="apparmor">AppArmor</h3>
<p>Because this is a bare-install, we&rsquo;ll need to configure a MAC solution for Nginx.</p>
<p>Apparmor is a fantastic MAC tool, which is quite comparable to SELinux.</p>
<small><i><b>Installing and configuring Apparmor is incredibly user-friendly—as the syntax is nearly foolproof.</b></i></small>






<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-sh" data-lang="sh"><span class="line"><span class="ln">1</span><span class="cl"><span class="c1">### Installing AppArmor ###</span>
</span></span><span class="line"><span class="ln">2</span><span class="cl">sudo apt update
</span></span><span class="line"><span class="ln">3</span><span class="cl">sudo apt install -y apparmor apparmor-utils 
</span></span><span class="line"><span class="ln">4</span><span class="cl">
</span></span><span class="line"><span class="ln">5</span><span class="cl"><span class="c1">### Enable AppArmor ###</span>
</span></span><span class="line"><span class="ln">6</span><span class="cl">sudo systemctl <span class="nb">enable</span> --now apparmor</span></span></code></pre></div><small><i><b>Now comes the profile!</b></i></small>






<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-txt" data-lang="txt"><span class="line"><span class="ln"> 1</span><span class="cl">### /etc/apparmor.d/usr.sbin.nginx ###
</span></span><span class="line"><span class="ln"> 2</span><span class="cl"># ! Basic AA Profile ! #
</span></span><span class="line"><span class="ln"> 3</span><span class="cl"># ! Audit &amp; Tweak to Your Needs ! #
</span></span><span class="line"><span class="ln"> 4</span><span class="cl">
</span></span><span class="line"><span class="ln"> 5</span><span class="cl">#include &lt;tunables/global&gt;
</span></span><span class="line"><span class="ln"> 6</span><span class="cl">
</span></span><span class="line"><span class="ln"> 7</span><span class="cl">profile /usr/sbin/nginx flags=(attach_disconnected, mediate_deleted) {
</span></span><span class="line"><span class="ln"> 8</span><span class="cl">
</span></span><span class="line"><span class="ln"> 9</span><span class="cl">  include &lt;abstractions/base&gt;
</span></span><span class="line"><span class="ln">10</span><span class="cl">  include &lt;abstractions/nameservice&gt;
</span></span><span class="line"><span class="ln">11</span><span class="cl">  include &lt;abstractions/ssl_certs&gt;
</span></span><span class="line"><span class="ln">12</span><span class="cl">
</span></span><span class="line"><span class="ln">13</span><span class="cl">  # ! Caps ! #
</span></span><span class="line"><span class="ln">14</span><span class="cl">  #  - net_bind_service: bind 80/443
</span></span><span class="line"><span class="ln">15</span><span class="cl">  #  - set{u,g}id: drop to www-data
</span></span><span class="line"><span class="ln">16</span><span class="cl">  #  - dac_*: let root master open/rotate logs owned 0640 www-data:adm
</span></span><span class="line"><span class="ln">17</span><span class="cl">  capability net_bind_service,
</span></span><span class="line"><span class="ln">18</span><span class="cl">  capability setgid,
</span></span><span class="line"><span class="ln">19</span><span class="cl">  capability setuid,
</span></span><span class="line"><span class="ln">20</span><span class="cl">  capability dac_override,
</span></span><span class="line"><span class="ln">21</span><span class="cl">  capability dac_read_search,
</span></span><span class="line"><span class="ln">22</span><span class="cl">
</span></span><span class="line"><span class="ln">23</span><span class="cl">  # ! Networking Settings ! #
</span></span><span class="line"><span class="ln">24</span><span class="cl">  network inet stream,
</span></span><span class="line"><span class="ln">25</span><span class="cl">  deny network raw,
</span></span><span class="line"><span class="ln">26</span><span class="cl">
</span></span><span class="line"><span class="ln">27</span><span class="cl">  # ! Binary Used ! #
</span></span><span class="line"><span class="ln">28</span><span class="cl">  /usr/sbin/nginx mr,
</span></span><span class="line"><span class="ln">29</span><span class="cl">
</span></span><span class="line"><span class="ln">30</span><span class="cl">  # ! Read-Only Access ! #
</span></span><span class="line"><span class="ln">31</span><span class="cl">  /etc/nginx/**                 r,
</span></span><span class="line"><span class="ln">32</span><span class="cl">  /etc/letsencrypt/**           r,
</span></span><span class="line"><span class="ln">33</span><span class="cl">  /usr/share/nginx/**           r,
</span></span><span class="line"><span class="ln">34</span><span class="cl">  /etc/mime.types               r,
</span></span><span class="line"><span class="ln">35</span><span class="cl">  /var/www/**                   r,
</span></span><span class="line"><span class="ln">36</span><span class="cl">
</span></span><span class="line"><span class="ln">37</span><span class="cl">  # ! Runtime Stats - PIDs ! #
</span></span><span class="line"><span class="ln">38</span><span class="cl">  /run/nginx.pid                rw,
</span></span><span class="line"><span class="ln">39</span><span class="cl">  /run/nginx/**                 rw,
</span></span><span class="line"><span class="ln">40</span><span class="cl">  /var/lib/nginx/               rw,
</span></span><span class="line"><span class="ln">41</span><span class="cl">  /var/lib/nginx/**             rwk,
</span></span><span class="line"><span class="ln">42</span><span class="cl">  /var/cache/nginx/             rw,
</span></span><span class="line"><span class="ln">43</span><span class="cl">  /var/cache/nginx/**           rwk,
</span></span><span class="line"><span class="ln">44</span><span class="cl">
</span></span><span class="line"><span class="ln">45</span><span class="cl">  # ! Logging ! #
</span></span><span class="line"><span class="ln">46</span><span class="cl">  /var/log/nginx/               rw,
</span></span><span class="line"><span class="ln">47</span><span class="cl">  /var/log/nginx/**             rwk,
</span></span><span class="line"><span class="ln">48</span><span class="cl">
</span></span><span class="line"><span class="ln">49</span><span class="cl">  # ! Denies External/Helper Binaries ! #
</span></span><span class="line"><span class="ln">50</span><span class="cl">  deny /bin/**                  mrwklx,
</span></span><span class="line"><span class="ln">51</span><span class="cl">  deny /usr/bin/**              mrwklx,
</span></span><span class="line"><span class="ln">52</span><span class="cl">}</span></span></code></pre></div><p>The profile above should be more than adequate, but it&rsquo;s best to double-check the permissions and tweak if needed.</p>
<small><i><b>Note: I spun this up from a prior config, and tweaked it for compatibility/accessibility concerns.</b></i></small>






<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-sh" data-lang="sh"><span class="line"><span class="ln">1</span><span class="cl"><span class="c1">### Parsing the Profile ###</span>
</span></span><span class="line"><span class="ln">2</span><span class="cl">sudo apparmor_parser -r /etc/apparmor.d/usr.sbin.nginx
</span></span><span class="line"><span class="ln">3</span><span class="cl">
</span></span><span class="line"><span class="ln">4</span><span class="cl"><span class="c1">### Enforcing the Profile ###</span>
</span></span><span class="line"><span class="ln">5</span><span class="cl">sudo aa-enforce /etc/apparmor.d/usr.sbin.nginx
</span></span><span class="line"><span class="ln">6</span><span class="cl">
</span></span><span class="line"><span class="ln">7</span><span class="cl"><span class="c1">### Sanity Check ###</span>
</span></span><span class="line"><span class="ln">8</span><span class="cl">sudo aa-status
</span></span><span class="line"><span class="ln">9</span><span class="cl">sudo systemctl restart nginx</span></span></code></pre></div><h2 id="outcomes">Outcomes</h2>
<p>You can verify your security standpoint by utilizing a third-party tool such as <a href="https://developer.mozilla.org/en-US/observatory/analyze?host=masontuckett.xyz">Mozilla&rsquo;s HTTP Observatory</a>.</p>
<small><i><b>My relevant curl results:</b></i></small>






<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-sh" data-lang="sh"><span class="line"><span class="ln"> 1</span><span class="cl"><span class="c1">### SNI Check ###</span>
</span></span><span class="line"><span class="ln"> 2</span><span class="cl">me@masontuckett:~$ curl -vik https://gnu.org --resolve gnu.org:443:144.202.101.190
</span></span><span class="line"><span class="ln"> 3</span><span class="cl">* Added gnu.org:443:144.202.101.190 to DNS cache
</span></span><span class="line"><span class="ln"> 4</span><span class="cl">* Hostname gnu.org was found in DNS cache
</span></span><span class="line"><span class="ln"> 5</span><span class="cl">*   Trying 144.202.101.190:443...
</span></span><span class="line"><span class="ln"> 6</span><span class="cl">* ALPN: curl offers h2,http/1.1
</span></span><span class="line"><span class="ln"> 7</span><span class="cl">* TLSv1.3 <span class="o">(</span>OUT<span class="o">)</span>, TLS handshake, Client hello <span class="o">(</span>1<span class="o">)</span>:
</span></span><span class="line"><span class="ln"> 8</span><span class="cl">* TLSv1.3 <span class="o">(</span>IN<span class="o">)</span>, TLS alert, unrecognized name <span class="o">(</span>624<span class="o">)</span>:
</span></span><span class="line"><span class="ln"> 9</span><span class="cl">* TLS connect error: error:0A000458:SSL routines::tlsv1 unrecognized name
</span></span><span class="line"><span class="ln">10</span><span class="cl">* closing connection <span class="c1">#0</span>
</span></span><span class="line"><span class="ln">11</span><span class="cl">curl: <span class="o">(</span>35<span class="o">)</span> TLS connect error: error:0A000458:SSL routines::tlsv1 unrecognized name
</span></span><span class="line"><span class="ln">12</span><span class="cl">
</span></span><span class="line"><span class="ln">13</span><span class="cl"><span class="c1">### Rate-Limiting Check ###</span>
</span></span><span class="line"><span class="ln">14</span><span class="cl">me@pc:~$ bash -c <span class="s1">&#39;for i in {1..21}; do curl -s -o /dev/null -w &#34;%{http_code}\n&#34; https://masontuckett.xyz &amp; done; wait&#39;</span> <span class="p">|</span> grep -E <span class="s2">&#34;200|429&#34;</span> <span class="p">|</span> sort <span class="p">|</span> uniq -c
</span></span><span class="line"><span class="ln">15</span><span class="cl">     <span class="m">11</span> <span class="m">200</span>
</span></span><span class="line"><span class="ln">16</span><span class="cl">     <span class="m">10</span> <span class="m">429</span></span></span></code></pre></div><h2 id="closing">Closing</h2>
<p>I have finally finished this article after a few weeks of complete dormancy—<em>as I am not (typically) the kind of person to lazily publish drafts</em>.</p>
<p>My leisure has become increasingly limited, but I do intend on trimming my own CSP/headers, as there is a lot of residual redundancy.</p>
<p><small><i><b>I DO wish this article was a bit more comprehensive.</b></i></small>

<br>
<small><i><b>I'll likely revisit web hardening—adequately securing more typical, dynamic sites.</b></i></small>
</p>
<p>It doesn&rsquo;t impact my security whatsoever—<em>though I vehemently despise the bloat.</em></p>
<p>I am nearly complete with my migration to rootless Podman—so expect a detailed follow-up with deployable configs soon.</p>
<small><i><b>Note: Fail2Ban integration will be covered in a later systems hardening article.</b></i></small>

<p><strong>Next Up:</strong> <a href="/posts/podman/">Rootless Podman</a>.</p>
<small><i><b>You'll see my hatred of Docker/Portainer/Tailscale and JS-laden TrashNAS on full display, haha!</b></i></small>

]]></content:encoded>
    </item>
    <item>
      <title>Career Update</title>
      <link>https://masontuckett.xyz/posts/career-update/</link>
      <pubDate>Fri, 24 Oct 2025 00:38:44 -0700</pubDate><author>mason@tuckett.xyz (Mason Tuckett)</author>
      <guid>https://masontuckett.xyz/posts/career-update/</guid>
      <description>&lt;p&gt;A Personal Update on My Transition to Education&lt;/p&gt;&#xA;&lt;h2 id=&#34;a-need-for-clarification&#34;&gt;A Need for Clarification&lt;/h2&gt;&#xA;&lt;p&gt;In my personal life, I have received a lot of confusion and outright bewilderment as to why I am choosing to &lt;em&gt;temporarily&lt;/em&gt; transition into secondary education.&lt;/p&gt;&#xA;&lt;p&gt;As I am relatively public, and this website serves as a sort of refined &lt;em&gt;&lt;strong&gt;proof of character&lt;/strong&gt;&lt;/em&gt;—I wanted to dispel the misconceptions and vast mischaracterizations levied against my trajectory.&lt;/p&gt;&#xA;&lt;h2 id=&#34;why&#34;&gt;&amp;ldquo;WHY!?&amp;rdquo;&lt;/h2&gt;&#xA;&lt;p&gt;To outsiders, it appears as if I am throwing away a fledgling, long-term career in cybersecurity; &lt;strong&gt;that is objectively the furthest thing from the truth.&lt;/strong&gt;&lt;/p&gt;</description>
      <content:encoded><![CDATA[<p>A Personal Update on My Transition to Education</p>
<h2 id="a-need-for-clarification">A Need for Clarification</h2>
<p>In my personal life, I have received a lot of confusion and outright bewilderment as to why I am choosing to <em>temporarily</em> transition into secondary education.</p>
<p>As I am relatively public, and this website serves as a sort of refined <em><strong>proof of character</strong></em>—I wanted to dispel the misconceptions and vast mischaracterizations levied against my trajectory.</p>
<h2 id="why">&ldquo;WHY!?&rdquo;</h2>
<p>To outsiders, it appears as if I am throwing away a fledgling, long-term career in cybersecurity; <strong>that is objectively the furthest thing from the truth.</strong></p>
<p>I had tried for years to enter the cybersecurity market during my time at Weber State University—<strong><em>all to no avail</em></strong>.</p>
<p>Suddenly, my efforts started to rapidly catch up to me, and everything changed once I concluded undergrad.</p>
<p>A slew of job offers, significant recruiter outreach, and several tenured professionals offering referrals—<strong><em>all at once</em></strong>.</p>
<p><strong><em>What changed?</em></strong></p>
<small><i><b>Absolutely nothing—merely a piece of paper adorning my wall.</b></i></small>

<p>Consequently, this left me in a state of immense disarray, absolutely appalled—culminating in an arduous, nearly two-month-long period of intense introspection.</p>
<h2 id="what-i-realized">What I Realized</h2>
<p>I intrinsically, fundamentally disagree with cybersecurity&rsquo;s current state of rampant credentialism, egoism, nepotism, and overt gatekeeping.</p>
<p>As a person of such impressive credentials (<em><strong>given my age</strong></em>), I never found myself claiming <em>SME-level expertise</em>.</p>
<small><i><b>Why must this be such a pervasive issue?</b></i></small>

<p><strong>I had witnessed this firsthand:</strong> plagiarized presentations, falsified credentials, glorifying aims to work for highly unethical corporations, and extreme embellishment to the point of outright deceit.</p>
<small><i><b>But it never really "clicked" until just recently.</b></i></small>

<p><em>I was faced with an existential, spiritual rot—of which I want no part of.</em></p>
<h2 id="my-journey">My Journey</h2>
<p>I am not some <em>&ldquo;prodigy&rdquo;</em> or <em>&ldquo;gifted individual&rdquo;—I am a man who had to earn and fight <strong>tooth and nail</strong> for everything I have ever achieved.</em></p>
<p>I entered college with zero plans or in-depth understanding of technology; <em>I was quite infantile, toying with computers as a hobby.</em></p>
<p><strong>The only reason I even pursued higher education was because I was given a life-defining ultimatum:</strong></p>
<ul>
<li>The Air Force</li>
<li>Vocational School</li>
<li>Homelessness</li>
</ul>
<p>I was nearly a <a href="https://web.archive.org/web/20251026111432/https://prezi.com/p/pdoo8ktodsxb/booth-and-hamlet-justifications/">high school drop-out</a> at age sixteen—migrating to online education—<em>in hopes of recovering what little I had left.</em></p>
<p>Even at that moment, I still chose not to do critical homework, contingent upon my graduation, for nearly two years—<em>up until age eighteen.</em></p>
<small><i><b>Abysmal ACT scores and a nonexistent GPA.</b></i></small>

<p>So you may understand just how discouraged I was—<em>having to construct everything from scratch</em>—<strong><em>by hand</em></strong>.</p>
<small><i><b>Without the educational scaffolding or innocence many children hold during childhood.</b></i></small>

<p>In the years to come, as I received a highly sudden yet continuous flow of praise—<em>I was left stewing, questioning:</em></p>
<p><strong>What Now?</strong></p>
<h2 id="service-as-a-career">Service as a Career</h2>
<p>I harkened back to my time as an instructor at Ken Garff&rsquo;s summer tech track—and the countless hours I spent debugging with <a href="https://smithbarlow.net">Smith</a>.</p>
<small><i><b>I realized in that moment that my life should be for and in the service of others.</b></i></small>

<p>I declined lucrative offers, and opportunities, and referrals, and set my sights on pursuing teaching licensure—with an excruciating fervor.</p>
<small><i><b>A sharp juxtaposition to my idea of education as a cheap contingency option.</b></i></small>

<p>To build myself from the ground up, I took a TA position at a local elementary school—<em>with <strong>zero</strong> understanding of what I&rsquo;d be doing.</em></p>
<p>Entering the role was among the most difficult adjustments I had made in my career.</p>
<p><strong>Far surpassing any academic work or position I have ever held.</strong></p>
<p>It has been the most rewarding experience of my life—<em>providing a level of happiness I have never known.</em></p>
<h2 id="the-future">The Future</h2>
<p>While I am focusing on adjunct roles at technical colleges in the near future, secondary education gives me an incredible platform.</p>
<p>I am uniquely positioned—attaining invaluable experience while having plenty of time for PhD coursework.</p>
<p>Additionally, I will absolutely continue my contracted network engineering projects—<em>compounding into my aim to do technical consulting.</em></p>
<small><i><b>I am not "ditching" my technical background, but strategically adapting to preemptively advance beyond my years.</b></i></small>

<p>Professorship is my end goal—<em>building a profile for mentoring <strong>lost men in a sea of disillusionment and demoralization</strong></em>.</p>
<p>Hence my desire to become involved with the youth—<em>hopefully, in due time,</em> <em><strong>piloting initiatives to ensure children receive the scaffolding I never had</strong></em>.</p>
<h2 id="the-present-game-plan">The Present (Game Plan)</h2>
<ul>
<li><em>Continue volunteer work.</em></li>
<li><em>Continue mentoring Smith.</em></li>
<li><em>Finish my catalog of technical articles.</em></li>
<li><em>Earn <a href="https://github.com/masontuckett/pcap-prep">PCAP</a>/<a href="https://github.com/masontuckett/cpe-prep">CPE</a> certs so I may better teach students.</em></li>
<li><em>Earn CCNA/RHCSA for adjunct roles.</em></li>
</ul>
<small><i><b>Mammon will never halt my relentless pursuit of the windmill; I will never be an errand boy.</b></i></small>

]]></content:encoded>
    </item>
    <item>
      <title>Web Hosting</title>
      <link>https://masontuckett.xyz/posts/web-hosting/</link>
      <pubDate>Thu, 04 Sep 2025 00:38:44 -0700</pubDate><author>mason@tuckett.xyz (Mason Tuckett)</author>
      <guid>https://masontuckett.xyz/posts/web-hosting/</guid>
      <description>&lt;p&gt;A Brief Overview of Hosting Web Pages&lt;/p&gt;&#xA;&lt;h2 id=&#34;what-is-a-web-server&#34;&gt;What is a Web Server?&lt;/h2&gt;&#xA;&lt;p&gt;&lt;img src=&#34;https://masontuckett.xyz/images/posts/web-hosting/web-server.webp&#34; alt=&#34;Web Server Diagram&#34;&gt;&lt;/p&gt;&#xA;&lt;p&gt;A web server is specialized software responsible for delivering web content to users over HTTP/HTTPS.&lt;/p&gt;&#xA;&lt;p&gt;This can include static resources such as HTML/CSS/JS files—as well as images (JPG/PNG/WEBP) or archives (ZIP).&lt;/p&gt;&#xA;&lt;h3 id=&#34;static-sites&#34;&gt;Static Sites&lt;/h3&gt;&#xA;&lt;p&gt;&lt;img src=&#34;https://masontuckett.xyz/images/posts/web-hosting/web-examples.webp&#34; alt=&#34;Web Page Example&#34;&gt;&lt;/p&gt;&#xA;&lt;p&gt;At its simplest level, a web server serves static resources to users—rendering a fully functional web page or a browsable file directory; static sites are &lt;em&gt;static only&lt;/em&gt;, serving &lt;strong&gt;ONLY&lt;/strong&gt; static resources.&lt;/p&gt;</description>
      <content:encoded><![CDATA[<p>A Brief Overview of Hosting Web Pages</p>
<h2 id="what-is-a-web-server">What is a Web Server?</h2>
<p><img src="/images/posts/web-hosting/web-server.webp" alt="Web Server Diagram"></p>
<p>A web server is specialized software responsible for delivering web content to users over HTTP/HTTPS.</p>
<p>This can include static resources such as HTML/CSS/JS files—as well as images (JPG/PNG/WEBP) or archives (ZIP).</p>
<h3 id="static-sites">Static Sites</h3>
<p><img src="/images/posts/web-hosting/web-examples.webp" alt="Web Page Example"></p>
<p>At its simplest level, a web server serves static resources to users—rendering a fully functional web page or a browsable file directory; static sites are <em>static only</em>, serving <strong>ONLY</strong> static resources.</p>
<p>However, administrative needs are often far more complex—requiring dynamic sites that are commonly powered by application frameworks or achieved with content management systems (CMS).</p>
<h3 id="dynamic-sites">Dynamic Sites</h3>
<p>Dynamic sites differ from static sites in that content is generated <em>dynamically</em> instead of serving precompiled resources.</p>
<p>When a user requests a page, the client sends a request in the form of <a href="https://developer.mozilla.org/en-US/docs/Web/HTTP/Reference/Methods">HTTP request methods</a> to the web server—given to an application framework or CMS (often querying a database/app).</p>
<p>Thereafter, the web server responds with a finalized HTML response in real time—hence the <em>dynamic</em> nature of the site.</p>
<small><i><b> Some common CMS platforms include: WordPress and Drupal; common application frameworks include: Node.js, Django, Ruby on Rails.</b></i></small>

<h2 id="what-is-a-reverse-proxy">What is a Reverse Proxy?</h2>
<p><img src="/images/posts/web-hosting/reverse-proxy.webp" alt="Reverse Proxy Diagram"></p>
<p>Often bundled with web server software, a reverse proxy is an intermediary server that sits between clients and one or more back-end servers (e.g., dynamic services), forwarding requests directly to the web or application servers.</p>
<p>Reverse proxies are especially useful when hosting <em>dynamic</em> sites that rely on application frameworks or CMS platforms.</p>
<p>These setups are often a combination of multiple components—such as databases, application servers, and caching layers (interlaced with <a href="https://www.cloudflare.com/learning/cdn/what-is-a-cdn/">CDNs</a>).</p>
<p>As workloads are quite resource-intensive and more complex than traditional static sites, administrators also get the benefits of:</p>
<ul>
<li><strong>Load Balancing</strong>: <em>Distributing traffic across multiple servers</em>.</li>
<li><strong>Caching</strong>: <em>Frequently accessed content may be cached, reducing strain on back-end resources</em>.</li>
<li><strong>Security</strong>: <em>Obscures internal servers—hiding the identity of origin servers (if properly configured)</em>.</li>
<li><strong>TLS/SSL</strong>: <em>Simplifies the management of TLS/SSL certificates, as they can be handled at the proxy level</em>.</li>
</ul>
<small><i><b>Multiple reverse proxies can be chained together—for redundancy or specialized services/roles.</b></i></small>

<h2 id="configuring-a-reverse-proxy">Configuring a Reverse Proxy</h2>
<p>For this demonstration I will be deploying Nginx on a Debian (Trixie) VPS; this won&rsquo;t differ significantly when compared to Ubuntu or RHEL derivatives.</p>
<p>There are various reverse proxies that <em>may</em> be utilized, but <a href="https://www.cvedetails.com/vendor/10048/Nginx.html">Nginx</a> is far more reliable (not to mention, lighter under high concurrency) than <a href="https://www.cvedetails.com/vendor/45/Apache.html">Apache</a>; <a href="https://traefik.io/">Traefik</a> and <a href="https://caddyserver.com/">Caddy</a> are also phenomenal options.</p>
<h3 id="important-prerequisites">Important Prerequisites</h3>
<p>I&rsquo;d recommend finding a hosting provider that gives you full access to your machine/instance; for full digital sovereignty, avoid AWS/Cloudflare.</p>
<p>Ideally, it&rsquo;s best to point an A/AAAA record to your instance (if you have purchased a domain).</p>
<h3 id="creating-a-new-user">Creating a New User</h3>
<p>It is not advisable to use a root user for managing your host; create a new user instead.</p>





<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-sh" data-lang="sh"><span class="line"><span class="ln">1</span><span class="cl"><span class="c1">### Create a New User (Root) ###</span>
</span></span><span class="line"><span class="ln">2</span><span class="cl">useradd -m -s /bin/bash user
</span></span><span class="line"><span class="ln">3</span><span class="cl">usermod -aG sudo user
</span></span><span class="line"><span class="ln">4</span><span class="cl">
</span></span><span class="line"><span class="ln">5</span><span class="cl"><span class="c1"># ! Set a Password ! #</span>
</span></span><span class="line"><span class="ln">6</span><span class="cl">passwd user</span></span></code></pre></div><h3 id="generating-an-ssh-key">Generating an SSH Key</h3>
<p>It is best to avoid RSA, as it is an <strong>outdated</strong> cryptographic standard compared to the much newer and robust ED25519 algorithm <em>(yes, even with the -b arg)</em>.</p>
<small><i><b>RSA 4096 (integer factorization) is still mathematically stronger than ED25519, but RSA generally has lower security per bit than ED25519's ECC algorithm.</b></i></small>






<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-sh" data-lang="sh"><span class="line"><span class="ln"> 1</span><span class="cl"><span class="c1">### Generate a Secure ED25519 Key (Client) ###</span>
</span></span><span class="line"><span class="ln"> 2</span><span class="cl"><span class="c1"># ! USE 100 KDF ROUNDS ! #</span>
</span></span><span class="line"><span class="ln"> 3</span><span class="cl">ssh-keygen -t ed25519 -a <span class="m">100</span> -o -f ~/.ssh/sshkey
</span></span><span class="line"><span class="ln"> 4</span><span class="cl">
</span></span><span class="line"><span class="ln"> 5</span><span class="cl"><span class="c1"># ! ENTER A STRONG PASSPHRASE ! #</span>
</span></span><span class="line"><span class="ln"> 6</span><span class="cl">Generating public/private ed25519 key pair.
</span></span><span class="line"><span class="ln"> 7</span><span class="cl">Enter passphrase <span class="o">(</span>empty <span class="k">for</span> no passphrase<span class="o">)</span>: 
</span></span><span class="line"><span class="ln"> 8</span><span class="cl">Enter same passphrase again: 
</span></span><span class="line"><span class="ln"> 9</span><span class="cl">
</span></span><span class="line"><span class="ln">10</span><span class="cl"><span class="c1"># ! Output Should Be Similar ! #</span>
</span></span><span class="line"><span class="ln">11</span><span class="cl">Your identification has been saved in /home/user/.ssh/sshkey
</span></span><span class="line"><span class="ln">12</span><span class="cl">Your public key has been saved in /home/user/.ssh/sshkey.pub
</span></span><span class="line"><span class="ln">13</span><span class="cl">The key fingerprint is:
</span></span><span class="line"><span class="ln">14</span><span class="cl">SHA256:tCzBHeMoatZ5jR3pvKaGdRs83AHARTYEk3j5Ln8VccE user@9020MT
</span></span><span class="line"><span class="ln">15</span><span class="cl">The key<span class="err">&#39;</span>s randomart image is:
</span></span><span class="line"><span class="ln">16</span><span class="cl">+--<span class="o">[</span>ED25519 256<span class="o">]</span>--+
</span></span><span class="line"><span class="ln">17</span><span class="cl"><span class="p">|</span>     o+OO    ... <span class="p">|</span>
</span></span><span class="line"><span class="ln">18</span><span class="cl"><span class="p">|</span>    ..<span class="o">=</span>*.<span class="o">=</span>  . E  <span class="p">|</span>
</span></span><span class="line"><span class="ln">19</span><span class="cl"><span class="p">|</span>    ..+.*.   o   <span class="p">|</span>
</span></span><span class="line"><span class="ln">20</span><span class="cl"><span class="p">|</span>   o o X.o. .    <span class="p">|</span>
</span></span><span class="line"><span class="ln">21</span><span class="cl"><span class="p">|</span>  + o ++S. . .   <span class="p">|</span>
</span></span><span class="line"><span class="ln">22</span><span class="cl"><span class="p">|</span> o   .o.B.. .    <span class="p">|</span>
</span></span><span class="line"><span class="ln">23</span><span class="cl"><span class="p">|</span>     o +o+ .     <span class="p">|</span>
</span></span><span class="line"><span class="ln">24</span><span class="cl"><span class="p">|</span>    . .oo .      <span class="p">|</span>
</span></span><span class="line"><span class="ln">25</span><span class="cl"><span class="p">|</span>     ..  .       <span class="p">|</span>
</span></span><span class="line"><span class="ln">26</span><span class="cl">+----<span class="o">[</span>SHA256<span class="o">]</span>-----+
</span></span><span class="line"><span class="ln">27</span><span class="cl">
</span></span><span class="line"><span class="ln">28</span><span class="cl"><span class="c1">### Deploy the Key (From Client) ###</span>
</span></span><span class="line"><span class="ln">29</span><span class="cl">scp ~/.ssh/sshkey.pub root@host:/home/user/
</span></span><span class="line"><span class="ln">30</span><span class="cl">
</span></span><span class="line"><span class="ln">31</span><span class="cl"><span class="c1"># ! Install the Key (On Host) ! #</span>
</span></span><span class="line"><span class="ln">32</span><span class="cl">mkdir -p /home/user/.ssh
</span></span><span class="line"><span class="ln">33</span><span class="cl">install -m <span class="m">600</span> /dev/null /home/user/.ssh/authorized_keys
</span></span><span class="line"><span class="ln">34</span><span class="cl">cat /home/user/sshkey.pub &gt;&gt; /home/user/.ssh/authorized_keys
</span></span><span class="line"><span class="ln">35</span><span class="cl">
</span></span><span class="line"><span class="ln">36</span><span class="cl"><span class="c1"># ! Manage Permissions (On Host) ! #</span>
</span></span><span class="line"><span class="ln">37</span><span class="cl">chmod <span class="m">700</span> /home/user/.ssh
</span></span><span class="line"><span class="ln">38</span><span class="cl">chmod <span class="m">600</span> /home/user/.ssh/authorized_keys
</span></span><span class="line"><span class="ln">39</span><span class="cl">chown -R user /home/user
</span></span><span class="line"><span class="ln">40</span><span class="cl">
</span></span><span class="line"><span class="ln">41</span><span class="cl"><span class="c1"># ! Remove Key (Host) ! #</span>
</span></span><span class="line"><span class="ln">42</span><span class="cl">rm /home/user/sshkey.pub</span></span></code></pre></div><h3 id="firewall-configuration">Firewall Configuration</h3>
<p>Before we configure SSH (on the host), we need to manage our firewall first.</p>
<p>UFW is commonly bundled with stock Debian/Ubuntu server images, and while it is still more than enough—iptables is <em>far more</em> granular.</p>





<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-sh" data-lang="sh"><span class="line"><span class="ln"> 1</span><span class="cl"><span class="c1">### UFW (Root) ###</span>
</span></span><span class="line"><span class="ln"> 2</span><span class="cl">ufw allow http
</span></span><span class="line"><span class="ln"> 3</span><span class="cl">ufw allow https
</span></span><span class="line"><span class="ln"> 4</span><span class="cl">ufw allow 5555/tcp
</span></span><span class="line"><span class="ln"> 5</span><span class="cl">ufw default deny incoming
</span></span><span class="line"><span class="ln"> 6</span><span class="cl">ufw default allow outgoing
</span></span><span class="line"><span class="ln"> 7</span><span class="cl">ufw status verbose
</span></span><span class="line"><span class="ln"> 8</span><span class="cl">
</span></span><span class="line"><span class="ln"> 9</span><span class="cl">ufw <span class="nb">enable</span>
</span></span><span class="line"><span class="ln">10</span><span class="cl">systemctl <span class="nb">enable</span> --now ufw
</span></span><span class="line"><span class="ln">11</span><span class="cl">
</span></span><span class="line"><span class="ln">12</span><span class="cl"><span class="c1"># ! OR ! #</span>
</span></span><span class="line"><span class="ln">13</span><span class="cl">
</span></span><span class="line"><span class="ln">14</span><span class="cl"><span class="c1">### Iptables ###</span>
</span></span><span class="line"><span class="ln">15</span><span class="cl"><span class="c1"># ! Flush Rules ! #</span>
</span></span><span class="line"><span class="ln">16</span><span class="cl">iptables -F
</span></span><span class="line"><span class="ln">17</span><span class="cl">
</span></span><span class="line"><span class="ln">18</span><span class="cl"><span class="c1"># ! UFW Equivalent ! #</span>
</span></span><span class="line"><span class="ln">19</span><span class="cl">iptables -P INPUT DROP
</span></span><span class="line"><span class="ln">20</span><span class="cl">iptables -P FORWARD DROP
</span></span><span class="line"><span class="ln">21</span><span class="cl">iptables -P OUTPUT ACCEPT
</span></span><span class="line"><span class="ln">22</span><span class="cl">
</span></span><span class="line"><span class="ln">23</span><span class="cl"><span class="c1"># ! Allow Loopback ! #</span>
</span></span><span class="line"><span class="ln">24</span><span class="cl">iptables -A INPUT -i lo -j ACCEPT
</span></span><span class="line"><span class="ln">25</span><span class="cl">
</span></span><span class="line"><span class="ln">26</span><span class="cl"><span class="c1"># ! Allow Established ! #</span>
</span></span><span class="line"><span class="ln">27</span><span class="cl">iptables -A INPUT -m conntrack --ctstate ESTABLISHED,RELATED -j ACCEPT
</span></span><span class="line"><span class="ln">28</span><span class="cl">
</span></span><span class="line"><span class="ln">29</span><span class="cl"><span class="c1"># ! Allow SSH (Non-standard Port) ! #</span>
</span></span><span class="line"><span class="ln">30</span><span class="cl">iptables -A INPUT -p tcp --dport <span class="m">5555</span> -j ACCEPT
</span></span><span class="line"><span class="ln">31</span><span class="cl">
</span></span><span class="line"><span class="ln">32</span><span class="cl"><span class="c1"># ! Allow HTTP ! #</span>
</span></span><span class="line"><span class="ln">33</span><span class="cl">iptables -A INPUT -p tcp --dport <span class="m">80</span> -j ACCEPT
</span></span><span class="line"><span class="ln">34</span><span class="cl">
</span></span><span class="line"><span class="ln">35</span><span class="cl"><span class="c1"># ! Allow HTTPS ! #</span>
</span></span><span class="line"><span class="ln">36</span><span class="cl">iptables -A INPUT -p tcp --dport <span class="m">443</span> -j ACCEPT
</span></span><span class="line"><span class="ln">37</span><span class="cl">
</span></span><span class="line"><span class="ln">38</span><span class="cl"><span class="c1"># ! Allow ICMP (Caution) ! #</span>
</span></span><span class="line"><span class="ln">39</span><span class="cl">iptables -A INPUT -p icmp -j ACCEPT
</span></span><span class="line"><span class="ln">40</span><span class="cl">
</span></span><span class="line"><span class="ln">41</span><span class="cl"><span class="c1"># ! Persistence ! #</span>
</span></span><span class="line"><span class="ln">42</span><span class="cl">apt update<span class="p">;</span> apt install -y netfilter-persistent iptables-persistent
</span></span><span class="line"><span class="ln">43</span><span class="cl">netfilter-persistent save</span></span></code></pre></div><h3 id="basic-ssh-security">Basic SSH Security</h3>
<p>Now that we&rsquo;ve put everything else into place, it is time to secure SSH.</p>
<p>As you are hosting this publicly—it is best to have at <em>least</em> a secure baseline for SSH access.</p>
<p>This doesn&rsquo;t have to be too complex, but a non-standard port and public key authentication should suit this just fine.</p>
<small><i><b>Take important notice of these configurations.</b></i></small>






<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-sh" data-lang="sh"><span class="line"><span class="ln"> 1</span><span class="cl"><span class="c1">### /etc/ssh/sshd_config (Root) ###</span>
</span></span><span class="line"><span class="ln"> 2</span><span class="cl"><span class="c1"># ! Set a Non-standard Port ! #</span>
</span></span><span class="line"><span class="ln"> 3</span><span class="cl">Port <span class="m">5555</span>
</span></span><span class="line"><span class="ln"> 4</span><span class="cl">
</span></span><span class="line"><span class="ln"> 5</span><span class="cl"><span class="c1"># ! Disable Root Login ! #</span>
</span></span><span class="line"><span class="ln"> 6</span><span class="cl">PermitRootLogin no
</span></span><span class="line"><span class="ln"> 7</span><span class="cl">
</span></span><span class="line"><span class="ln"> 8</span><span class="cl"><span class="c1"># ! Enable Public Key Authentication ! #</span>
</span></span><span class="line"><span class="ln"> 9</span><span class="cl">PubkeyAuthentication yes
</span></span><span class="line"><span class="ln">10</span><span class="cl">
</span></span><span class="line"><span class="ln">11</span><span class="cl"><span class="c1"># ! Disable Password Authentication ! #</span>
</span></span><span class="line"><span class="ln">12</span><span class="cl">PasswordAuthentication no
</span></span><span class="line"><span class="ln">13</span><span class="cl">PermitEmptyPasswords no
</span></span><span class="line"><span class="ln">14</span><span class="cl">
</span></span><span class="line"><span class="ln">15</span><span class="cl"><span class="c1"># ! Enable Strict Mode ! #</span>
</span></span><span class="line"><span class="ln">16</span><span class="cl">StrictModes yes
</span></span><span class="line"><span class="ln">17</span><span class="cl">
</span></span><span class="line"><span class="ln">18</span><span class="cl"><span class="c1"># ! Permit User ! #</span>
</span></span><span class="line"><span class="ln">19</span><span class="cl">AllowUsers user
</span></span><span class="line"><span class="ln">20</span><span class="cl">
</span></span><span class="line"><span class="ln">21</span><span class="cl"><span class="c1"># ! Fallback Prevention ! #</span>
</span></span><span class="line"><span class="ln">22</span><span class="cl">ChallengeResponseAuthentication no
</span></span><span class="line"><span class="ln">23</span><span class="cl">
</span></span><span class="line"><span class="ln">24</span><span class="cl"><span class="c1"># ! Disable Forwarding (We Are Not a Router) ! #</span>
</span></span><span class="line"><span class="ln">25</span><span class="cl">AllowTcpForwarding no
</span></span><span class="line"><span class="ln">26</span><span class="cl">GatewayPorts no
</span></span><span class="line"><span class="ln">27</span><span class="cl">
</span></span><span class="line"><span class="ln">28</span><span class="cl"><span class="c1"># ! Prevent Zombie Sessions ! #</span>
</span></span><span class="line"><span class="ln">29</span><span class="cl">ClientAliveInterval <span class="m">300</span>
</span></span><span class="line"><span class="ln">30</span><span class="cl">ClientAliveCountMax <span class="m">2</span>
</span></span><span class="line"><span class="ln">31</span><span class="cl">
</span></span><span class="line"><span class="ln">32</span><span class="cl"><span class="c1"># ! Prevent Session Abuse ! #</span>
</span></span><span class="line"><span class="ln">33</span><span class="cl">MaxSessions <span class="m">1</span>
</span></span><span class="line"><span class="ln">34</span><span class="cl">
</span></span><span class="line"><span class="ln">35</span><span class="cl"><span class="c1"># ! Brute Force Prevention ! #</span>
</span></span><span class="line"><span class="ln">36</span><span class="cl">MaxAuthTries <span class="m">3</span>
</span></span><span class="line"><span class="ln">37</span><span class="cl">LoginGraceTime <span class="m">30</span>
</span></span><span class="line"><span class="ln">38</span><span class="cl">MaxStartups 3:10:30
</span></span><span class="line"><span class="ln">39</span><span class="cl">
</span></span><span class="line"><span class="ln">40</span><span class="cl"><span class="c1"># ! Prevent Agent Abuse ! #</span>
</span></span><span class="line"><span class="ln">41</span><span class="cl">AllowAgentForwarding no
</span></span><span class="line"><span class="ln">42</span><span class="cl">
</span></span><span class="line"><span class="ln">43</span><span class="cl"><span class="c1"># ! Restrict Keys ! #</span>
</span></span><span class="line"><span class="ln">44</span><span class="cl">HostKeyAlgorithms ssh-ed25519
</span></span><span class="line"><span class="ln">45</span><span class="cl">PubkeyAcceptedKeyTypes ssh-ed25519
</span></span><span class="line"><span class="ln">46</span><span class="cl">
</span></span><span class="line"><span class="ln">47</span><span class="cl"><span class="c1"># ! Useful Additions ! #</span>
</span></span><span class="line"><span class="ln">48</span><span class="cl">Compression no
</span></span><span class="line"><span class="ln">49</span><span class="cl">PermitUserEnvironment no
</span></span><span class="line"><span class="ln">50</span><span class="cl">
</span></span><span class="line"><span class="ln">51</span><span class="cl"><span class="c1"># ! Test Changes (No Output is Good) ! #</span>
</span></span><span class="line"><span class="ln">52</span><span class="cl">sshd -t
</span></span><span class="line"><span class="ln">53</span><span class="cl">
</span></span><span class="line"><span class="ln">54</span><span class="cl"><span class="c1"># ! Restart the Service ! #</span>
</span></span><span class="line"><span class="ln">55</span><span class="cl">systemctl restart --now ssh
</span></span><span class="line"><span class="ln">56</span><span class="cl">
</span></span><span class="line"><span class="ln">57</span><span class="cl"><span class="c1">### SSH In ###</span>
</span></span><span class="line"><span class="ln">58</span><span class="cl">ssh -i ~/.ssh/sshkey user@host -p <span class="m">5555</span></span></span></code></pre></div><h2 id="deploying-nginx">Deploying Nginx</h2>
<p>After everything else has been completed, we can finally deploy Nginx!</p>
<p>For this demonstration, I will be installing both Nginx and Certbot to make the process as painless as possible (Let&rsquo;s Encrypt); Certbot will automatically renew your TLS/SSL certificate (via Cron).</p>





<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-sh" data-lang="sh"><span class="line"><span class="ln"> 1</span><span class="cl"><span class="c1">### Install Nginx and Certbot (Sudo Now) ###</span>
</span></span><span class="line"><span class="ln"> 2</span><span class="cl">sudo apt update <span class="o">&amp;&amp;</span> sudo apt install -y nginx python3-certbot-nginx
</span></span><span class="line"><span class="ln"> 3</span><span class="cl">sudo systemctl <span class="nb">enable</span> --now nginx
</span></span><span class="line"><span class="ln"> 4</span><span class="cl">
</span></span><span class="line"><span class="ln"> 5</span><span class="cl"><span class="c1">### Create a New Web Directory ###</span>
</span></span><span class="line"><span class="ln"> 6</span><span class="cl">sudo mkdir -p /var/www/webpage
</span></span><span class="line"><span class="ln"> 7</span><span class="cl">
</span></span><span class="line"><span class="ln"> 8</span><span class="cl"><span class="c1">### Obtain a Certificate ###</span>
</span></span><span class="line"><span class="ln"> 9</span><span class="cl">certbot certonly -d tuckett-test.xyz
</span></span><span class="line"><span class="ln">10</span><span class="cl">
</span></span><span class="line"><span class="ln">11</span><span class="cl"><span class="c1"># ! Output Should Be Similar ! #</span>
</span></span><span class="line"><span class="ln">12</span><span class="cl">How would you like to authenticate with the ACME CA?
</span></span><span class="line"><span class="ln">13</span><span class="cl">- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
</span></span><span class="line"><span class="ln">14</span><span class="cl">1: Nginx Web Server plugin <span class="o">(</span>nginx<span class="o">)</span>
</span></span><span class="line"><span class="ln">15</span><span class="cl">2: Runs an HTTP server locally which serves the necessary validation files under
</span></span><span class="line"><span class="ln">16</span><span class="cl">the /.well-known/acme-challenge/ request path. Suitable <span class="k">if</span> there is no HTTP
</span></span><span class="line"><span class="ln">17</span><span class="cl">server already running. HTTP challenge only <span class="o">(</span>wildcards not supported<span class="o">)</span>.
</span></span><span class="line"><span class="ln">18</span><span class="cl"><span class="o">(</span>standalone<span class="o">)</span>
</span></span><span class="line"><span class="ln">19</span><span class="cl">3: Saves the necessary validation files to a .well-known/acme-challenge/
</span></span><span class="line"><span class="ln">20</span><span class="cl">directory within the nominated webroot path. A separate HTTP server must be
</span></span><span class="line"><span class="ln">21</span><span class="cl">running and serving files from the webroot path. HTTP challenge only <span class="o">(</span>wildcards
</span></span><span class="line"><span class="ln">22</span><span class="cl">not supported<span class="o">)</span>. <span class="o">(</span>webroot<span class="o">)</span>
</span></span><span class="line"><span class="ln">23</span><span class="cl">- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
</span></span><span class="line"><span class="ln">24</span><span class="cl"><span class="c1"># ! We Are Using Nginx - Enter 1 ! #</span>
</span></span><span class="line"><span class="ln">25</span><span class="cl">Select the appropriate number <span class="o">[</span>1-3<span class="o">]</span> <span class="k">then</span> <span class="o">[</span>enter<span class="o">]</span> <span class="o">(</span>press <span class="s1">&#39;c&#39;</span> to cancel<span class="o">)</span>: <span class="m">1</span>
</span></span><span class="line"><span class="ln">26</span><span class="cl">Enter email address or hit Enter to skip.
</span></span><span class="line"><span class="ln">27</span><span class="cl"> <span class="o">(</span>Enter <span class="s1">&#39;c&#39;</span> to cancel<span class="o">)</span>: admin@tuckett.xyz
</span></span><span class="line"><span class="ln">28</span><span class="cl">
</span></span><span class="line"><span class="ln">29</span><span class="cl">- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
</span></span><span class="line"><span class="ln">30</span><span class="cl">Please <span class="nb">read</span> the Terms of Service at:
</span></span><span class="line"><span class="ln">31</span><span class="cl">https://letsencrypt.org/documents/LE-SA-v1.5-February-24-2025.pdf
</span></span><span class="line"><span class="ln">32</span><span class="cl">You must agree in order to register with the ACME server. Do you agree?
</span></span><span class="line"><span class="ln">33</span><span class="cl">- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
</span></span><span class="line"><span class="ln">34</span><span class="cl"><span class="c1"># ! Agree to Terms ! #</span>
</span></span><span class="line"><span class="ln">35</span><span class="cl"><span class="o">(</span>Y<span class="o">)</span>es/<span class="o">(</span>N<span class="o">)</span>o: y
</span></span><span class="line"><span class="ln">36</span><span class="cl">
</span></span><span class="line"><span class="ln">37</span><span class="cl">- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
</span></span><span class="line"><span class="ln">38</span><span class="cl">Would you be willing, once your first certificate is successfully issued, to
</span></span><span class="line"><span class="ln">39</span><span class="cl">share your email address with the Electronic Frontier Foundation, a founding
</span></span><span class="line"><span class="ln">40</span><span class="cl">partner of the Let<span class="s1">&#39;s Encrypt project and the non-profit organization that
</span></span></span><span class="line"><span class="ln">41</span><span class="cl"><span class="s1">develops Certbot? We&#39;</span>d like to send you email about our work encrypting the web,
</span></span><span class="line"><span class="ln">42</span><span class="cl">EFF news, campaigns, and ways to support digital freedom.
</span></span><span class="line"><span class="ln">43</span><span class="cl">- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
</span></span><span class="line"><span class="ln">44</span><span class="cl"><span class="c1"># ! Optional ! #</span>
</span></span><span class="line"><span class="ln">45</span><span class="cl"><span class="o">(</span>Y<span class="o">)</span>es/<span class="o">(</span>N<span class="o">)</span>o: n
</span></span><span class="line"><span class="ln">46</span><span class="cl">Account registered.
</span></span><span class="line"><span class="ln">47</span><span class="cl">Requesting a certificate <span class="k">for</span> tuckett-test.xyz
</span></span><span class="line"><span class="ln">48</span><span class="cl">
</span></span><span class="line"><span class="ln">49</span><span class="cl">Successfully received certificate.
</span></span><span class="line"><span class="ln">50</span><span class="cl">Certificate is saved at: /etc/letsencrypt/live/tuckett-test.xyz/fullchain.pem
</span></span><span class="line"><span class="ln">51</span><span class="cl">Key is saved at:         /etc/letsencrypt/live/tuckett-test.xyz/privkey.pem</span></span></code></pre></div><h3 id="configuring-nginx">Configuring Nginx</h3>
<p>Now we&rsquo;ll need to configure Nginx so we may publish our web page.</p>





<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-txt" data-lang="txt"><span class="line"><span class="ln"> 1</span><span class="cl">### /etc/nginx/nginx.conf ###
</span></span><span class="line"><span class="ln"> 2</span><span class="cl">#! Turn Off Server Tokens (Bare Minimum) ! #
</span></span><span class="line"><span class="ln"> 3</span><span class="cl">server_tokens off;
</span></span><span class="line"><span class="ln"> 4</span><span class="cl">
</span></span><span class="line"><span class="ln"> 5</span><span class="cl">### /etc/nginx/sites-available/webpage ###
</span></span><span class="line"><span class="ln"> 6</span><span class="cl"># ! Minimal Config ! #
</span></span><span class="line"><span class="ln"> 7</span><span class="cl">
</span></span><span class="line"><span class="ln"> 8</span><span class="cl"># ! HTTP - Redirects to HTTPS ! #
</span></span><span class="line"><span class="ln"> 9</span><span class="cl">server {
</span></span><span class="line"><span class="ln">10</span><span class="cl">    listen 80;
</span></span><span class="line"><span class="ln">11</span><span class="cl">    listen [::]:80;
</span></span><span class="line"><span class="ln">12</span><span class="cl">    server_name tuckett-test.xyz;
</span></span><span class="line"><span class="ln">13</span><span class="cl">
</span></span><span class="line"><span class="ln">14</span><span class="cl">    return 301 https://tuckett-test.xyz$request_uri;
</span></span><span class="line"><span class="ln">15</span><span class="cl">}
</span></span><span class="line"><span class="ln">16</span><span class="cl">
</span></span><span class="line"><span class="ln">17</span><span class="cl"># ! HTTPS ! #
</span></span><span class="line"><span class="ln">18</span><span class="cl">server {
</span></span><span class="line"><span class="ln">19</span><span class="cl">    listen 443 ssl;
</span></span><span class="line"><span class="ln">20</span><span class="cl">    listen [::]:443 ssl;
</span></span><span class="line"><span class="ln">21</span><span class="cl">    server_name tuckett-test.xyz;
</span></span><span class="line"><span class="ln">22</span><span class="cl">
</span></span><span class="line"><span class="ln">23</span><span class="cl">    # ! Let&#39;s Encrypt Certificate ! #
</span></span><span class="line"><span class="ln">24</span><span class="cl">    ssl_certificate     /etc/letsencrypt/live/tuckett-test.xyz/fullchain.pem;
</span></span><span class="line"><span class="ln">25</span><span class="cl">    ssl_certificate_key /etc/letsencrypt/live/tuckett-test.xyz/privkey.pem;
</span></span><span class="line"><span class="ln">26</span><span class="cl">
</span></span><span class="line"><span class="ln">27</span><span class="cl">    # Recommended TLS params (installed by certbot)
</span></span><span class="line"><span class="ln">28</span><span class="cl">    include /etc/letsencrypt/options-ssl-nginx.conf;
</span></span><span class="line"><span class="ln">29</span><span class="cl">    ssl_dhparam /etc/letsencrypt/ssl-dhparams.pem;
</span></span><span class="line"><span class="ln">30</span><span class="cl">
</span></span><span class="line"><span class="ln">31</span><span class="cl">    # ! Web Root ! #
</span></span><span class="line"><span class="ln">32</span><span class="cl">    root /var/www/webpage;
</span></span><span class="line"><span class="ln">33</span><span class="cl">    index index.html;
</span></span><span class="line"><span class="ln">34</span><span class="cl">
</span></span><span class="line"><span class="ln">35</span><span class="cl">    location / {
</span></span><span class="line"><span class="ln">36</span><span class="cl">        try_files $uri $uri/ =404;
</span></span><span class="line"><span class="ln">37</span><span class="cl">    }
</span></span><span class="line"><span class="ln">38</span><span class="cl">}</span></span></code></pre></div>




<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-sh" data-lang="sh"><span class="line"><span class="ln">1</span><span class="cl"><span class="c1">### Enable Web Page ###</span>
</span></span><span class="line"><span class="ln">2</span><span class="cl"><span class="c1"># ! Test Configs ! #</span>
</span></span><span class="line"><span class="ln">3</span><span class="cl">sudo nginx -t 
</span></span><span class="line"><span class="ln">4</span><span class="cl">
</span></span><span class="line"><span class="ln">5</span><span class="cl"><span class="c1"># ! Avoids Conflicts ! #</span>
</span></span><span class="line"><span class="ln">6</span><span class="cl">sudo rm /etc/nginx/sites-enabled/default
</span></span><span class="line"><span class="ln">7</span><span class="cl">
</span></span><span class="line"><span class="ln">8</span><span class="cl"><span class="c1"># ! Symbolic Link ! #</span>
</span></span><span class="line"><span class="ln">9</span><span class="cl">sudo ln -s /etc/nginx/sites-available/webpage /etc/nginx/sites-enabled/webpage</span></span></code></pre></div><h3 id="html-test">HTML Test</h3>





<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-html" data-lang="html"><span class="line"><span class="ln"> 1</span><span class="cl">### /var/www/webpage/index.html ###
</span></span><span class="line"><span class="ln"> 2</span><span class="cl"># ! HTML Test ! #
</span></span><span class="line"><span class="ln"> 3</span><span class="cl"><span class="cp">&lt;!doctype html&gt;</span>
</span></span><span class="line"><span class="ln"> 4</span><span class="cl"><span class="p">&lt;</span><span class="nt">html</span> <span class="na">lang</span><span class="o">=</span><span class="s">&#34;en&#34;</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="ln"> 5</span><span class="cl"><span class="p">&lt;</span><span class="nt">head</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="ln"> 6</span><span class="cl">  <span class="p">&lt;</span><span class="nt">meta</span> <span class="na">charset</span><span class="o">=</span><span class="s">&#34;utf-8&#34;</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="ln"> 7</span><span class="cl">  <span class="p">&lt;</span><span class="nt">title</span><span class="p">&gt;</span>Web Hosting Guide - Success!<span class="p">&lt;/</span><span class="nt">title</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="ln"> 8</span><span class="cl"><span class="p">&lt;/</span><span class="nt">head</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="ln"> 9</span><span class="cl"><span class="p">&lt;</span><span class="nt">body</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="ln">10</span><span class="cl">  <span class="p">&lt;</span><span class="nt">h1</span><span class="p">&gt;</span>Web Hosting Guide - Success!<span class="p">&lt;/</span><span class="nt">h1</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="ln">11</span><span class="cl"><span class="p">&lt;/</span><span class="nt">body</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="ln">12</span><span class="cl"><span class="p">&lt;/</span><span class="nt">html</span><span class="p">&gt;</span></span></span></code></pre></div><h3 id="applying-permissions">Applying Permissions</h3>
<p>It is important that your web root and web content has the proper permissions.</p>
<ul>
<li><strong>755 (Folders)</strong>: Owner (www-data) has rwx, group (www-data) has rx, others have rx.</li>
<li><strong>644 (Files)</strong>: Owner (www-data) has rw, group (www-data) only have r, others only have r.</li>
</ul>





<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-sh" data-lang="sh"><span class="line"><span class="ln"> 1</span><span class="cl"><span class="c1">### Apply Permissions (Script) ###</span>
</span></span><span class="line"><span class="ln"> 2</span><span class="cl"><span class="c1">#!/bin/bash</span>
</span></span><span class="line"><span class="ln"> 3</span><span class="cl">
</span></span><span class="line"><span class="ln"> 4</span><span class="cl"><span class="nb">set</span> -euo pipefail
</span></span><span class="line"><span class="ln"> 5</span><span class="cl">
</span></span><span class="line"><span class="ln"> 6</span><span class="cl"><span class="nv">WEBROOT</span><span class="o">=</span><span class="s2">&#34;/var/www/webpage&#34;</span>
</span></span><span class="line"><span class="ln"> 7</span><span class="cl"><span class="nv">USER</span><span class="o">=</span><span class="s2">&#34;www-data&#34;</span>
</span></span><span class="line"><span class="ln"> 8</span><span class="cl"><span class="nv">GROUP</span><span class="o">=</span><span class="s2">&#34;www-data&#34;</span>
</span></span><span class="line"><span class="ln"> 9</span><span class="cl">
</span></span><span class="line"><span class="ln">10</span><span class="cl">sudo chown -R <span class="s2">&#34;</span><span class="nv">$USER</span><span class="s2">:</span><span class="nv">$GROUP</span><span class="s2">&#34;</span> <span class="s2">&#34;</span><span class="nv">$WEBROOT</span><span class="s2">&#34;</span>
</span></span><span class="line"><span class="ln">11</span><span class="cl">sudo find <span class="s2">&#34;</span><span class="nv">$WEBROOT</span><span class="s2">&#34;</span> -type d -exec chmod <span class="m">755</span> <span class="o">{}</span> <span class="se">\;</span>
</span></span><span class="line"><span class="ln">12</span><span class="cl">sudo find <span class="s2">&#34;</span><span class="nv">$WEBROOT</span><span class="s2">&#34;</span> -type f -exec chmod <span class="m">644</span> <span class="o">{}</span> <span class="se">\;</span>
</span></span><span class="line"><span class="ln">13</span><span class="cl">
</span></span><span class="line"><span class="ln">14</span><span class="cl">sudo systemctl restart --now nginx</span></span></code></pre></div><h2 id="congratulations">Congratulations!</h2>
<p><img src="/images/posts/web-hosting/finalized.webp" alt="Finalized Web Page"></p>
<p>We finally have a working web page published—though we are <em>far</em> from finished.</p>
<p>This site is still highly vulnerable, and we&rsquo;ll need to implement CSP and some configuration changes to Nginx itself; this needs to be <strong>production grade</strong>.</p>
<small><i><b>In no way should you actually leave it this vulnerable—even if your site is purely static, you should harden it as much as possible.</b></i></small>

<p><a href="/posts/web-hardening/">Check out my follow-up article regarding web hardening</a>.</p>
]]></content:encoded>
    </item>
    <item>
      <title>DNS Hardening</title>
      <link>https://masontuckett.xyz/posts/dns-hardening/</link>
      <pubDate>Sat, 30 Aug 2025 00:38:44 -0700</pubDate><author>mason@tuckett.xyz (Mason Tuckett)</author>
      <guid>https://masontuckett.xyz/posts/dns-hardening/</guid>
      <description>&lt;p&gt;A Brief Overview of DNS Hardening&lt;/p&gt;&#xA;&lt;h2 id=&#34;what-is-dns&#34;&gt;What is DNS?&lt;/h2&gt;&#xA;&lt;p&gt;&lt;a href=&#34;https://www.rfc-editor.org/rfc/rfc9499&#34;&gt;Domain Name System (DNS)&lt;/a&gt; is a protocol designed to translate IP addresses (IPv4/6) into human-readable addresses—e.g., &lt;a href=&#34;https://search.tuckettlab.xyz&#34;&gt;search.tuckettlab.xyz&lt;/a&gt;.&lt;/p&gt;&#xA;&lt;small&gt;&lt;i&gt;&lt;b&gt;In practice the inverse: human-readable addresses &gt; IP addresses&lt;/b&gt;&lt;/i&gt;&lt;/small&gt;&#xA;&#xA;&lt;p&gt;Without DNS, navigating the internet would be needlessly exhausting—requiring users to manually enter an IP address every time they were to access web content.&lt;/p&gt;&#xA;&lt;p&gt;Additionally, dynamic mapping executed via DNS allows for essential accessibility functions like geo-availability—providing content within relevant geographic locations—&lt;em&gt;significantly accelerating your web traffic&lt;/em&gt;.&lt;/p&gt;</description>
      <content:encoded><![CDATA[<p>A Brief Overview of DNS Hardening</p>
<h2 id="what-is-dns">What is DNS?</h2>
<p><a href="https://www.rfc-editor.org/rfc/rfc9499">Domain Name System (DNS)</a> is a protocol designed to translate IP addresses (IPv4/6) into human-readable addresses—e.g., <a href="https://search.tuckettlab.xyz">search.tuckettlab.xyz</a>.</p>
<small><i><b>In practice the inverse: human-readable addresses > IP addresses</b></i></small>

<p>Without DNS, navigating the internet would be needlessly exhausting—requiring users to manually enter an IP address every time they were to access web content.</p>
<p>Additionally, dynamic mapping executed via DNS allows for essential accessibility functions like geo-availability—providing content within relevant geographic locations—<em>significantly accelerating your web traffic</em>.</p>
<h2 id="how-does-dns-work">How Does DNS Work?</h2>
<p><img src="/images/posts/dns-hardening/dns-structure.jpg" alt="DNS Structure Diagram"></p>
<p>DNS is a highly structured and hierarchical protocol—relying on several chains of trust to translate addresses.</p>
<h3 id="root-servers">Root Servers</h3>
<ul>
<li>The top of the rung, served by 13 root server identifiers (12 organizations) distributed worldwide.</li>
<li>Does not store zone records for domains, but they return referrals to the authoritative nameservers for the requested TLD (not individual domains): <strong>.xyz(.)</strong>.</li>
</ul>
<h3 id="top-level-domains">Top-Level Domains</h3>
<ul>
<li>Second, just below root servers—housing domain extensions like: <strong>.edu, .com, .net, and .xyz</strong>.</li>
<li>TLD servers return referrals to authoritative nameservers for second-level domains.</li>
</ul>
<h3 id="second-level-domains">Second-Level Domains</h3>
<ul>
<li>Third in the chain, delegated <em>(by authoritative servers)</em> and purchasable from domain registrars; second-level domains are registered under a TLD: <strong><em>tuckettlab</em>.xyz</strong>.</li>
<li>SLDs lie within authoritative servers, <em>essentially</em> where your DNS records actually exist (zone): <strong>A/AAAA</strong>—pointing to valid IP addresses.</li>
</ul>
<h3 id="third-level-domains">Third-Level Domains</h3>
<ul>
<li>Fourth in the chain, subdomains (within parent zone) managed by DNS records <strong>(CNAME, A, AAAA)</strong>: <strong><em>search</em>.tuckettlab.xyz</strong></li>
<li>Commonly used for load balancing and service separation: <strong><em>mail</em>.tuckettlab.xyz (MX)</strong>.</li>
</ul>
<h3 id="hostfqdn">Host/FQDN</h3>
<ul>
<li>Last step: produces a fully qualified domain name (FQDN), which uniquely identifies a host—<em>accessible to users</em>.</li>
<li>For users: a recursive DNS server queries step by step: root <strong>&gt;</strong> top-level domain server <strong>&gt;</strong> second-level authoritative <strong>&gt;</strong> subdomain (third-level domain) <strong>&gt;</strong> resolver returns the corresponding record to the client.</li>
</ul>
<h3 id="response-codes">Response Codes</h3>
<p><strong>NXDOMAIN:</strong> A response code representing the absence or non-existence of a domain.</p>
<ul>
<li>Authoritative servers for the TLD respond NXDOMAIN if the entire SLD doesn’t exist under its respective TLD; otherwise, NXDOMAIN comes from the authoritative SLD server.</li>
</ul>
<p><strong>NODATA (NOERROR/Empty):</strong> A response code indicating that the domain <em>does</em> exist, but no records of the requested type are present (A is present, AAAA is not).</p>
<h3 id="example-queries">Example Queries</h3>





<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-txt" data-lang="txt"><span class="line"><span class="ln"> 1</span><span class="cl">### Successful Query ###
</span></span><span class="line"><span class="ln"> 2</span><span class="cl">dig NS search.tuckettlab.xyz
</span></span><span class="line"><span class="ln"> 3</span><span class="cl">
</span></span><span class="line"><span class="ln"> 4</span><span class="cl">; &lt;&lt;&gt;&gt; DiG 9.18.30-0ubuntu0.24.04.2-Ubuntu &lt;&lt;&gt;&gt; NS search.tuckettlab.xyz
</span></span><span class="line"><span class="ln"> 5</span><span class="cl">;; global options: +cmd
</span></span><span class="line"><span class="ln"> 6</span><span class="cl">;; Got answer:
</span></span><span class="line"><span class="ln"> 7</span><span class="cl">;; -&gt;&gt;HEADER&lt;&lt;- opcode: QUERY, status: !!!NOERROR!!!, id: 51001
</span></span><span class="line"><span class="ln"> 8</span><span class="cl">;; flags: qr rd ra; QUERY: 1, ANSWER: 0, AUTHORITY: 1, ADDITIONAL: 1
</span></span><span class="line"><span class="ln"> 9</span><span class="cl">
</span></span><span class="line"><span class="ln">10</span><span class="cl">;; OPT PSEUDOSECTION:
</span></span><span class="line"><span class="ln">11</span><span class="cl">; EDNS: version: 0, flags:; udp: 65494
</span></span><span class="line"><span class="ln">12</span><span class="cl">;; QUESTION SECTION:
</span></span><span class="line"><span class="ln">13</span><span class="cl">;search.tuckettlab.xyz.		IN	NS
</span></span><span class="line"><span class="ln">14</span><span class="cl">
</span></span><span class="line"><span class="ln">15</span><span class="cl">;; AUTHORITY SECTION:
</span></span><span class="line"><span class="ln">16</span><span class="cl">tuckettlab.xyz.		150	IN	SOA	ns1.vultr.com. dnsadm.choopa.com. 0 10800 3600 604800 3600
</span></span><span class="line"><span class="ln">17</span><span class="cl">
</span></span><span class="line"><span class="ln">18</span><span class="cl">;; Query time: 1 msec
</span></span><span class="line"><span class="ln">19</span><span class="cl">;; SERVER: 127.0.0.53#53(127.0.0.53) (UDP)
</span></span><span class="line"><span class="ln">20</span><span class="cl">;; WHEN: Sat Aug 30 11:52:13 MDT 2025
</span></span><span class="line"><span class="ln">21</span><span class="cl">;; MSG SIZE  rcvd: 113
</span></span><span class="line"><span class="ln">22</span><span class="cl">
</span></span><span class="line"><span class="ln">23</span><span class="cl">### Unsuccessful Query ###
</span></span><span class="line"><span class="ln">24</span><span class="cl">dig NS ?.xyz
</span></span><span class="line"><span class="ln">25</span><span class="cl">
</span></span><span class="line"><span class="ln">26</span><span class="cl">; &lt;&lt;&gt;&gt; DiG 9.18.30-0ubuntu0.24.04.2-Ubuntu &lt;&lt;&gt;&gt; NS ?.xyz
</span></span><span class="line"><span class="ln">27</span><span class="cl">;; global options: +cmd
</span></span><span class="line"><span class="ln">28</span><span class="cl">;; Got answer:
</span></span><span class="line"><span class="ln">29</span><span class="cl">;; -&gt;&gt;HEADER&lt;&lt;- opcode: QUERY, status: !!!NXDOMAIN!!!, id: 61057
</span></span><span class="line"><span class="ln">30</span><span class="cl">;; flags: qr rd ra; QUERY: 1, ANSWER: 0, AUTHORITY: 1, ADDITIONAL: 1
</span></span><span class="line"><span class="ln">31</span><span class="cl">
</span></span><span class="line"><span class="ln">32</span><span class="cl">;; OPT PSEUDOSECTION:
</span></span><span class="line"><span class="ln">33</span><span class="cl">; EDNS: version: 0, flags:; udp: 65494
</span></span><span class="line"><span class="ln">34</span><span class="cl">;; QUESTION SECTION:
</span></span><span class="line"><span class="ln">35</span><span class="cl">;?.xyz.				IN	NS
</span></span><span class="line"><span class="ln">36</span><span class="cl">
</span></span><span class="line"><span class="ln">37</span><span class="cl">;; AUTHORITY SECTION:
</span></span><span class="line"><span class="ln">38</span><span class="cl">xyz.			773	IN	SOA	ns0.centralnic.net. hostmaster.centralnic.net. 3000828297 900 1800 6048000 3600
</span></span><span class="line"><span class="ln">39</span><span class="cl">
</span></span><span class="line"><span class="ln">40</span><span class="cl">;; Query time: 80 msec
</span></span><span class="line"><span class="ln">41</span><span class="cl">;; SERVER: 127.0.0.53#53(127.0.0.53) (UDP)
</span></span><span class="line"><span class="ln">42</span><span class="cl">;; WHEN: Sat Aug 30 11:55:18 MDT 2025
</span></span><span class="line"><span class="ln">43</span><span class="cl">;; MSG SIZE  rcvd: 99</span></span></code></pre></div><h2 id="dns-records">DNS Records</h2>
<p>Within the managed zone, records are applied to guide users towards specific services.</p>
<h3 id="common-records">Common Records</h3>
<small><i><b>Concise for the Sake of Brevity</b></i></small>

<ul>
<li><strong>NS</strong> - Name Server <em>(Delegates authority for domains)</em>.</li>
<li><strong>SOA</strong> - Start of Authority (Provides administrative information about the zone)</li>
<li><strong>A/AAAA</strong> - IPv4/6 Addresses <em>(Points to the designated IP address.)</em>.</li>
<li><strong>CNAME</strong> - Canonical Name <em>(Points a name to another name; A/AAAA record is after the target)</em>.</li>
<li><strong>MX</strong> - Mail Record <em>(Normally points to mail subdomain)</em>.</li>
<li><strong>PTR</strong> - Pointer <em>(Reverse DNS is configured by your IP provider (VPS/ISP), not on forward zone; IP &gt; domain)</em>.</li>
<li><strong>TXT</strong> - Text <em>(Commonly used for SPF/DKIM/DMARC for mail; can be informative)</em>.</li>
<li><strong>CAA</strong> - Certificate Authority Authorization <em>(Permits which certificate authorities can permit SSL/TLS Certs)</em>.</li>
<li><strong>DNSKEY</strong> - Domain Name System Key <em>(Stores public key in zone; used for DNSSEC validation)</em>.</li>
<li><strong>DS</strong> - Delegation Signer <em>(Stored in parent zone, contains hash of child zone&rsquo;s DNSKEY record)</em>.</li>
<li><strong>CDNSKEY/CDS</strong> - Child DNSKEY/DS <em>(Utilized for child to publish key details to parent zone)</em>.</li>
</ul>
<h3 id="txt-related-records">TXT-Related Records</h3>
<ul>
<li><strong>SPF</strong> - Sender Policy Framework <em>(Specifies which mail servers are authorized To send mail)</em>.</li>
<li><strong>DKIM</strong> - DomainKeys Identified Mail <em>(Cryptographic signature system for email content/headers)</em>.</li>
<li><strong>DMARC</strong> - Domain-based Message Authentication <em>(Instructs receiving mail servers to handle mail that fails SPF/DKIM checks; may report to admin&rsquo;s email)</em>.</li>
</ul>
<h3 id="ttls">TTLs</h3>
<p>When configuring DNS zones, you will have the option to give records a Time to Live (TTL)—representing the number of seconds a DNS record is cached before it is re-queried by an authoritative server.</p>
<h2 id="record-representation">Record Representation</h2>
<p><a href="https://www.digwebinterface.com/">Dig Web Interface</a></p>





<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-txt" data-lang="txt"><span class="line"><span class="ln"> 1</span><span class="cl">### ! FORMAT ! ###
</span></span><span class="line"><span class="ln"> 2</span><span class="cl">Domain (Root:.)   TTL Class Record Data Priority
</span></span><span class="line"><span class="ln"> 3</span><span class="cl"> 
</span></span><span class="line"><span class="ln"> 4</span><span class="cl">### NS ###
</span></span><span class="line"><span class="ln"> 5</span><span class="cl">dig NS tuckettlab.xyz
</span></span><span class="line"><span class="ln"> 6</span><span class="cl">
</span></span><span class="line"><span class="ln"> 7</span><span class="cl">tuckettlab.xyz.		300	IN	NS	ns1.vultr.com.
</span></span><span class="line"><span class="ln"> 8</span><span class="cl">tuckettlab.xyz.		300	IN	NS	ns2.vultr.com.
</span></span><span class="line"><span class="ln"> 9</span><span class="cl">
</span></span><span class="line"><span class="ln">10</span><span class="cl">## SOA ##
</span></span><span class="line"><span class="ln">11</span><span class="cl">dig SOA tuckettlab.xyz
</span></span><span class="line"><span class="ln">12</span><span class="cl">
</span></span><span class="line"><span class="ln">13</span><span class="cl">tuckettlab.xyz.		300	IN	SOA	ns1.vultr.com. dnsadm.choopa.com. 0 10800 3600 604800 3600
</span></span><span class="line"><span class="ln">14</span><span class="cl">
</span></span><span class="line"><span class="ln">15</span><span class="cl">### A/AAAA ###
</span></span><span class="line"><span class="ln">16</span><span class="cl">dig A tuckettlab.xyz AAAA tuckettlab.xyz
</span></span><span class="line"><span class="ln">17</span><span class="cl">
</span></span><span class="line"><span class="ln">18</span><span class="cl">tuckettlab.xyz.		3600	IN	A	149.28.67.27
</span></span><span class="line"><span class="ln">19</span><span class="cl">tuckettlab.xyz.		3600	IN AAAA 2001:db8::25
</span></span><span class="line"><span class="ln">20</span><span class="cl">
</span></span><span class="line"><span class="ln">21</span><span class="cl">### CNAME ###
</span></span><span class="line"><span class="ln">22</span><span class="cl">dig CNAME www.tuckettlab.xyz
</span></span><span class="line"><span class="ln">23</span><span class="cl">
</span></span><span class="line"><span class="ln">24</span><span class="cl">www.tuckettlab.xyz.  3600  IN  CNAME  tuckettlab.xyz.
</span></span><span class="line"><span class="ln">25</span><span class="cl">
</span></span><span class="line"><span class="ln">26</span><span class="cl">### MX ###
</span></span><span class="line"><span class="ln">27</span><span class="cl">dig MX tuckettlab.xyz
</span></span><span class="line"><span class="ln">28</span><span class="cl">
</span></span><span class="line"><span class="ln">29</span><span class="cl">tuckettlab.xyz.		3600	IN	MX	10 mail.server.net.
</span></span><span class="line"><span class="ln">30</span><span class="cl">
</span></span><span class="line"><span class="ln">31</span><span class="cl">### PTR ###
</span></span><span class="line"><span class="ln">32</span><span class="cl">dig -x 149.28.67.27
</span></span><span class="line"><span class="ln">33</span><span class="cl">
</span></span><span class="line"><span class="ln">34</span><span class="cl">27.67.28.149.in-addr.arpa. 3555	IN	PTR	tuckettlab.xyz.
</span></span><span class="line"><span class="ln">35</span><span class="cl">
</span></span><span class="line"><span class="ln">36</span><span class="cl">### CAA ###
</span></span><span class="line"><span class="ln">37</span><span class="cl">dig CAA tuckettlab.xyz
</span></span><span class="line"><span class="ln">38</span><span class="cl">
</span></span><span class="line"><span class="ln">39</span><span class="cl">tuckettlab.xyz.		3600	IN	CAA	0 issue &#34;tlsprovider.net&#34;
</span></span><span class="line"><span class="ln">40</span><span class="cl">tuckettlab.xyz.		3600	IN	CAA	0 issuewild &#34;tlsprovider.net&#34;
</span></span><span class="line"><span class="ln">41</span><span class="cl">tuckettlab.xyz.		3600	IN	CAA	0 iodef &#34;mailto:admin@admin.net&#34;
</span></span><span class="line"><span class="ln">42</span><span class="cl">
</span></span><span class="line"><span class="ln">43</span><span class="cl">
</span></span><span class="line"><span class="ln">44</span><span class="cl">### DNSKEY/DS ###
</span></span><span class="line"><span class="ln">45</span><span class="cl">dig @9.9.9.9 DNSKEY tuckettlab.xyz DS tuckettlab.xyz
</span></span><span class="line"><span class="ln">46</span><span class="cl">
</span></span><span class="line"><span class="ln">47</span><span class="cl">tuckettlab.xyz.		2761	IN	DNSKEY	257 3 13 UguAJ1bTfrBPNp+jHQ2oZNaPSUsUHaCnwRW+Wcxaf2BueGEmnMGAINj2 1b7gANfBBqqXoB6dGTeOBHfvjAvOdA==
</span></span><span class="line"><span class="ln">48</span><span class="cl">tuckettlab.xyz.		3600	IN	DS	35175 13 4 865FE510C4CE390FF7285308B9351880A84039F1D75ACA278EF37F9D 71F605D8EC69C87E2F5660CA8BC5BC477A715868
</span></span><span class="line"><span class="ln">49</span><span class="cl">tuckettlab.xyz.		3600	IN	DS	35175 13 2 871FD8CC8AFC7A1A6C60558112837CD7F288A20CC7F639709AD4A703 9C21E6B9
</span></span><span class="line"><span class="ln">50</span><span class="cl">
</span></span><span class="line"><span class="ln">51</span><span class="cl">### TXT Mail Records ###
</span></span><span class="line"><span class="ln">52</span><span class="cl">dig TXT tuckettlab.xyz TXT selector._domainkey.tuckettlab.xyz TXT _dmarc.tuckettlab.xyz 
</span></span><span class="line"><span class="ln">53</span><span class="cl">
</span></span><span class="line"><span class="ln">54</span><span class="cl">tuckettlab.xyz.		3600	IN	TXT	&#34;v=spf1 include:_spf.mail.net ~all&#34;
</span></span><span class="line"><span class="ln">55</span><span class="cl">_dmarc.tuckettlab.xyz.	3600	IN	TXT	&#34;v=DMARC1; p=quarantine&#34;
</span></span><span class="line"><span class="ln">56</span><span class="cl">selector._domainkey.tuckettlab.xyz. 3600 IN TXT &#34;v=DKIM1; k=key type; p=pubkey&#34;</span></span></code></pre></div><h2 id="hardening-dns">Hardening DNS</h2>
<small><i><b>Now this is where the fun begins...</b></i></small>

<p>Hardening DNS is quite a bit more straightforward than dealing with content security policies and general systems.</p>
<p>Most registrars allow you to manually edit your zone; if not, find a more consumer-friendly registrar.</p>
<p>For hardening purposes, some registrars hide DNSSEC behind a paywall; make sure to do your research.</p>
<p>If you are using a VPS for your infrastructure, it may be best to move your zone to your VPS provider—supplying a unified management pane with easy DNSSEC support.</p>
<h3 id="aaaaa">A/AAAA</h3>
<p>It is best to keep these records current and remove anything that may be used by malicious actors.</p>
<p>Many providers offer built-in proxies, where you can mask your origin traffic behind another IP address.</p>
<small><i><b>I avoided AAAA records because they may increase my attack surface—exposing an additional interface that is susceptible if not hardened.</b></i></small>

<h3 id="cname">CNAME</h3>
<p>CNAME records do not resolve directly—requiring two lookups instead of one—slowing resolution (negligible).</p>
<p>This may not be an inherent issue, but wildcard records should be avoided because this opens your zone to a litany of abuse (largely impersonation).</p>
<p>Additionally, it can make administration far more difficult, as each chain must be validated under DNSSEC; unstable in general.</p>
<h3 id="mx">MX</h3>
<p>Depending on your use case, you may want this enabled or disabled; are you using email with this domain?</p>
<p>If your domain does not require email, setting a <a href="https://www.rfc-editor.org/rfc/rfc7505.html">NULL MX</a> record prevents any attempts at impersonation.</p>
<h3 id="mx-txt-records">MX TXT Records</h3>
<p>Setting your <a href="https://www.rfc-editor.org/rfc/rfc7208.html">SPF TXT</a> record to a hard fail further cements your defense against potential forgery <strong>(-all HARD vs ~all SOFT)</strong>.</p>
<p>Sane <a href="https://www.rfc-editor.org/rfc/rfc7489.html">DMARC TXT</a> values are also incredibly important for securing your email.</p>
<p>With that in mind, DMARC has quite a selection of potential options:</p>
<ul>
<li>
<p>Policy <strong>(p)</strong>: <em>should not be set to quarantine</em>; it is best to outright <strong>REJECT</strong> (following a staging process) to prevent against phishing.</p>
</li>
<li>
<p>Subdomain Policy <strong>(sp)</strong>: behaves in a similar fashion—but only covering subdomains; if not set, subdomains may default back to a weaker policy.</p>
</li>
<li>
<p>Alignment Mode for DKIM <strong>(adkim)</strong>: is a great complement towards a secure DKIM setup; <em>it may contain the values strict</em> <strong>(s)</strong> <em>or relaxed</em> <strong>(r)</strong>.</p>
</li>
<li>
<p>Alignment Mode for SPF <strong>(aspf)</strong>: behaves quite similarly to adkim but is a reinforcement for your SPF TXT record; <em>again, it may contain values strict</em> <strong>(s)</strong> <em>or relaxed</em> <strong>(r)</strong>.</p>
</li>
<li>
<p>The Percentage of Messages <strong>(pct)</strong>: is related to how many potential messages these policies apply to; <em>optimal if set to</em> <strong>100 (100%)</strong>.</p>
</li>
<li>
<p>Aggregate Reports <strong>(rua)</strong>: may be enabled, which includes reporting for sent mail and DKIM/DMARC/SPF stats.</p>
</li>
<li>
<p>Forensic Reports <strong>(ruf)</strong>: may also be enabled—sending immediate notices for DMARC evaluation failures (far noisier than rua).</p>
</li>
<li>
<p>The Failure Options tag <strong>(fo)</strong>: complements both reporting features, ranging in values from <strong>0</strong> (both SPF/DKIM fail), <strong>1</strong> (either SPF/DKIM fails), <strong>d</strong> (DKIM), <strong>s</strong> (SPF).</p>
</li>
</ul>
<p><small><i><b>For my setup, I do not want ANY mail to be sent from this domain—as this is for self-hosted services ONLY.</b></i></small>
<br>
<small><i><b>DKIM will not exist, nor possibly be resolved.</b></i></small>
</p>





<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-txt" data-lang="txt"><span class="line"><span class="ln">1</span><span class="cl">### MX Record - NO MAIL ###
</span></span><span class="line"><span class="ln">2</span><span class="cl">tuckettlab.xyz.		3600	IN	MX	0 .
</span></span><span class="line"><span class="ln">3</span><span class="cl">
</span></span><span class="line"><span class="ln">4</span><span class="cl">### MX TXT Records - Complements NO MAIL Policy (No rua/ruf) ###
</span></span><span class="line"><span class="ln">5</span><span class="cl">tuckettlab.xyz.		1736	IN	TXT	&#34;v=spf1 -all&#34;
</span></span><span class="line"><span class="ln">6</span><span class="cl">_dmarc.tuckettlab.xyz.	1818	IN	TXT	&#34;v=DMARC1; p=reject; sp=reject; adkim=s; aspf=s; pct=100&#34;
</span></span><span class="line"><span class="ln">7</span><span class="cl">
</span></span><span class="line"><span class="ln">8</span><span class="cl">### DMARC With Reporting ###
</span></span><span class="line"><span class="ln">9</span><span class="cl">_dmarc.tuckettlab.xyz. 1818    IN  TXT &#34;v=DMARC1; p=reject; sp=reject; rua=mailto:admin@tuckett.xyz; ruf=mailto:admin@tuckett.xyz; fo=1; adkim=s; aspf=s; pct=100&#34;</span></span></code></pre></div><h3 id="dnssec">DNSSEC</h3>
<p>I cannot stress how important it is to enable DNSSEC for your domains.</p>
<p>Doing so provides:</p>
<ul>
<li><strong>Authenticity</strong>: <em>(Supplies strong cryptographic context for whether the record truly came from the authoritative server)</em>.</li>
<li><strong>Integrity</strong>: <em>(Prevents MITM tampering; guards DNS responses in transit)</em>.</li>
<li><strong>Anti-Cache Poisoning</strong>: <em><a href="https://docs.projectsecurity.io/na101/attacks/dnsattack/">(Impersonators CANNOT inject falsified DNS data into resolvers)</a></em>.</li>
</ul>
<p>It is as simple as configuring a few keys from your registrar and publishing them within your zone.</p>





<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-txt" data-lang="txt"><span class="line"><span class="ln">1</span><span class="cl">### Enable DNSKEY and DS Record for DNSSEC (USE STRONG ALGORITHMS) ###
</span></span><span class="line"><span class="ln">2</span><span class="cl">tuckettlab.xyz.		3600	IN	DNSKEY	257 3 13 UguAJ1bTfrBPNp+jHQ2oZNaPSUsUHaCnwRW+Wcxaf2BueGEmnMGAINj2 1b7gANfBBqqXoB6dGTeOBHfvjAvOdA==
</span></span><span class="line"><span class="ln">3</span><span class="cl">
</span></span><span class="line"><span class="ln">4</span><span class="cl">tuckettlab.xyz.		214	IN	DS	35175 13 4 865FE510C4CE390FF7285308B9351880A84039F1D75ACA278EF37F9D 71F605D8EC69C87E2F5660CA8BC5BC477A715868
</span></span><span class="line"><span class="ln">5</span><span class="cl">tuckettlab.xyz.		214	IN	DS	35175 13 2 871FD8CC8AFC7A1A6C60558112837CD7F288A20CC7F639709AD4A703 9C21E6B9</span></span></code></pre></div><h3 id="caa">CAA</h3>
<p>Also a massive oversight; <a href="https://www.rfc-editor.org/rfc/rfc8659.html">CAA records</a> prevent rogue issuance by malicious CAs.</p>
<p>CAA flags are set in 8-bit values (0-255); 0 is default (non-critical)—which allows soft fails (sometimes needed for compatibility).</p>
<p>128 is functionally the only value worth using, as it is treated as critical and far more strict (must be understood by CAs).</p>
<p>Both issue and issuewild are utilized for SSL/TLS distinction; wildcard certs may be utilized, though they are not advised.</p>





<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-txt" data-lang="txt"><span class="line"><span class="ln">1</span><span class="cl">### Sane Value - Only Allows Strict Issuance From Let&#39;s Encrypt ###
</span></span><span class="line"><span class="ln">2</span><span class="cl">tuckettlab.xyz.		2103	IN	CAA	128 issue &#34;letsencrypt.org&#34;
</span></span><span class="line"><span class="ln">3</span><span class="cl">
</span></span><span class="line"><span class="ln">4</span><span class="cl">### Disable Wildcard Certs - Prevents Against Wildcard Abuse (; = NO CAs) ###
</span></span><span class="line"><span class="ln">5</span><span class="cl">tuckettlab.xyz.		2103	IN	CAA	128 issuewild &#34;;&#34;
</span></span><span class="line"><span class="ln">6</span><span class="cl">
</span></span><span class="line"><span class="ln">7</span><span class="cl">### Incident Object Description Exchange Format - Instructs CAs Where to Send Reports ###
</span></span><span class="line"><span class="ln">8</span><span class="cl">tuckettlab.xyz.		2103	IN	CAA	128 iodef &#34;mailto:admin@tuckett.xyz&#34;</span></span></code></pre></div><h3 id="txt-records">TXT Records</h3>
<p>It may be useful to include important information within your TXT records, as most text may be inserted.</p>
<small><i><b>I included important statements, checksums, onion location(s) (if not pulled by HTTP header), and my GPG info.</b></i></small>






<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-txt" data-lang="txt"><span class="line"><span class="ln">1</span><span class="cl">### My TXT Records ###
</span></span><span class="line"><span class="ln">2</span><span class="cl">tuckettlab.xyz.		1736	IN	TXT	&#34;gpg-mirror=https://github.com/masontuckett/masontuckett.gpg&#34;
</span></span><span class="line"><span class="ln">3</span><span class="cl">tuckettlab.xyz.		1736	IN	TXT	&#34;gpg=https://masontuckett.xyz/masontuckett.gpg&#34;
</span></span><span class="line"><span class="ln">4</span><span class="cl">tuckettlab.xyz.		1736	IN	TXT	&#34;gpg-pubkey-fpr=7272B8036060E4590218A95D11F58765E7B21193&#34;
</span></span><span class="line"><span class="ln">5</span><span class="cl">tuckettlab.xyz.		1736	IN	TXT	&#34;onion-search=ujozjm7regwuwszlcyx2g3jn6bgegrxk5x72q3om6sxb7kq7x5fgcwqd&#34;
</span></span><span class="line"><span class="ln">6</span><span class="cl">tuckettlab.xyz.		1736	IN	TXT	&#34;privacy-policy=https://masontuckett.xyz/privacy-policy.txt&#34;
</span></span><span class="line"><span class="ln">7</span><span class="cl">tuckettlab.xyz.		1736	IN	TXT	&#34;onion-library=ekybwg2m7fgocpnr5ofjjo2lrfunptquipqihfaxodand4qfm6rc3gqd&#34;
</span></span><span class="line"><span class="ln">8</span><span class="cl">tuckettlab.xyz.		1736	IN	TXT	&#34;auth-statement=https://masontuckett.xyz/tor-mirror-statement.txt&#34;
</span></span><span class="line"><span class="ln">9</span><span class="cl">tuckettlab.xyz.		1736	IN	TXT	&#34;sha512sums=https://masontuckett.xyz/sha512-hashes.txt&#34;</span></span></code></pre></div><h3 id="live-demonstration">Live Demonstration</h3>





<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-txt" data-lang="txt"><span class="line"><span class="ln"> 1</span><span class="cl">;; ANSWER SECTION:
</span></span><span class="line"><span class="ln"> 2</span><span class="cl">tuckettlab.xyz.		3600	IN	A	149.28.67.27
</span></span><span class="line"><span class="ln"> 3</span><span class="cl">tuckettlab.xyz.		3600	IN	RRSIG	A 13 2 3600 20250911000000 20250821000000 35175 tuckettlab.xyz. pLFdcvumIdn66a+KwNtzpAdXrL2/QoBaKK4Ah2+mb0c0uoh81gZMlHnI yHO3q4+D8ZiokKKGg+GOllTRFu0REw==
</span></span><span class="line"><span class="ln"> 4</span><span class="cl">tuckettlab.xyz.		300	IN	NS	ns2.vultr.com.
</span></span><span class="line"><span class="ln"> 5</span><span class="cl">tuckettlab.xyz.		300	IN	NS	ns1.vultr.com.
</span></span><span class="line"><span class="ln"> 6</span><span class="cl">tuckettlab.xyz.		300	IN	RRSIG	NS 13 2 300 20250911000000 20250821000000 35175 tuckettlab.xyz. NKfKYWEfEC6QKsLpL8Skb948Mj2uCxl3YgUkweaFrBix97lZdqOGzxH/ XuUUry62xW/8x9SCZi+xfv7Zh7JLxA==
</span></span><span class="line"><span class="ln"> 7</span><span class="cl">tuckettlab.xyz.		300	IN	SOA	ns1.vultr.com. dnsadm.choopa.com. 0 10800 3600 604800 3600
</span></span><span class="line"><span class="ln"> 8</span><span class="cl">tuckettlab.xyz.		300	IN	RRSIG	SOA 13 2 300 20250911000000 20250821000000 35175 tuckettlab.xyz. zsnBppGRceCk6wVxB2ilh61eCEODg8zR4AHr/RhcCSjnvjjlc+rme1wP RAFZYN/0tmO2jTPsyE2GjgXNxnZ0tw==
</span></span><span class="line"><span class="ln"> 9</span><span class="cl">tuckettlab.xyz.		3600	IN	MX	0 .
</span></span><span class="line"><span class="ln">10</span><span class="cl">tuckettlab.xyz.		3600	IN	RRSIG	MX 13 2 3600 20250911000000 20250821000000 35175 tuckettlab.xyz. gt6nQjDrYIrXUhWV75i3BABNiGFV3/1NVeF1n8j1wrjZs81IC6umI66l NEHYfqq702CXnaq5kAe4qv/CBg3u6g==
</span></span><span class="line"><span class="ln">11</span><span class="cl">tuckettlab.xyz.		3600	IN	TXT	&#34;v=spf1 -all&#34;
</span></span><span class="line"><span class="ln">12</span><span class="cl">tuckettlab.xyz.		3600	IN	TXT	&#34;sha512sums=https://masontuckett.xyz/sha512-hashes.txt&#34;
</span></span><span class="line"><span class="ln">13</span><span class="cl">tuckettlab.xyz.		3600	IN	TXT	&#34;auth-statement=https://masontuckett.xyz/tor-mirror-statement.txt&#34;
</span></span><span class="line"><span class="ln">14</span><span class="cl">tuckettlab.xyz.		3600	IN	TXT	&#34;privacy-policy=https://masontuckett.xyz/privacy-policy.txt&#34;
</span></span><span class="line"><span class="ln">15</span><span class="cl">tuckettlab.xyz.		3600	IN	TXT	&#34;gpg-mirror=https://github.com/masontuckett/masontuckett.gpg&#34;
</span></span><span class="line"><span class="ln">16</span><span class="cl">tuckettlab.xyz.		3600	IN	TXT	&#34;onion-library=ekybwg2m7fgocpnr5ofjjo2lrfunptquipqihfaxodand4qfm6rc3gqd&#34;
</span></span><span class="line"><span class="ln">17</span><span class="cl">tuckettlab.xyz.		3600	IN	TXT	&#34;gpg=https://masontuckett.xyz/masontuckett.gpg&#34;
</span></span><span class="line"><span class="ln">18</span><span class="cl">tuckettlab.xyz.		3600	IN	TXT	&#34;onion-search=ujozjm7regwuwszlcyx2g3jn6bgegrxk5x72q3om6sxb7kq7x5fgcwqd&#34;
</span></span><span class="line"><span class="ln">19</span><span class="cl">tuckettlab.xyz.		3600	IN	TXT	&#34;gpg-pubkey-fpr=7272B8036060E4590218A95D11F58765E7B21193&#34;
</span></span><span class="line"><span class="ln">20</span><span class="cl">tuckettlab.xyz.		3600	IN	RRSIG	TXT 13 2 3600 20250911000000 20250821000000 35175 tuckettlab.xyz. 6TLPYOEnXr6ml3B7aTluAwR71fGfit6BQ93Lwumoq6VZZPu2fqd1r05i 8yEZa6tMVCJMhwDKb1GPhyXyWzmNAw==
</span></span><span class="line"><span class="ln">21</span><span class="cl">tuckettlab.xyz.		300	IN	NSEC	_dmarc.tuckettlab.xyz. A NS SOA MX TXT RRSIG NSEC DNSKEY CAA
</span></span><span class="line"><span class="ln">22</span><span class="cl">tuckettlab.xyz.		300	IN	RRSIG	NSEC 13 2 300 20250911000000 20250821000000 35175 tuckettlab.xyz. qTvUILjKw2EToMEjOiBE82s+frvHy4HL100cwCXNGxWVXbJvY3PmfTuy OVyBqpjw4NBHV26ORaNuuIfV5NB0yg==
</span></span><span class="line"><span class="ln">23</span><span class="cl">tuckettlab.xyz.		3600	IN	DNSKEY	257 3 13 UguAJ1bTfrBPNp+jHQ2oZNaPSUsUHaCnwRW+Wcxaf2BueGEmnMGAINj2 1b7gANfBBqqXoB6dGTeOBHfvjAvOdA==
</span></span><span class="line"><span class="ln">24</span><span class="cl">tuckettlab.xyz.		3600	IN	RRSIG	DNSKEY 13 2 3600 20250911000000 20250821000000 35175 tuckettlab.xyz. wrdN1qTW2ZfWZ1wX8I5q7ryFfVQH71LZAUEqN6xeKY+AQRy4TJiU/IEi gxuCoPXnxS1D7N9XHwMip0rUOpie0A==
</span></span><span class="line"><span class="ln">25</span><span class="cl">tuckettlab.xyz.		3600	IN	CAA	128 iodef &#34;mailto:admin@tuckett.xyz&#34;
</span></span><span class="line"><span class="ln">26</span><span class="cl">tuckettlab.xyz.		3600	IN	CAA	128 issuewild &#34;;&#34;
</span></span><span class="line"><span class="ln">27</span><span class="cl">tuckettlab.xyz.		3600	IN	CAA	128 issue &#34;letsencrypt.org&#34;
</span></span><span class="line"><span class="ln">28</span><span class="cl">tuckettlab.xyz.		3600	IN	RRSIG	CAA 13 2 3600 20250911000000 20250821000000 35175 tuckettlab.xyz. +dIuWxaDGXHeN7U/KlzxZOKZATc5a6Mrj7HzcGn88nAJ52dNPj4Suzud SNwZxeg9em8Vb2fVOqifpK/1FbAZrg==
</span></span><span class="line"><span class="ln">29</span><span class="cl">
</span></span><span class="line"><span class="ln">30</span><span class="cl">;; Query time: 32 msec
</span></span><span class="line"><span class="ln">31</span><span class="cl">;; SERVER: 8.8.8.8#53(8.8.8.8) (TCP)
</span></span><span class="line"><span class="ln">32</span><span class="cl">;; WHEN: Sat Aug 30 16:18:37 MDT 2025
</span></span><span class="line"><span class="ln">33</span><span class="cl">;; MSG SIZE  rcvd: 1878
</span></span><span class="line"><span class="ln">34</span><span class="cl">
</span></span><span class="line"><span class="ln">35</span><span class="cl">;; ANSWER SECTION:
</span></span><span class="line"><span class="ln">36</span><span class="cl">_dmarc.tuckettlab.xyz.	3600	IN	TXT	&#34;v=DMARC1; p=reject; sp=reject; adkim=s; aspf=s; pct=100&#34;
</span></span><span class="line"><span class="ln">37</span><span class="cl">
</span></span><span class="line"><span class="ln">38</span><span class="cl">;; Query time: 259 msec
</span></span><span class="line"><span class="ln">39</span><span class="cl">;; SERVER: 9.9.9.9#53(9.9.9.9) (UDP)
</span></span><span class="line"><span class="ln">40</span><span class="cl">;; WHEN: Sat Aug 30 16:16:10 MDT 2025
</span></span><span class="line"><span class="ln">41</span><span class="cl">;; MSG SIZE  rcvd: 118</span></span></code></pre></div><small><i><b> My TTLs are unable to go past 3600; my provider enforces TTL uniformity; other values are the remaining time within the TTL.</b></i></small>

<h3 id="post-hardening-evaluation">Post-Hardening Evaluation</h3>
<p>I believe if you are serious about your security, it is both intrinsically and extrinsically very important to verify your current security posture against other well-known sites/platforms.</p>
<p>I may plan on migrating my infrastructure to a platform that supports NSEC3 (currently stuck at NSEC)—which can prevent <a href="https://dnsinstitute.com/documentation/dnssec-guide/ch06s02.html">trivial zone walking</a>.</p>
<small><i><b>For comparison: "Cyber Guru" John Hammond's Training Platform.</b></i></small>






<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-txt" data-lang="txt"><span class="line"><span class="ln"> 1</span><span class="cl">;; ANSWER SECTION:
</span></span><span class="line"><span class="ln"> 2</span><span class="cl">justhacking.com.	3524	IN	TXT	&#34;v=spf1 include:_spf.google.com ~all&#34;
</span></span><span class="line"><span class="ln"> 3</span><span class="cl">justhacking.com.	3524	IN	TXT	&#34;google-site-verification=WizBgAHBHgn4CAkraQKDWWpGqWqGCVianppbA3tfDGw&#34;
</span></span><span class="line"><span class="ln"> 4</span><span class="cl">justhacking.com.	14324	IN	MX	5 alt1.aspmx.l.google.com.
</span></span><span class="line"><span class="ln"> 5</span><span class="cl">justhacking.com.	14324	IN	MX	10 alt4.aspmx.l.google.com.
</span></span><span class="line"><span class="ln"> 6</span><span class="cl">justhacking.com.	14324	IN	MX	5 alt2.aspmx.l.google.com.
</span></span><span class="line"><span class="ln"> 7</span><span class="cl">justhacking.com.	14324	IN	MX	10 alt3.aspmx.l.google.com.
</span></span><span class="line"><span class="ln"> 8</span><span class="cl">justhacking.com.	14324	IN	MX	1 aspmx.l.google.com.
</span></span><span class="line"><span class="ln"> 9</span><span class="cl">justhacking.com.	21524	IN	SOA	ns-cloud-a1.googledomains.com. cloud-dns-hostmaster.google.com. 12 21600 3600 259200 300
</span></span><span class="line"><span class="ln">10</span><span class="cl">justhacking.com.	21524	IN	NS	ns-cloud-a2.googledomains.com.
</span></span><span class="line"><span class="ln">11</span><span class="cl">justhacking.com.	21524	IN	NS	ns-cloud-a3.googledomains.com.
</span></span><span class="line"><span class="ln">12</span><span class="cl">justhacking.com.	21524	IN	NS	ns-cloud-a4.googledomains.com.
</span></span><span class="line"><span class="ln">13</span><span class="cl">justhacking.com.	21524	IN	NS	ns-cloud-a1.googledomains.com.
</span></span><span class="line"><span class="ln">14</span><span class="cl">justhacking.com.	14324	IN	A	64.23.145.242
</span></span><span class="line"><span class="ln">15</span><span class="cl">
</span></span><span class="line"><span class="ln">16</span><span class="cl">;; Query time: 16 msec
</span></span><span class="line"><span class="ln">17</span><span class="cl">;; SERVER: 8.8.8.8#53(8.8.8.8) (TCP)
</span></span><span class="line"><span class="ln">18</span><span class="cl">;; WHEN: Sat Aug 30 16:22:17 MDT 2025
</span></span><span class="line"><span class="ln">19</span><span class="cl">;; MSG SIZE  rcvd: 479</span></span></code></pre></div>]]></content:encoded>
    </item>
    <item>
      <title>Mentee Lab</title>
      <link>https://masontuckett.xyz/posts/mentee-lab/</link>
      <pubDate>Sat, 12 Jul 2025 21:50:48 -0600</pubDate><author>mason@tuckett.xyz (Mason Tuckett)</author>
      <guid>https://masontuckett.xyz/posts/mentee-lab/</guid>
      <description>&lt;h2 id=&#34;my-thought-process&#34;&gt;My Thought Process&lt;/h2&gt;&#xA;&lt;p&gt;Following my role as an instructor in the Ken Garff Esports Summer Tech Track—I continued to mentor an &lt;strong&gt;outstanding&lt;/strong&gt; student who showed &lt;strong&gt;exceptional&lt;/strong&gt; curiosity in the cybersecurity field.&lt;/p&gt;&#xA;&lt;p&gt;To further his learning, I designed and implemented a home lab tailored around &lt;em&gt;a loosely inspired real-world enterprise environment.&lt;/em&gt;&lt;/p&gt;&#xA;&lt;h2 id=&#34;network-infrastructure&#34;&gt;Network Infrastructure&lt;/h2&gt;&#xA;&lt;p&gt;&lt;img src=&#34;https://masontuckett.xyz/images/posts/mentee-lab/Smith-Network-Diagram.webp&#34; alt=&#34;Smith’s Home Lab Diagram&#34;&gt;&lt;/p&gt;&#xA;&lt;h3 id=&#34;subnetting&#34;&gt;Subnetting&lt;/h3&gt;&#xA;&lt;p&gt;I chose not to implement a flat /24 network as it is inherently insecure for almost any sort of network—especially for exposed services.&lt;/p&gt;</description>
      <content:encoded><![CDATA[<h2 id="my-thought-process">My Thought Process</h2>
<p>Following my role as an instructor in the Ken Garff Esports Summer Tech Track—I continued to mentor an <strong>outstanding</strong> student who showed <strong>exceptional</strong> curiosity in the cybersecurity field.</p>
<p>To further his learning, I designed and implemented a home lab tailored around <em>a loosely inspired real-world enterprise environment.</em></p>
<h2 id="network-infrastructure">Network Infrastructure</h2>
<p><img src="/images/posts/mentee-lab/Smith-Network-Diagram.webp" alt="Smith’s Home Lab Diagram"></p>
<h3 id="subnetting">Subnetting</h3>
<p>I chose not to implement a flat /24 network as it is inherently insecure for almost any sort of network—especially for exposed services.</p>
<p>I decided to keep subnet assignments tight and centered around a usable pool that heavily prevents lateral movement—ensuring a security-first mindset.</p>
<p>/29 was used for the native VLAN <strong>(VLAN 1)</strong>—primarily due to it being the trusted subnet and making troubleshooting far easier; <em>I thought that it was far more appropriate for his needs.</em></p>
<p><strong>VLAN 2</strong> is on a /30 subnet, which limits potential attack surface, and is solely for the Proxmox management interface.</p>
<p><strong>VLAN 3</strong> needs little to no usable hosts because it is intended only for logging services.</p>
<p><strong>VLAN 4</strong> is for internal use only, firewalled extensively with a restrictive /29 subnet.</p>
<p><strong>VLAN 5</strong> is far more generous with a /27 subnet, which would be best for tightening and expandability.</p>
<p><strong>VLAN 6</strong> is on a /30 subnet—allowing space only for a single instance of Nginx.</p>
<p><strong>VLAN 7</strong> is also on a /30 subnet, intended for a singular Wireguard client.</p>
<p>Segmenting services would&rsquo;ve been best, but again—<em>this setup needs to be accessible for independent troubleshooting.</em></p>
<p>With that in mind, DHCP is enabled on VLAN 1 in case his network configuration interferes with deliverability; <strong>my mentee has three &ldquo;free&rdquo; untagged ports on VLAN 1 for troubleshooting purposes.</strong></p>
<p>My mentee has a keen interest in penetration testing, so I integrated a SOC lab into his home lab for learning purposes.</p>
<p>It is largely entirely virtual (beholden to OPNsense), firewalled, and mapped to <strong>vmbr2</strong>; <em>this VLAN is fully air gapped.</em></p>
<h3 id="network-hardware">Network Hardware</h3>
<p>OPNsense was used as a central router/firewall with extensive ACLs to prevent unnecessary inter-VLAN traffic and exposure.</p>
<p><em>I found it very beginner-friendly while exposing my mentee to real-world toolsets.</em></p>
<p>A simple Netgear gigabit managed switch <strong>(GS308Ev4)</strong> was used to establish trunk ports between OPNsense and his Proxmox &ldquo;outputs.&rdquo;</p>
<p>Three trunk ports were utilized for carrying traffic out of his Proxmox node: an upstream trunk for VLANs <strong>(ibg0)</strong> 1, 2, 3, 5, 6, and 7, and two independent ports <strong>(enp1sfp0 and enp1sfp1)</strong> for VLANs 3, 4 | 5, 6, 7.</p>
<p><em>A dummy <strong>PVID of 4094</strong> was used for untagged traffic on the three trunk ports—limiting potential traffic errors/security risks.</em></p>
<p>Every other port—including the Proxmox management interface—was kept untagged.</p>
<h3 id="virtualization">Virtualization</h3>
<p><strong><em>I cannot state how asinine it is to run everything on bare metal</em></strong>—a mistake I see far too frequently in student-led home labs.</p>
<p>It makes management/expansion an absolute headache and leaves every process on a <em>&ldquo;level playing field&rdquo;</em>—severely increasing potential attack surface.</p>
<p>With that in mind, I opted for <a href="https://www.proxmox.com/en/products/proxmox-virtual-environment/overview">Proxmox</a>, an open-source competitor to VMware&rsquo;s ESXi platform—offering an enterprise experience without VMware&rsquo;s absurd licensing fees.</p>
<p><em>Linux bridges were created to match each trunk port and were tagged appropriately within Proxmox.</em></p>
<h3 id="linux-bridges">Linux Bridges</h3>
<p><img src="/images/posts/mentee-lab/vmbr0.png" alt="Bridge 0 Config"></p>
<p><strong>vmbr0</strong> is native to Proxmox (VLAN 2)—untagged and <em>purposefully <strong>not</strong> VLAN aware</em>.</p>
<p><img src="/images/posts/mentee-lab/vmbr1.png" alt="Bridge 1 Config"></p>
<p><strong>vmbr1</strong> is for logging and SOC infrastructure (VLANs 3 and 4).</p>
<p><img src="/images/posts/mentee-lab/vmbr2.png" alt="Bridge 2 Config"></p>
<p><strong>vmbr2</strong> is intended for self-hosted services, and proxying traffic—safely to his VPS (VLANs 5, 6, and 7).</p>
<h3 id="implementing-virtual-machines">Implementing Virtual Machines</h3>
<p>For most home labs, I would implement a hardened frontend reverse proxy—though for his setup, it&rsquo;s largely unnecessary <em>(for now)</em>.</p>
<p>The lab mostly consists of LXC containers and KVM virtual machines—as most services would be inoperable/inefficient if using Docker containers.</p>
<p>Each machine is manually assigned an IP address to avoid unnecessary DHCP servers running on each VLAN interface.</p>
<p><img src="/images/posts/mentee-lab/example-config.png" alt="Example Networking Config"></p>
<p>VLAN tagging also occurs on each virtual network interface—his PaperMC server, as noted above, is rate limited to avoid exhausting his network; granted his hardware is more than capable, I found it to be highly important.</p>
<h2 id="future-plans">Future Plans</h2>
<p>Eventually, we will tunnel all relevant traffic through a WireGuard server hosted on the cloud so his services are masked.</p>
<h5 id="likely-two-hardened-nginx-reverse-proxies-on-each-endwith-tls-13-termination-on-the-vps"><em>Likely two hardened Nginx reverse proxies on each end—with TLS 1.3 termination on the VPS</em></h5>
<p>For now, the only service that is exposed is his PaperMC instance—though that will likely expand given his needs will increase.</p>
<p>OpenMediaVault will likely remain for internal use only, although Nextcloud may replace that in the future (tunneled); possibly just a basic NFS share.</p>
<h2 id="documentation">Documentation</h2>
<p><em>I want to stress that this was co-designed with my mentee, and he was actively involved in this process.</em></p>
<h5 id="i-am-extremely-proud-of-his-performance-and-technical-aptitude-in-implementingmaintaining-this-home-lab"><em>I am extremely proud of his performance and technical aptitude in implementing/maintaining this home lab.</em></h5>
<p>Extensive documentation, including interface configs, switch configs, ACLs, and Proxmox scripts/configs, may be found <a href="https://github.com/masontuckett/Smith-Home-Lab">here</a> or at <a href="https://smithbarlow.xyz">smithbarlow.xyz</a>.</p>
<h2 id="update-82525">UPDATE (8/25/25)</h2>
<p>While we were setting up the remainder of the lab, we opted to use a reverse SSH tunnel for proxying his services to the web.</p>
<p>I am delighted to announce that WireGuard has finally been implemented (non-standard port)—utilizing Nginx&rsquo;s stream module to proxy traffic from the tunnel.</p>
<p><img src="/images/posts/mentee-lab/wg.png" alt="WireGuard Server VPS"></p>
<p><img src="/images/posts/mentee-lab/nginx.png" alt="Nginx Stream Config"></p>
<p>I intentionally chose not to use a Minecraft focused reverse proxy, as we plan on implementing an additional IP address to essentially <em>lock</em> the service to <strong>mc.smithbarlow.xyz</strong>—<em>avoiding a bloated setup</em>.</p>
<p>The PaperMC server operates with a <strong>whitelist</strong>, and server status <strong>OFF</strong>—for both game security, and to lessen <em>some</em> automated scanning (Shodan/MCStatus).</p>
<p>Otherwise, we kept Minecraft on its default port so players could easily connect.</p>
<h3 id="verification">Verification</h3>





<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-sh" data-lang="sh"><span class="line"><span class="ln">1</span><span class="cl"><span class="c1"># Quick Netcat Scan (May Be Periodically Down)</span>
</span></span><span class="line"><span class="ln">2</span><span class="cl">nc -vz smithbarlow.net <span class="m">25565</span></span></span></code></pre></div><h2 id="update-90825">UPDATE (9/08/25)</h2>
<p>This project has been archived for now.</p>
<h2 id="update-102425">UPDATE (10/24/25)</h2>
<p>This project is finally back up; school was interfering with his workflow.</p>
<p>Additionally, we moved to a new domain due to an absurd hijacking fiasco.</p>
<p>Wherein, I accidentally left the Vultr name servers set on the registrar despite deleting Vultr&rsquo;s zone (HUGE MISTAKE!).</p>
<p><em>(Hence the abrupt transition to a <strong>new domain: <a href="https://smithbarlow.net">smithbarlow.net</a></strong>)</em></p>
<small><i><b>I do not want any abuse attached to Smith's name—especially given the assailant's MX records.</b></i></small>

<p>We also migrated from OMV to a simple Ubuntu NFS setup for more intensive learning purposes; I&rsquo;m not going to let him operate &ldquo;one-click&rdquo; <em>dummy</em> software—<strong>he&rsquo;s smarter than that</strong>.</p>
]]></content:encoded>
    </item>
    <item>
      <title>GNU Privacy Guard</title>
      <link>https://masontuckett.xyz/posts/gpg/</link>
      <pubDate>Thu, 01 May 2025 16:36:37 -0600</pubDate><author>mason@tuckett.xyz (Mason Tuckett)</author>
      <guid>https://masontuckett.xyz/posts/gpg/</guid>
      <description>&lt;p&gt;A Brief Overview of GNU Privacy Guard (GPG)&lt;/p&gt;&#xA;&lt;h2 id=&#34;what-is-gpg&#34;&gt;What is GPG?&lt;/h2&gt;&#xA;&lt;p&gt;&lt;img src=&#34;https://masontuckett.xyz/images/posts/gpg/pgp.svg&#34; alt=&#34;Public Key Encryption Diagram&#34;&gt;&lt;/p&gt;&#xA;&lt;p&gt;GNU Privacy Guard (GPG) is largely a modern replacement—or rather, an extension—of Pretty Good Privacy (PGP), which has been effectively abandoned by Symantec.&lt;/p&gt;&#xA;&lt;p&gt;GPG is a modern implementation of the OpenPGP standard, often utilized on both *nix and Windows systems.&lt;/p&gt;&#xA;&lt;p&gt;Many modern platforms and services are designed to be compatible with both GPG and OpenPGP tools, facilitating secure communication and non-repudiation via cryptographic signatures.&lt;/p&gt;</description>
      <content:encoded><![CDATA[<p>A Brief Overview of GNU Privacy Guard (GPG)</p>
<h2 id="what-is-gpg">What is GPG?</h2>
<p><img src="/images/posts/gpg/pgp.svg" alt="Public Key Encryption Diagram"></p>
<p>GNU Privacy Guard (GPG) is largely a modern replacement—or rather, an extension—of Pretty Good Privacy (PGP), which has been effectively abandoned by Symantec.</p>
<p>GPG is a modern implementation of the OpenPGP standard, often utilized on both *nix and Windows systems.</p>
<p>Many modern platforms and services are designed to be compatible with both GPG and OpenPGP tools, facilitating secure communication and non-repudiation via cryptographic signatures.</p>
<p>One of its most ubiquitous use cases is in <a href="https://wiki.debian.org/SecureApt">*nix package management</a>—leveraging Public Key Infrastructure (PKI) to ensure integrity and authenticity within the package management chain of trust. </p>
<h2 id="generating-keys">Generating Keys</h2>





<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="ln">1</span><span class="cl">gpg --full-generate-key</span></span></code></pre></div><p>After initializing key generation, you&rsquo;ll be prompted with a menu like this.</p>





<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="ln">1</span><span class="cl">Please <span class="k">select</span> what kind of key you want:
</span></span><span class="line"><span class="ln">2</span><span class="cl">   <span class="o">(</span>1<span class="o">)</span> RSA and RSA
</span></span><span class="line"><span class="ln">3</span><span class="cl">   <span class="o">(</span>2<span class="o">)</span> DSA and Elgamal
</span></span><span class="line"><span class="ln">4</span><span class="cl">   <span class="o">(</span>3<span class="o">)</span> DSA <span class="o">(</span>sign only<span class="o">)</span>
</span></span><span class="line"><span class="ln">5</span><span class="cl">   <span class="o">(</span>4<span class="o">)</span> RSA <span class="o">(</span>sign only<span class="o">)</span>
</span></span><span class="line"><span class="ln">6</span><span class="cl">   <span class="o">(</span>9<span class="o">)</span> ECC <span class="o">(</span>sign and encrypt<span class="o">)</span> *default*
</span></span><span class="line"><span class="ln">7</span><span class="cl">  <span class="o">(</span>10<span class="o">)</span> ECC <span class="o">(</span>sign only<span class="o">)</span>
</span></span><span class="line"><span class="ln">8</span><span class="cl">  <span class="o">(</span>14<span class="o">)</span> Existing key from card
</span></span><span class="line"><span class="ln">9</span><span class="cl">Your selection? </span></span></code></pre></div><p>Choose <strong>(9)</strong> — this creates an Elliptic Curve Cryptography (ECC) key pair, which is far more modern and efficient compared to RSA.</p>
<p>Generally speaking, ECC keys are considered more secure per bit <a href="https://sslinsights.com/ecc-vs-rsa/">compared to RSA keys</a>—offering equivalent security while being far faster/portable.</p>





<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="ln">1</span><span class="cl">Please <span class="k">select</span> which elliptic curve you want:
</span></span><span class="line"><span class="ln">2</span><span class="cl">   <span class="o">(</span>1<span class="o">)</span> Curve <span class="m">25519</span> *default*
</span></span><span class="line"><span class="ln">3</span><span class="cl">   <span class="o">(</span>4<span class="o">)</span> NIST P-384
</span></span><span class="line"><span class="ln">4</span><span class="cl">   <span class="o">(</span>6<span class="o">)</span> Brainpool P-256</span></span></code></pre></div><p>Choose <strong>(1)</strong> — ED25519 is a sane default and is widely adopted.</p>





<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="ln">1</span><span class="cl">Please specify how long the key should be valid.
</span></span><span class="line"><span class="ln">2</span><span class="cl">         <span class="nv">0</span> <span class="o">=</span> key does not expire
</span></span><span class="line"><span class="ln">3</span><span class="cl">      &lt;n&gt;  <span class="o">=</span> key expires in n days
</span></span><span class="line"><span class="ln">4</span><span class="cl">      &lt;n&gt;w <span class="o">=</span> key expires in n weeks
</span></span><span class="line"><span class="ln">5</span><span class="cl">      &lt;n&gt;m <span class="o">=</span> key expires in n months
</span></span><span class="line"><span class="ln">6</span><span class="cl">      &lt;n&gt;y <span class="o">=</span> key expires in n years</span></span></code></pre></div><p>Choose at your discretion—though it would be wise to periodically rotate keys.</p>
<p>For all intents and purposes, <strong>(0)</strong> is fine.</p>





<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="ln">1</span><span class="cl">GnuPG needs to construct a user ID to identify your key.
</span></span><span class="line"><span class="ln">2</span><span class="cl">
</span></span><span class="line"><span class="ln">3</span><span class="cl">Real name: Mason Tuckett
</span></span><span class="line"><span class="ln">4</span><span class="cl">Email address: mason@tuckett.xyz
</span></span><span class="line"><span class="ln">5</span><span class="cl">Comment: <span class="nb">test</span> key
</span></span><span class="line"><span class="ln">6</span><span class="cl">You selected this USER-ID:
</span></span><span class="line"><span class="ln">7</span><span class="cl">    <span class="s2">&#34;Mason Tuckett (test key) &lt;mason@tuckett.xyz&gt;&#34;</span></span></span></code></pre></div><p>Enter any information that you may find relevant.</p>
<p>Make sure to select a strong, alphanumeric password that includes symbols—preferably over twelve characters long.</p>





<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="ln">1</span><span class="cl">public and secret key created and signed.
</span></span><span class="line"><span class="ln">2</span><span class="cl">
</span></span><span class="line"><span class="ln">3</span><span class="cl">pub   ed25519 2025-05-02 <span class="o">[</span>SC<span class="o">]</span>
</span></span><span class="line"><span class="ln">4</span><span class="cl">      07B41B22F08862AC61F1DB5E462E05498C4C7F06
</span></span><span class="line"><span class="ln">5</span><span class="cl">uid                      Mason Tuckett <span class="o">(</span><span class="nb">test</span> key<span class="o">)</span> &lt;mason@tuckett.xyz&gt;
</span></span><span class="line"><span class="ln">6</span><span class="cl">sub   cv25519 2025-05-02 <span class="o">[</span>E<span class="o">]</span></span></span></code></pre></div><p><em>You should see an output similar to this.</em></p>
<p><strong>Now we can move on to managing our key pair!</strong></p>
<h2 id="managing-keys">Managing Keys</h2>
<p>Once you&rsquo;ve generated your GPG key, you&rsquo;ll need to share your public key so others may verify your digital signature and send you encrypted messages.</p>





<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="ln">1</span><span class="cl">gpg --fingerprint
</span></span><span class="line"><span class="ln">2</span><span class="cl">
</span></span><span class="line"><span class="ln">3</span><span class="cl">pub   ed25519 2025-05-02 <span class="o">[</span>SC<span class="o">]</span>
</span></span><span class="line"><span class="ln">4</span><span class="cl">      07B4 1B22 F088 62AC 61F1  DB5E 462E <span class="m">0549</span> 8C4C 7F06 <span class="c1"># Fingerprint</span>
</span></span><span class="line"><span class="ln">5</span><span class="cl">uid           <span class="o">[</span>ultimate<span class="o">]</span> Mason Tuckett <span class="o">(</span><span class="nb">test</span> key<span class="o">)</span> &lt;mason@tuckett.xyz&gt;
</span></span><span class="line"><span class="ln">6</span><span class="cl">sub   cv25519 2025-05-02 <span class="o">[</span>E<span class="o">]</span></span></span></code></pre></div><p>Identifying your fingerprint is crucial for verifying the authenticity of your key; it is essentially a summary of your key pair.</p>
<p>Providing a fingerprint <strong>(07B41B22F08862AC61F1DB5E462E05498C4C7F06)</strong> prevents impersonation—which is commonly utilized for man-in-the-middle attacks.</p>
<p><em>Make sure to provide this when sharing your key.</em></p>
<h3 id="exporting-keys">Exporting Keys</h3>
<p>To share your key with others, it is necessary to properly export your public key.</p>
<p>It&rsquo;s best to use the <em>--armor (ASCII)</em> option for portability, as it makes everything readable and compatible across all platforms.</p>





<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="ln"> 1</span><span class="cl"><span class="c1"># Export the public key</span>
</span></span><span class="line"><span class="ln"> 2</span><span class="cl">gpg --armor --export 07B41B22F08862AC61F1DB5E462E05498C4C7F06 &gt; pubkey.gpg
</span></span><span class="line"><span class="ln"> 3</span><span class="cl">
</span></span><span class="line"><span class="ln"> 4</span><span class="cl"><span class="c1"># Verify the public key</span>
</span></span><span class="line"><span class="ln"> 5</span><span class="cl">cat pubkey.gpg
</span></span><span class="line"><span class="ln"> 6</span><span class="cl">-----BEGIN PGP PUBLIC KEY BLOCK-----
</span></span><span class="line"><span class="ln"> 7</span><span class="cl">
</span></span><span class="line"><span class="ln"> 8</span><span class="cl">mDMEaBQztBYJKwYBBAHaRw8BAQdAoXjOBHJ2kHnL6zFhCEdsPfncq0CMSxdDLY6x
</span></span><span class="line"><span class="ln"> 9</span><span class="cl">IYEss0a0LE1hc29uIFR1Y2tldHQgKHRlc3Qga2V5KSA8bWFzb25AdHVja2V0dC54
</span></span><span class="line"><span class="ln">10</span><span class="cl">eXo+iJMEExYKADsWIQQHtBsi8IhirGHx215GLgVJjEx/BgUCaBQztAIbAwULCQgH
</span></span><span class="line"><span class="ln">11</span><span class="cl">AgIiAgYVCgkICwIEFgIDAQIeBwIXgAAKCRBGLgVJjEx/BpgOAP0YS5iS0FXf9hL+
</span></span><span class="line"><span class="ln">12</span><span class="cl">yysPOAdcw2itZQKemWnMwxl/4FnapwD+Pzrz9ElopvfmsE2hvqwD+STh77yDvzaw
</span></span><span class="line"><span class="ln">13</span><span class="cl">dIQOXiYDTwa4OARoFDO0EgorBgEEAZdVAQUBAQdAlceTsCOfM+wEp/5xI0JG+ge5
</span></span><span class="line"><span class="ln">14</span><span class="cl">nUhgSQhKgkLipF8AJjEDAQgHiHgEGBYKACAWIQQHtBsi8IhirGHx215GLgVJjEx/
</span></span><span class="line"><span class="ln">15</span><span class="cl">BgUCaBQztAIbDAAKCRBGLgVJjEx/BszKAPoDV+OUtoPQITfgjCOdsjbyL4NXONJx
</span></span><span class="line"><span class="ln">16</span><span class="cl">0i5RdBLmpFD3hwD+MtRJ8tpnG+w2OoGll1Vdl+xzP9o18w92rsSptL3x3ww<span class="o">=</span>
</span></span><span class="line"><span class="ln">17</span><span class="cl"><span class="o">=</span>1K3m
</span></span><span class="line"><span class="ln">18</span><span class="cl">-----END PGP PUBLIC KEY BLOCK-----</span></span></code></pre></div><p>Once you have exported your public key, it is advisable to make backups of your private key.</p>





<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="ln"> 1</span><span class="cl"><span class="c1"># Export the private key (BACKUP PURPOSES ONLY — NEVER SHARE THIS!!!)</span>
</span></span><span class="line"><span class="ln"> 2</span><span class="cl">gpg --armor --export-secret-keys 07B41B22F08862AC61F1DB5E462E05498C4C7F06 &gt; privatekey.gpg
</span></span><span class="line"><span class="ln"> 3</span><span class="cl">
</span></span><span class="line"><span class="ln"> 4</span><span class="cl"><span class="c1"># Verify the private key</span>
</span></span><span class="line"><span class="ln"> 5</span><span class="cl">cat privatekey.gpg
</span></span><span class="line"><span class="ln"> 6</span><span class="cl">-----BEGIN PGP PRIVATE KEY BLOCK-----
</span></span><span class="line"><span class="ln"> 7</span><span class="cl">
</span></span><span class="line"><span class="ln"> 8</span><span class="cl">     !!! DO NOT SHARE THIS !!!
</span></span><span class="line"><span class="ln"> 9</span><span class="cl">
</span></span><span class="line"><span class="ln">10</span><span class="cl">-----END PGP PRIVATE KEY BLOCK-----</span></span></code></pre></div><p>It&rsquo;s best to utilize the fingerprint when exporting keys, especially if you have multiple keys tied to the same email address; <em>this ensures you are exporting the correct key.</em></p>
<p>Naturally, you will be sharing your public key quite frequently—but <strong>NEVER SHARE YOUR PRIVATE KEY!</strong></p>
<p>Public keys are safe to distribute, but private keys should remain <strong>PRIVATE</strong>.</p>
<p>Private keys are really only functionally used for decryption, and making backups ensures that you have redundancy; only do this when transferring or restoring keys.</p>
<h3 id="importing-keys">Importing Keys</h3>
<p>Typically, you will only import a recipient&rsquo;s public key—but you may also need to import redundant copies of private keys.</p>





<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="ln"> 1</span><span class="cl"><span class="c1"># Public key</span>
</span></span><span class="line"><span class="ln"> 2</span><span class="cl">gpg --import pubkey.gpg
</span></span><span class="line"><span class="ln"> 3</span><span class="cl">
</span></span><span class="line"><span class="ln"> 4</span><span class="cl"><span class="c1">#Private key</span>
</span></span><span class="line"><span class="ln"> 5</span><span class="cl">gpg --import privatekey.gpg
</span></span><span class="line"><span class="ln"> 6</span><span class="cl">
</span></span><span class="line"><span class="ln"> 7</span><span class="cl"><span class="c1"># Check signatures</span>
</span></span><span class="line"><span class="ln"> 8</span><span class="cl">gpg --check-sigs 07B41B22F08862AC61F1DB5E462E05498C4C7F06
</span></span><span class="line"><span class="ln"> 9</span><span class="cl">ub   ed25519 2025-05-02 <span class="o">[</span>SC<span class="o">]</span> 
</span></span><span class="line"><span class="ln">10</span><span class="cl">      07B41B22F08862AC61F1DB5E462E05498C4C7F06
</span></span><span class="line"><span class="ln">11</span><span class="cl">uid           <span class="o">[</span>ultimate<span class="o">]</span> Mason Tuckett <span class="o">(</span><span class="nb">test</span> key<span class="o">)</span> &lt;mason@tuckett.xyz&gt;
</span></span><span class="line"><span class="ln">12</span><span class="cl">sig!3        462E05498C4C7F06 2025-05-02  <span class="o">[</span>self-signature<span class="o">]</span>
</span></span><span class="line"><span class="ln">13</span><span class="cl">sub   cv25519 2025-05-02 <span class="o">[</span>E<span class="o">]</span>
</span></span><span class="line"><span class="ln">14</span><span class="cl">sig!         462E05498C4C7F06 2025-05-02  <span class="o">[</span>self-signature<span class="o">]</span>
</span></span><span class="line"><span class="ln">15</span><span class="cl">
</span></span><span class="line"><span class="ln">16</span><span class="cl">gpg: <span class="m">2</span> good signatures
</span></span><span class="line"><span class="ln">17</span><span class="cl">
</span></span><span class="line"><span class="ln">18</span><span class="cl"><span class="c1"># Trust the key</span>
</span></span><span class="line"><span class="ln">19</span><span class="cl">gpg --edit-key 07B41B22F08862AC61F1DB5E462E05498C4C7F06
</span></span><span class="line"><span class="ln">20</span><span class="cl">Secret key is available.
</span></span><span class="line"><span class="ln">21</span><span class="cl">
</span></span><span class="line"><span class="ln">22</span><span class="cl">sec  ed25519/462E05498C4C7F06
</span></span><span class="line"><span class="ln">23</span><span class="cl">     created: 2025-05-02  expires: never       usage: SC  
</span></span><span class="line"><span class="ln">24</span><span class="cl">     trust: unknown       validity: unknown
</span></span><span class="line"><span class="ln">25</span><span class="cl">ssb  cv25519/BCA683EF83020019
</span></span><span class="line"><span class="ln">26</span><span class="cl">     created: 2025-05-02  expires: never       usage: E   
</span></span><span class="line"><span class="ln">27</span><span class="cl"><span class="o">[</span> unknown<span class="o">]</span> <span class="o">(</span>1<span class="o">)</span>. Mason Tuckett <span class="o">(</span><span class="nb">test</span> key<span class="o">)</span> &lt;mason@tuckett.xyz&gt;
</span></span><span class="line"><span class="ln">28</span><span class="cl">
</span></span><span class="line"><span class="ln">29</span><span class="cl">gpg&gt; trust</span></span></code></pre></div><p><em><strong>Make sure to be mindful when discerning your level of trust.</strong></em></p>
<blockquote>
<p>1 = I don&rsquo;t know or won&rsquo;t say<br>
2 = I do NOT trust<br>
3 = I trust marginally<br>
4 = I trust fully<br>
5 = I trust ultimately</p>
</blockquote>
<h3 id="deleting-keys">Deleting Keys</h3>
<p>When deleting keys, it is incredibly important to make sure you are deleting the correct keys.</p>
<p>If you are deleting a key pair, the private key will need to be deleted first.</p>





<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="ln"> 1</span><span class="cl"><span class="c1">#Private key</span>
</span></span><span class="line"><span class="ln"> 2</span><span class="cl">gpg --delete-secret-key 07B41B22F08862AC61F1DB5E462E05498C4C7F06
</span></span><span class="line"><span class="ln"> 3</span><span class="cl">sec  ed25519/462E05498C4C7F06 2025-05-02 Mason Tuckett <span class="o">(</span><span class="nb">test</span> key<span class="o">)</span> &lt;mason@tuckett.xyz&gt;
</span></span><span class="line"><span class="ln"> 4</span><span class="cl">
</span></span><span class="line"><span class="ln"> 5</span><span class="cl">Delete this key from the keyring? <span class="o">(</span>y/N<span class="o">)</span> y
</span></span><span class="line"><span class="ln"> 6</span><span class="cl">This is a secret key! - really delete? <span class="o">(</span>y/N<span class="o">)</span> y
</span></span><span class="line"><span class="ln"> 7</span><span class="cl">
</span></span><span class="line"><span class="ln"> 8</span><span class="cl"><span class="c1"># Public key</span>
</span></span><span class="line"><span class="ln"> 9</span><span class="cl">gpg --delete-key 07B41B22F08862AC61F1DB5E462E05498C4C7F06
</span></span><span class="line"><span class="ln">10</span><span class="cl">pub  ed25519/462E05498C4C7F06 2025-05-02 Mason Tuckett <span class="o">(</span><span class="nb">test</span> key<span class="o">)</span> &lt;mason@tuckett.xyz&gt;
</span></span><span class="line"><span class="ln">11</span><span class="cl">
</span></span><span class="line"><span class="ln">12</span><span class="cl">Delete this key from the keyring? <span class="o">(</span>y/N<span class="o">)</span> y</span></span></code></pre></div><h2 id="signing-with-gpg">Signing with GPG</h2>
<p>Signing files or messages is incredibly straightforward—just make sure to use the correct private key.</p>
<p>Detached signatures are preferable as both files are compared against one another, unlike a single <em>attached</em> signature.</p>





<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="ln"> 1</span><span class="cl"><span class="c1"># Detached signature</span>
</span></span><span class="line"><span class="ln"> 2</span><span class="cl"><span class="nb">echo</span> <span class="s2">&#34;msg&#34;</span> &gt; msg
</span></span><span class="line"><span class="ln"> 3</span><span class="cl">gpg --armor --default-key 07B41B22F08862AC61F1DB5E462E05498C4C7F06 --detach-sign msg
</span></span><span class="line"><span class="ln"> 4</span><span class="cl">
</span></span><span class="line"><span class="ln"> 5</span><span class="cl"><span class="c1"># Verify the signature</span>
</span></span><span class="line"><span class="ln"> 6</span><span class="cl">gpg --verify msg.asc msg
</span></span><span class="line"><span class="ln"> 7</span><span class="cl">gpg: Signature made Fri <span class="m">02</span> May <span class="m">2025</span> 12:00:19 AM MDT
</span></span><span class="line"><span class="ln"> 8</span><span class="cl">gpg:                using EDDSA key 07B41B22F08862AC61F1DB5E462E05498C4C7F06
</span></span><span class="line"><span class="ln"> 9</span><span class="cl">gpg: Good signature from <span class="s2">&#34;Mason Tuckett (test key) &lt;mason@tuckett.xyz&gt;&#34;</span> <span class="o">[</span>ultimate<span class="o">]</span>
</span></span><span class="line"><span class="ln">10</span><span class="cl">
</span></span><span class="line"><span class="ln">11</span><span class="cl">cat msg.asc
</span></span><span class="line"><span class="ln">12</span><span class="cl">-----BEGIN PGP SIGNATURE-----
</span></span><span class="line"><span class="ln">13</span><span class="cl">
</span></span><span class="line"><span class="ln">14</span><span class="cl">iHQEABYKAB0WIQQHtBsi8IhirGHx215GLgVJjEx/BgUCaBRfcwAKCRBGLgVJjEx/
</span></span><span class="line"><span class="ln">15</span><span class="cl">Bg4aAPwJirjRBeacdjKTv0oyha0fGl69ZTR0LqgrLQKLMCy5XQD4jiW5gy8XhpzO
</span></span><span class="line"><span class="ln">16</span><span class="cl"><span class="nv">VpcOptcsNNtqfovoNNoE6tFahdZ0Dg</span><span class="o">==</span>
</span></span><span class="line"><span class="ln">17</span><span class="cl"><span class="o">=</span>Ge5O
</span></span><span class="line"><span class="ln">18</span><span class="cl">-----END PGP SIGNATURE-----</span></span></code></pre></div><h2 id="encrypting-with-gpg">Encrypting with GPG</h2>
<p>Files and messages can be encrypted using the recipient&rsquo;s public key.</p>
<p>By design, no intermediary can decrypt the file or message without the recipient&rsquo;s private key.</p>
<p>Therefore, that is why you must exchange keys beforehand; otherwise, the data would effectively be unrecoverable.</p>





<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="ln"> 1</span><span class="cl"><span class="c1"># Encrypt a file</span>
</span></span><span class="line"><span class="ln"> 2</span><span class="cl"><span class="nb">echo</span> <span class="s2">&#34;file&#34;</span> &gt; file
</span></span><span class="line"><span class="ln"> 3</span><span class="cl">gpg --armor --encrypt --recipient recipient@mail.com file
</span></span><span class="line"><span class="ln"> 4</span><span class="cl">
</span></span><span class="line"><span class="ln"> 5</span><span class="cl">cat file.asc
</span></span><span class="line"><span class="ln"> 6</span><span class="cl">-----BEGIN PGP MESSAGE-----
</span></span><span class="line"><span class="ln"> 7</span><span class="cl">
</span></span><span class="line"><span class="ln"> 8</span><span class="cl">hF4DmGWaJPMsGZ4SAQdAt6v31fJBwhecUZHqOrXfoPjEXWY8yjXeMV0GIuPAHSYw
</span></span><span class="line"><span class="ln"> 9</span><span class="cl">SHf4TJGAcuGF7t35EsRD7TeIPRH7v/AniwonsjXJJwyHAaLEMtq/KU/u3D63j3F2
</span></span><span class="line"><span class="ln">10</span><span class="cl">1EwBCQIQjuprIiTotwqwJYjpKBrQhC8DyC1DTZLZwlM2zmB59TAQeyuPviR8KMcy
</span></span><span class="line"><span class="ln">11</span><span class="cl"><span class="nv">4JoxPuR3tsOUOQAnvDZjojtFjtkiWC4a3fqMWU85</span>
</span></span><span class="line"><span class="ln">12</span><span class="cl"><span class="o">=</span>Th91
</span></span><span class="line"><span class="ln">13</span><span class="cl">-----END PGP MESSAGE-----
</span></span><span class="line"><span class="ln">14</span><span class="cl">
</span></span><span class="line"><span class="ln">15</span><span class="cl"><span class="c1"># Decrypt the file (recipient&#39;s private key)</span>
</span></span><span class="line"><span class="ln">16</span><span class="cl">gpg --decrypt file.asc
</span></span><span class="line"><span class="ln">17</span><span class="cl">gpg: encrypted with cv25519 key, ID 98659A24F32C199E, created 2025-05-02
</span></span><span class="line"><span class="ln">18</span><span class="cl">      <span class="s2">&#34;recipient (test) &lt;recipient@mail.com&gt;&#34;</span>
</span></span><span class="line"><span class="ln">19</span><span class="cl">file</span></span></code></pre></div><h2 id="closing">Closing</h2>
<p>GPG is an essential tool for anyone looking to ensure both integrity and authenticity by adding a secure layer to digital communication.</p>
<p>GPG or OpenPGP tools are useful for establishing chains of trust and for preventing man-in-the-middle attacks—limiting access to sensitive information.</p>
<p>It is a fantastic idea to communicate via GPG-encrypted messages or files, which many privacy-conscious providers like <a href="https://proton.me/support/how-to-use-pgp">Proton Mail</a> natively support.</p>
<p>Remember to always use encryption when necessary, even if it may not appear convenient at first; <em>you are in control of your data</em>.</p>
<p><em><strong>Encrypt away!</strong></em></p>
]]></content:encoded>
    </item>
    <item>
      <title>Librebooting a Thinkpad T440p</title>
      <link>https://masontuckett.xyz/posts/t440p-libreboot/</link>
      <pubDate>Thu, 13 Mar 2025 00:38:44 -0700</pubDate><author>mason@tuckett.xyz (Mason Tuckett)</author>
      <guid>https://masontuckett.xyz/posts/t440p-libreboot/</guid>
      <description>&lt;p&gt;A Guide for Installing Libreboot on the Lenovo Thinkpad T440p&lt;/p&gt;&#xA;&lt;h2 id=&#34;what-is-libreboot&#34;&gt;What is Libreboot?&lt;/h2&gt;&#xA;&lt;p&gt;Libreboot is a free and open-source replacement for proprietary UEFI/BIOS firmware—neutering invasive technologies like &lt;a href=&#34;https://itsfoss.com/fact-intel-minix-case/&#34;&gt;Intel ME&lt;/a&gt; in the process.&lt;/p&gt;&#xA;&lt;p&gt;The project seeks to remove proprietary &lt;a href=&#34;https://libreboot.org/news/policy.html#what-is-a-binary-blob&#34;&gt;binary blobs&lt;/a&gt; included in firmware (required for key components to function)—providing a privacy-respecting alternative for users.&lt;/p&gt;&#xA;&lt;p&gt;Libreboot is primarily geared towards enthusiasts—though it does have limited hardware support; however, many devices are now compatible.&lt;/p&gt;</description>
      <content:encoded><![CDATA[<p>A Guide for Installing Libreboot on the Lenovo Thinkpad T440p</p>
<h2 id="what-is-libreboot">What is Libreboot?</h2>
<p>Libreboot is a free and open-source replacement for proprietary UEFI/BIOS firmware—neutering invasive technologies like <a href="https://itsfoss.com/fact-intel-minix-case/">Intel ME</a> in the process.</p>
<p>The project seeks to remove proprietary <a href="https://libreboot.org/news/policy.html#what-is-a-binary-blob">binary blobs</a> included in firmware (required for key components to function)—providing a privacy-respecting alternative for users.</p>
<p>Libreboot is primarily geared towards enthusiasts—though it does have limited hardware support; however, many devices are now compatible.</p>
<p><em>Libreboot is a distribution of Coreboot—wherein all updates come from upstream <a href="https://www.coreboot.org/">Coreboot</a> development.</em></p>
<p>Unlike Coreboot, Libreboot is designed to be completely free and open-source, including only essential <a href="https://libreboot.org/news/microcode.html">CPU microcode updates</a>.</p>
<p><em><strong>For more details, visit <a href="https://libreboot.org/">here</a>.</strong></em></p>
<h1 id="installation">Installation</h1>
<h2 id="tools">Tools</h2>
<p>You will need an EEPROM flash programmer.</p>
<p>OR a SOIC/SOP 8 test clip, eight female DuPont wires, and a compatible SBC (such as a Raspberry Pi w GPIO pins).</p>
<h3 id="soic-8-wiring">SOIC 8 Wiring</h3>
<p><img src="/images/posts/t440p-libreboot/wiring.webp" alt="SOIC-8 Wiring"></p>
<h3 id="ch341a-wiring">CH341A Wiring</h3>
<p><img src="/images/posts/t440p-libreboot/ch341a.webp" alt="CH341A Instructions"></p>
<p><em><strong>For my installation, I used the CH341A programmer—though, <a href="https://libreboot.org/docs/install/spi.html#do-not-buy-ch341a">this is not advised</a>.</strong></em></p>
<h2 id="software">Software</h2>
<p>Preferably, you will need a device with Linux installed; if you are using an SBC, install SSH for flashing.</p>
<h3 id="obtaining-build-files">Obtaining Build Files</h3>





<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-sh" data-lang="sh"><span class="line"><span class="ln">1</span><span class="cl"><span class="c1"># Prerequisites</span>
</span></span><span class="line"><span class="ln">2</span><span class="cl">sudo apt install -y git wget build-essential
</span></span><span class="line"><span class="ln">3</span><span class="cl">
</span></span><span class="line"><span class="ln">4</span><span class="cl"><span class="c1"># Obtain Libreboot&#39;s build system</span>
</span></span><span class="line"><span class="ln">5</span><span class="cl">git clone https://codeberg.org/libreboot/lbmk ~/lbmk
</span></span><span class="line"><span class="ln">6</span><span class="cl"><span class="nb">cd</span> ~/lbmk
</span></span><span class="line"><span class="ln">7</span><span class="cl">
</span></span><span class="line"><span class="ln">8</span><span class="cl"><span class="c1"># Obtain Libreboot T440p image</span>
</span></span><span class="line"><span class="ln">9</span><span class="cl">wget https://mirror.math.princeton.edu/pub/libreboot/stable/20241206/roms/libreboot-20241206rev10_t440plibremrc_12mb.tar.xz</span></span></code></pre></div><h3 id="making-the-libreboot-build-system">Making the Libreboot Build System</h3>





<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-sh" data-lang="sh"><span class="line"><span class="ln">1</span><span class="cl"><span class="c1"># Set available threads for faster compilation</span>
</span></span><span class="line"><span class="ln">2</span><span class="cl"><span class="nb">export</span> <span class="nv">XBMK_THREADS</span><span class="o">=</span><span class="m">12</span>
</span></span><span class="line"><span class="ln">3</span><span class="cl">
</span></span><span class="line"><span class="ln">4</span><span class="cl"><span class="c1"># Set your distro and build necessary dependencies</span>
</span></span><span class="line"><span class="ln">5</span><span class="cl">sudo ./mk dependencies mint
</span></span><span class="line"><span class="ln">6</span><span class="cl">
</span></span><span class="line"><span class="ln">7</span><span class="cl"><span class="c1"># Build flashprog</span>
</span></span><span class="line"><span class="ln">8</span><span class="cl">./mk -b flashprog
</span></span><span class="line"><span class="ln">9</span><span class="cl">mv ~/lbmk/elf/flashprog/flashprog ../..</span></span></code></pre></div><h3 id="preparing-images">Preparing Images</h3>





<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-sh" data-lang="sh"><span class="line"><span class="ln"> 1</span><span class="cl"><span class="c1"># Inject necessary vendor files</span>
</span></span><span class="line"><span class="ln"> 2</span><span class="cl">./mk inject libreboot-20241206rev10_t440plibremrc_12mb.tar.xz
</span></span><span class="line"><span class="ln"> 3</span><span class="cl">
</span></span><span class="line"><span class="ln"> 4</span><span class="cl"><span class="c1"># Unpack the injected image</span>
</span></span><span class="line"><span class="ln"> 5</span><span class="cl">tar -xvf libreboot-20241206rev10_t440plibremrc_12mb.tar.xz
</span></span><span class="line"><span class="ln"> 6</span><span class="cl">
</span></span><span class="line"><span class="ln"> 7</span><span class="cl"><span class="c1"># Split the top ROM (4MB)</span>
</span></span><span class="line"><span class="ln"> 8</span><span class="cl">dd <span class="k">if</span><span class="o">=</span>~/lbmk/bin/t440plibremrc_12mb/seagrub_t440plibremrc_12mb_libgfxinit_corebootfb_usqwerty.rom <span class="nv">of</span><span class="o">=</span>top.rom <span class="nv">bs</span><span class="o">=</span>1M <span class="nv">skip</span><span class="o">=</span><span class="m">8</span>
</span></span><span class="line"><span class="ln"> 9</span><span class="cl">
</span></span><span class="line"><span class="ln">10</span><span class="cl"><span class="c1"># Split the bottom ROM (8MB)</span>
</span></span><span class="line"><span class="ln">11</span><span class="cl">dd <span class="k">if</span><span class="o">=</span>~/lbmk/bin/t440plibremrc_12mb/seagrub_t440plibremrc_12mb_libgfxinit_corebootfb_usqwerty.rom <span class="nv">of</span><span class="o">=</span>bot.rom <span class="nv">bs</span><span class="o">=</span>1M <span class="nv">count</span><span class="o">=</span><span class="m">8</span></span></span></code></pre></div><h3 id="disassembling-the-laptop">Disassembling the Laptop</h3>
<p>Refer to <a href="https://www.myfixguide.com/manual/lenovo-thinkpad-t440-disassembly/">this guide</a> for disassembling the laptop; make sure both the main battery and CMOS battery are unplugged.</p>
<p><img src="/images/posts/t440p-libreboot/t440p-chips.webp" alt="T440p top (4MB) and bottom (8MB) ROM locations"></p>
<h3 id="backing-up-stock-roms">Backing Up Stock ROMs</h3>
<p><img src="/images/posts/t440p-libreboot/connected.webp" alt="CH341A reading ROMs"></p>
<p><em><strong>Your setup will look different; my casing was fused together, so I had to improvise.</strong></em></p>





<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-sh" data-lang="sh"><span class="line"><span class="ln"> 1</span><span class="cl"><span class="c1"># Backup top stock ROMs</span>
</span></span><span class="line"><span class="ln"> 2</span><span class="cl">sudo ./flashprog --programmer ch341a_spi -c W25Q32FV -r top-stock-bk.rom
</span></span><span class="line"><span class="ln"> 3</span><span class="cl">sudo ./flashprog --programmer ch341a_spi -c W25Q32FV -r top-stock-bk2.rom
</span></span><span class="line"><span class="ln"> 4</span><span class="cl">
</span></span><span class="line"><span class="ln"> 5</span><span class="cl"><span class="c1"># Backup bottom stock ROMs</span>
</span></span><span class="line"><span class="ln"> 6</span><span class="cl">sudo ./flashprog --programmer ch341a_spi -c W25Q64BV/W25Q64CV/W25Q64FV -r bot-stock-bk.rom
</span></span><span class="line"><span class="ln"> 7</span><span class="cl">sudo ./flashprog --programmer ch341a_spi -c W25Q64BV/W25Q64CV/W25Q64FV -r bot-stock-bk2.rom
</span></span><span class="line"><span class="ln"> 8</span><span class="cl">
</span></span><span class="line"><span class="ln"> 9</span><span class="cl"><span class="c1"># Verify ROMs were dumped correctly</span>
</span></span><span class="line"><span class="ln">10</span><span class="cl">sha512sum top-stock* bot-stock*</span></span></code></pre></div><h3 id="flashing-libreboot-images">Flashing Libreboot Images</h3>





<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-sh" data-lang="sh"><span class="line"><span class="ln">1</span><span class="cl"><span class="c1"># Write the top ROM</span>
</span></span><span class="line"><span class="ln">2</span><span class="cl">sudo ./flashprog --programmer ch341a_spi -c W25Q32FV -w ~/lbmk/top.rom
</span></span><span class="line"><span class="ln">3</span><span class="cl">
</span></span><span class="line"><span class="ln">4</span><span class="cl"><span class="c1"># Write the bottom ROM</span>
</span></span><span class="line"><span class="ln">5</span><span class="cl">sudo ./flashprog --programmer ch341a_spi -c W25Q64BV/W25Q64CV/W25Q64FV -w ~/lbmk/bot.rom</span></span></code></pre></div><p><em><strong>Reassemble the unit—and voilà! Your laptop now sports Libreboot!</strong></em></p>
<p><img src="/images/posts/t440p-libreboot/libreboot-installed.webp" alt="Libreboot successfully Installed - (Lenovo Thinkpad T440p)"></p>
]]></content:encoded>
    </item>
    <item>
      <title>Hugo</title>
      <link>https://masontuckett.xyz/posts/hugo/</link>
      <pubDate>Mon, 10 Mar 2025 00:38:44 -0700</pubDate><author>mason@tuckett.xyz (Mason Tuckett)</author>
      <guid>https://masontuckett.xyz/posts/hugo/</guid>
      <description>&lt;p&gt;For my personal website, I opted to use a static site generator.&lt;/p&gt;&#xA;&lt;p&gt;Not only would this allow me to automate content creation—it avoids the needless clunkiness of content management systems such as WordPress.&lt;/p&gt;&#xA;&lt;p&gt;For the modern web, it makes no sense to implement a &lt;em&gt;largely static blog&lt;/em&gt; through a content management system; it unnecessarily increases your &lt;a href=&#34;https://www.cvedetails.com/product/4096/Wordpress-Wordpress.html?vendor_id=2337_&#34;&gt;attack surface&lt;/a&gt;.&lt;/p&gt;&#xA;&lt;p&gt;That being said, there are a plethora of static site generators and frameworks available—but many ultimately defeat the purpose of a true static site generator.&lt;/p&gt;</description>
      <content:encoded><![CDATA[<p>For my personal website, I opted to use a static site generator.</p>
<p>Not only would this allow me to automate content creation—it avoids the needless clunkiness of content management systems such as WordPress.</p>
<p>For the modern web, it makes no sense to implement a <em>largely static blog</em> through a content management system; it unnecessarily increases your <a href="https://www.cvedetails.com/product/4096/Wordpress-Wordpress.html?vendor_id=2337_">attack surface</a>.</p>
<p>That being said, there are a plethora of static site generators and frameworks available—but many ultimately defeat the purpose of a true static site generator.</p>
<p>Hugo fit my use case perfectly—boasting incredible flexibility while remaining lightweight and highly straightforward.</p>
<h2 id="what-is-hugo">What is Hugo?</h2>
<p>Hugo is a static site generator written in Go, designed to be both effortlessly hackable and extensive.</p>
<p>Content is written in Markdown and compiled into static HTML files—according to predefined templates/taxonomies.</p>
<p>Hundreds of premade themes are <a href="https://themes.gohugo.io/">readily available</a>—ranging from simple, lightweight blogs to ready-to-deploy e-commerce platforms.</p>
<h2 id="hackability">Hackability</h2>
<p>Hugo operates using a robust template system—streamlining the process of content generation.</p>
<p>Configuration files (YAML, TOML, JSON) are used to configure/manage content and settings—enabling dynamic content generation and layered customization.</p>
<p>Hugo&rsquo;s shortcode system is used in conjunction with its template system, allowing users to create reusable content/functionality within Markdown files.</p>
<p>Shortcodes are by far Hugo&rsquo;s most important feature, supporting in-depth <a href="https://gohugo.io/functions/">dynamic functions</a>—ranging from simplistic individual CSS blocks to JS/TS integration.</p>
<h3 id="here-is-an-example-showcasing-conditional-logic">Here is an Example Showcasing Conditional Logic</h3>





<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-md" data-lang="md"><span class="line"><span class="ln">1</span><span class="cl">{{ if isset .Params &#34;title&#34; }}
</span></span><span class="line"><span class="ln">2</span><span class="cl">    &lt;title&gt;{{ .Params.title }}&lt;/title&gt;
</span></span><span class="line"><span class="ln">3</span><span class="cl">{{ else }}
</span></span><span class="line"><span class="ln">4</span><span class="cl">    &lt;title&gt;{{ .Site.title }}&lt;/title&gt;
</span></span><span class="line"><span class="ln">5</span><span class="cl">{{ end }}</span></span></code></pre></div><h2 id="closing---my-thought-process">Closing - My Thought Process</h2>
<p>I see far too many IT professionals publishing subpar blogs—often touting frameworks that are wholly unnecessary for their use case.</p>
<p>While platforms such as WordPress are a sound choice, I see many professionals opting for frameworks that appear professional or <em>&ldquo;technically advanced.&rdquo;</em></p>
<p>But their integration only scratches the surface—not fully utilizing the framework&rsquo;s capabilities; <strong>why use such complex systems rudimentarily?</strong></p>
<p>It does not impress me to have an extensive homelab just to use technologies <em>you believe make you appear technically accomplished</em>.</p>
<p>For my use case, I wanted something secure yet simple to host my projects while automating some content creation; security is my end goal.</p>
]]></content:encoded>
    </item>
  </channel>
</rss>
